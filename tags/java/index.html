<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>Tag: java | é“ - è‡ªç„¶ ğŸƒ</title>
  <meta name="description" content="ç”Ÿæ´»ç‚¹æ»´å’ŒçŸ¥è¯†åˆ†äº«" />
  <meta name="keywords" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/">
  <link rel="alternate" href="/atom.xml" title="é“ - è‡ªç„¶ ğŸƒ" type="application/atom+xml">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ç”Ÿæ´»ç‚¹æ»´å’ŒçŸ¥è¯†åˆ†äº«">
<meta property="og:type" content="website">
<meta property="og:title" content="é“ - è‡ªç„¶ ğŸƒ">
<meta property="og:url" content="http://example.com/tags/java/index.html">
<meta property="og:site_name" content="é“ - è‡ªç„¶ ğŸƒ">
<meta property="og:description" content="ç”Ÿæ´»ç‚¹æ»´å’ŒçŸ¥è¯†åˆ†äº«">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ä¸‡æ¾">
<meta name="twitter:card" content="summary">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  
<link rel="stylesheet" href="/style.css">

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				é“ - è‡ªç„¶ ğŸƒ
			</a>

			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								ä¸»é¡µ
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								åˆ†ç±»æŸ¥çœ‹
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'>
								å…³äºæˆ‘
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				ä¸»é¡µ
			</a>
		
			<a href="/archives" class="nav-archives nav">
				åˆ†ç±»æŸ¥çœ‹
			</a>
		
			<a href="/about" class="nav-about nav">
				å…³äºæˆ‘
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        
  <script>
    window.subData= { title:'Tag : java'}
  </script>

<section class="post-list">
	
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2018/04/15/redis/">
                    redis
                </a>
            </h2>
        
        <time>
            4æœˆ 15, 2018
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <h2 id="ä¸€-redis-å®ç°åŸç†"><a href="#ä¸€-redis-å®ç°åŸç†" class="headerlink" title="ä¸€. redis å®ç°åŸç†"></a>ä¸€. redis å®ç°åŸç†</h2><h3 id="äº”ç§ç±»å‹çš„é”®çš„åº•å±‚å®ç°æ•°æ®ç»“æ„"><a href="#äº”ç§ç±»å‹çš„é”®çš„åº•å±‚å®ç°æ•°æ®ç»“æ„" class="headerlink" title="äº”ç§ç±»å‹çš„é”®çš„åº•å±‚å®ç°æ•°æ®ç»“æ„"></a>äº”ç§ç±»å‹çš„é”®çš„åº•å±‚å®ç°æ•°æ®ç»“æ„</h3><p>å…·ä½“å‘½ä»¤å¯å‚è€ƒ<a href="2015/11/10/redis%E7%B4%A2%E5%BC%95/">å‘½ä»¤</a></p>
<ol>
<li><p>SDS( simple dynamic string) ç®€å•åŠ¨æ€å­—ç¬¦ä¸²</p>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sdshdr</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> len;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">free</span>;</span><br><span class="line"><span class="keyword">char</span> buf[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>é“¾è¡¨</p>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">listNode</span>&#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> *<span class="title">prev</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> *<span class="title">next</span>;</span></span><br><span class="line"><span class="keyword">void</span> *value;</span><br><span class="line">&#125;listNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">list</span>&#123;</span></span><br><span class="line">listNode *head;</span><br><span class="line">listNode *tail;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> len;</span><br><span class="line"><span class="keyword">void</span> *(*dup)(<span class="keyword">void</span> *ptr);</span><br><span class="line"><span class="keyword">void</span> (*<span class="built_in">free</span>)(<span class="keyword">void</span> *ptr);</span><br><span class="line"><span class="keyword">int</span> (*match)(<span class="keyword">void</span> *ptr,<span class="keyword">void</span> *key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>å­—å…¸</p>
<p> Redis çš„å­—å…¸ä½¿ç”¨å“ˆå¸Œè¡¨ä½œä¸ºåº•å±‚å®ç°,ä¸€ä¸ªå“ˆå¸Œæ•·è¡é‡Œé¢å¯ä»¥æœ‰å¤šä¸ªèŠ‚ç‚¹,æ¯ä¸ªèŠ‚ç‚¹å°±ä¿å­˜äº†å­—å…¸ä¸­çš„ä¸€ä¸ªé”®å€¼å¯¹;</p>
<p> æ–°æ·»åŠ ä¸€ä¸ªé”®å€¼å¯¹åˆ°å­—å…¸é‡Œæ—¶,ç¨‹åºéœ€è¦å…ˆæ ¹æ®é”®å€¼å¯¹çš„é”®è®¡ç®—å‡ºå“ˆå¸Œå€¼å’Œç´¢å¼•å€¼,ç„¶åæ ¹æ®ç´¢å¼•å€¼,å°†åŒ…å«æ–°é”®å€¼å¯¹çš„å“ˆå¸Œè¡¨èŠ‚ç‚¹æ”¾åˆ°å“ˆå¸Œè¡¨æ•°ç»„çš„æŒ‡å®šç´¢å¼•ä¸Šé¢.å½“æœ‰ä¸¤ä¸ªæˆ–ä»¥ä¸Šæ•°é‡çš„é”®è¢«åˆ†é…åˆ°å“ˆå¸Œæ•°ç»„çš„åŒä¸€ä¸ªç´¢å¼•ä¸Šé¢æ—¶,æˆ‘ä»¬ç§°ä¸ºå†²çª.è¿™é‡Œä½¿ç”¨é“¾åœ°å€æ³•è§£å†³é”®å†²çª.</p>
<ul>
<li><p>å“ˆå¸Œè¡¨</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dictht</span>&#123;</span></span><br><span class="line">dictEntry **table;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> size;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> sizemask;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> used;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  sizemask å€¼å’Œå“ˆå¸Œå€¼ä¸€èµ·å†³å®šä¸€ä¸ªé”®åº”è¯¥è¢«æ”¾åˆ°tableæ•°ç»„çš„å“ªä¸ªç´¢å¼•ä¸Šé¢.</p>
</li>
<li><p>å“ˆå¸Œè¡¨èŠ‚ç‚¹</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dictEntry</span>&#123;</span></span><br><span class="line"><span class="keyword">void</span> *key;</span><br><span class="line"><span class="keyword">union</span>&#123;</span><br><span class="line"><span class="keyword">void</span> *val;</span><br><span class="line">uint64_tu64;</span><br><span class="line">int64_ts64;</span><br><span class="line">&#125; v;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dictEntry</span> *<span class="title">next</span>;</span> <span class="comment">//è§£å†³é”®å†²çªçš„é—®é¢˜</span></span><br><span class="line">&#125; dictEntry;</span><br></pre></td></tr></table></figure></li>
<li><p>å­—å…¸</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dict</span>&#123;</span></span><br><span class="line">dictType *type; <span class="comment">//ç±»å‹ç‰¹å®šå‡½æ•°</span></span><br><span class="line"><span class="keyword">void</span> *privdata;<span class="comment">//ç§æœ‰æ•°æ®</span></span><br><span class="line">dictht ht[<span class="number">2</span>];<span class="comment">//å“ˆå¸Œè¡¨</span></span><br><span class="line"><span class="keyword">int</span> trehashidx;<span class="comment">//ç´¢å¼•</span></span><br><span class="line">&#125; dict;</span><br></pre></td></tr></table></figure></li>
<li><p>rehash(å®é™…è¿‡ç¨‹,æ˜¯æ¸è¿›å¼çš„)</p>
<p>  å½“å“ˆå¸Œè¡¨ä¸­é”®å€¼çš„æ•°é‡å¤ªå¤šæˆ–å¤ªå°‘æ—¶,ä¸ºäº†è®©å“ˆå¸Œè¡¨çš„è´Ÿè½½å› å­ç»´æŒåœ¨ä¸€ä¸ªåˆç†çš„èŒƒå›´ä¹‹å†…,ç¨‹åºéœ€è¦å¯¹å“ˆå¸Œè¡¨çš„å¤§å°è¿›è¡Œç›¸åº”çš„æ‰©å±•æˆ–è€…æ”¶ç¼©.</p>
<ol>
<li><p>ä¸ºå­—æ®µçš„ht[1]å“ˆå¸Œè¡¨åˆ†é…ç©ºé—´,è¿™ä¸ªç©ºé—´å¤§å°å–å†³äºè¦æ‰§è¡Œçš„æ“ä½œ,ä»¥åŠht[0]å½“å‰åŒ…å«çš„é”®å€¼å¯¹æ•°é‡</p>
<ol>
<li>å¦‚æœæ˜¯æ‰©å±•æ“ä½œ,é‚£ä¹ˆå¤§å°ä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºht[0].used*2çš„2çš„næ¬¡æ–¹</li>
<li>å¦‚æœæ‰§è¡Œçš„æ˜¯æ”¶ç¼©æ“ä½œ,é‚£ä¹ˆht[1]çš„å¤§å°ä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºht[0].usedçš„2çš„næ¬¡æ–¹</li>
</ol>
</li>
<li><p>å°†ä¿å­˜åœ¨ht[0]ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹rehashåˆ°ht[1]ä¸Šé¢:rehashæŒ‡é‡æ–°è®¡ç®—é”®çš„å“ˆå¸Œå€¼å’Œç´¢å¼•å€¼,ç„¶åå°†é”®å€¼å¯¹æ”¾ç½®åˆ°ht[1]å“ˆå¸Œè¡¨çš„æŒ‡å®šä½ç½®ä¸Š</p>
</li>
<li><p>å°†ht[0]é‡Šæ”¾ç©ºé—´,åŒæ—¶å°†ht[0]å’Œht[1]æ¢ä½ç½®</p>
<p>ä½•æ—¶è¿›è¡Œæ‰©å±•å’Œæ”¶ç¼©<br>è´Ÿè½½å› å­= ht[0].used(å·²ä¿å­˜çš„èŠ‚ç‚¹æ•°é‡)/å“ˆå¸Œè¡¨çš„å¤§å°</p>
<p>å½“è´Ÿè½½å› å­å¤§äº 5 (å¾…ç¡®è®¤),æˆ–&lt;0.1 æ—¶</p>
</li>
</ol>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="http://daoluan.net/%E6%9C%AA%E5%88%86%E7%B1%BB/2014/06/26/decode-redis-data-struct-skiplist.html">è·³è·ƒè¡¨</a></p>
<p> skiplist æ˜¯ä¸€ç§æœ‰åºçš„æ•°æ®ç»“æ„,å®ƒé€šè¿‡åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­ç»´æŒå¤šä¸ªæŒ‡å‘å…¶ä»–èŠ‚ç‚¹çš„æŒ‡é’ˆ,ä»è€Œè¾¾åˆ°å¿«é€Ÿè®¿é—®èŠ‚ç‚¹çš„ç›®çš„.<br> redisåœ¨ä»¥ä¸‹ä¸¤ä¸ªåœ°æ–¹ç”¨åˆ°äº†è·³è·ƒè¡¨:</p>
<ol>
<li>æœ‰åºé›†åˆé”® zset</li>
<li>åœ¨é›†ç¾¤èŠ‚ç‚¹ä¸­ç”¨é€”å†…éƒ¨æ•°æ®ç»“æ„</li>
</ol>
</li>
<li><p>æ•´æ•°é›†åˆ</p>
<p> intset æ˜¯é›†åˆé”®çš„åº•å±‚å®ç°ä¹‹ä¸€,å½“ä¸€ä¸ªé›†åˆåªåŒ…å«æ•´æ•°å€¼å…ƒç´ ,å¹¶ä¸”è¿™ä¸ªé›†åˆçš„å…ƒç´ æ•°é‡ä¸å¤šæ—¶,Rediså°±ä¼šä½¿ç”¨æ•´æ•°é›†åˆä½œä¸ºé›†åˆé”®çš„åº•å±‚å®ç°.</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SADD numbers 1 3 5 6 7</span><br><span class="line">(integer) 5</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; OBJECT ENCODING numbers</span><br><span class="line">&quot;intset&quot;</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; sadd numbers 0943890384093845903845094385</span><br><span class="line">(integer) 1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; smembers numbers</span><br><span class="line">1) &quot;3&quot;</span><br><span class="line">2) &quot;0943890384093845903845094385&quot;</span><br><span class="line">3) &quot;7&quot;</span><br><span class="line">4) &quot;2&quot;</span><br><span class="line">5) &quot;6&quot;</span><br><span class="line">6) &quot;1&quot;</span><br><span class="line">7) &quot;9&quot;</span><br><span class="line">8) &quot;5&quot;</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; OBJECT ENCODING numbers</span><br><span class="line">&quot;hashtable&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="æ¯å½“æˆ‘ä»¬è¦å°†ä¸€ä¸ªæ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢-å¹¶ä¸”æ–°å…ƒç´ çš„ç±»å‹æ¯”æ•´æ•°é›†åˆç°æœ‰çš„æ‰€æœ‰å…ƒç´ çš„ç±»å‹éƒ½è¦é•¿æ—¶-æ•´æ•°é›†åˆéœ€è¦å…ˆè¿›è¡Œå‡çº§-ç„¶åæ‰èƒ½å°†æ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢-è¯·è®°ä½-è¿™é‡Œä¸ä¼šé™çº§çš„"><a href="#æ¯å½“æˆ‘ä»¬è¦å°†ä¸€ä¸ªæ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢-å¹¶ä¸”æ–°å…ƒç´ çš„ç±»å‹æ¯”æ•´æ•°é›†åˆç°æœ‰çš„æ‰€æœ‰å…ƒç´ çš„ç±»å‹éƒ½è¦é•¿æ—¶-æ•´æ•°é›†åˆéœ€è¦å…ˆè¿›è¡Œå‡çº§-ç„¶åæ‰èƒ½å°†æ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢-è¯·è®°ä½-è¿™é‡Œä¸ä¼šé™çº§çš„" class="headerlink" title=" æ¯å½“æˆ‘ä»¬è¦å°†ä¸€ä¸ªæ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢,å¹¶ä¸”æ–°å…ƒç´ çš„ç±»å‹æ¯”æ•´æ•°é›†åˆç°æœ‰çš„æ‰€æœ‰å…ƒç´ çš„ç±»å‹éƒ½è¦é•¿æ—¶,æ•´æ•°é›†åˆéœ€è¦å…ˆè¿›è¡Œå‡çº§,ç„¶åæ‰èƒ½å°†æ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢,è¯·è®°ä½,è¿™é‡Œä¸ä¼šé™çº§çš„"></a> æ¯å½“æˆ‘ä»¬è¦å°†ä¸€ä¸ªæ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢,å¹¶ä¸”æ–°å…ƒç´ çš„ç±»å‹æ¯”æ•´æ•°é›†åˆç°æœ‰çš„æ‰€æœ‰å…ƒç´ çš„ç±»å‹éƒ½è¦é•¿æ—¶,æ•´æ•°é›†åˆéœ€è¦å…ˆè¿›è¡Œå‡çº§,ç„¶åæ‰èƒ½å°†æ–°å…ƒç´ æ·»åŠ åˆ°æ•´æ•°é›†åˆé‡Œé¢,è¯·è®°ä½,è¿™é‡Œä¸ä¼šé™çº§çš„</h2><p> å…¶æ˜¯Redisä¿å­˜æ•´æ•°å€¼çš„é›†åˆæŠ½è±¡æ•°æ®ç»“æ„,å®ƒå¯ä»¥ä¿å­˜int16_t,int32_t,int64_tçš„æ•´æ•°å€¼,å¹¶ä¸”ä¿è¯é›†åˆä¸­ä¸ä¼šå‡ºç°é‡å¤å…ƒç´ .</p>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">intset</span>&#123;</span></span><br><span class="line"><span class="keyword">uint32_t</span> encoding;<span class="comment">//ç¼–ç æ–¹å¼ INTSET_ENC_INT16,INTSET_ENC_INT32,INTSET_ENC_INT64</span></span><br><span class="line"><span class="keyword">uint32_t</span> length;<span class="comment">//é›†åˆåŒ…å«çš„å…ƒç´ æ•°é‡</span></span><br><span class="line"><span class="keyword">int8_t</span> contents[]; <span class="comment">//ä¿å­˜å…ƒç´ çš„æ•°ç»„,æ•°ç»„ä¸­æŒ‰å€¼çš„å¤§å°ä»å°åˆ°å¤§æœ‰åºæ’åˆ—,å¹¶ä¸”æ•°ç»„ä¸­ä¸åŒ…å«ä»»ä½•é‡å¤é¡¹;å…¶çœŸæ­£çš„ç±»å‹å–å†³äºencodingå±æ€§çš„å€¼:</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>å‹ç¼©åˆ—è¡¨<br> ziplist,æ˜¯åˆ—è¡¨é”®å’Œå“ˆå¸Œé”®çš„åº•å±‚å®ç°ä¹‹ä¸€.å½“ä¸€ä¸ªåˆ—è¡¨é”®åªåŒ…å«å°‘é‡åˆ—è¡¨é¡¹,å¹¶ä¸”æ¯ä¸ªåˆ—è¡¨é¡¹è¦ä¹ˆå°±æ˜¯å°æ•´æ•°å€¼,è¦ä¹ˆå°±æ˜¯é•¿åº¦æ¯”è¾ƒçŸ­çš„å­—ç¬¦ä¸²,é‚£ä¹ˆRediså°±ä¼šä½¿ç”¨å‹ç¼©åˆ—è¡¨æ¥åšåˆ—è¡¨é”®çš„åº•å±‚å®ç°.</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; rpush kdf djf f df d f d f &quot;sdf&quot;</span><br><span class="line">(integer) 8</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; OBJECT ENCODING kdf</span><br><span class="line">&quot;ziplist&quot;</span><br></pre></td></tr></table></figure>

<p> å‹ç¼©åˆ—è¡¨æ˜¯ä¸ºäº†èŠ‚çº¦å†…å­˜è€Œå¼€å‘çš„,æ˜¯ç”±ä¸€ç³»åˆ—ç‰¹æ®Šçš„è¿ç»­å†…å­˜å—ç»„æˆçš„é¡ºåºå‹æ•°æ®ç»“æ„.ä¸€ä¸ªå‹ç¼©åˆ—è¡¨å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèŠ‚ç‚¹,æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜ä¸€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…ä¸€ä¸ªæ•´æ•°å€¼.</p>
</li>
</ol>
<h3 id="å¯¹è±¡å¤„ç†æœºåˆ¶ä»¥åŠæ•°æ®åº“çš„å®ç°åŸç†"><a href="#å¯¹è±¡å¤„ç†æœºåˆ¶ä»¥åŠæ•°æ®åº“çš„å®ç°åŸç†" class="headerlink" title="å¯¹è±¡å¤„ç†æœºåˆ¶ä»¥åŠæ•°æ®åº“çš„å®ç°åŸç†"></a>å¯¹è±¡å¤„ç†æœºåˆ¶ä»¥åŠæ•°æ®åº“çš„å®ç°åŸç†</h3><ol>
<li><p>å¯¼å…¥</p>
<ol>
<li>Redis åŸºäºè¿™äº›æ•°æ®ç»“æ„åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç³»ç»Ÿ,å…¶åŒ…å« å­—ç¬¦ä¸²,åˆ—è¡¨å¯¹è±¡,å“ˆå¸Œå¯¹è±¡,é›†åˆå¯¹è±¡å’Œæœ‰åºé›†åˆå¯¹è±¡ äº”ç§ç±»å‹çš„å¯¹è±¡,æ¯ç§å¯¹è±¡éƒ½è‡³å°‘ä¸€ç§æˆ‘ä»¬å‰é¢æ‰€ä»‹ç»çš„æ•°æ®ç»“æ„.</li>
<li>ä½¿ç”¨å¯¹è±¡çš„å¥½å¤„,æˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯,ä¸ºå¯¹è±¡è®¾ç½®å¤šç§ä¸åŒçš„æ•°æ®ç»“æ„pugmwwè€Œä¼˜åŒ–å¯¹è±¡åœ¨ä¸åŒåœºæ™¯ä¸‹çš„ä½¿ç”¨æ•ˆç‡.</li>
<li>å¯¹è±¡ç³»ç»ŸåŸºäºå¼•ç”¨è®¡æ•°æŠ€æœ¯çš„å†…å­˜å›æ”¶æœºåˆ¶,å½“ç¨‹åºä¸å†ä½¿ç”¨æŸä¸ªå¯¹è±¡çš„æ—¶å€™,è¿™ä¸ªå¯¹è±¡æ‰€æˆ˜èƒœçš„å†…å­˜å°±ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾;å¦å¤–,Redisè¿˜é€šè¿‡å¼•ç”¨è®¡æ•°æŠ€æœ¯å®ç°äº†å¯¹è±¡å…±äº«æœºåˆ¶,è¿™ä¸€æœºåˆ¶å¯ä»¥åœ¨é€‚å½“çš„æ¡ä»¶ä¸‹,é€šè¿‡è®©å¤šä¸ªæ•°æ®åº“é”®å…±äº«åŒä¸€ä¸ªå¯¹è±¡æ¥èŠ‚çº¦å†…å­˜.</li>
<li>å¯¹è±¡å¸¦æœ‰è®¿é—®æ—¶é—´è®°å½•ä¿¡æ¯,è¯¥ä¿¡æ¯å¯ä»¥ç”¨äºè®¡ç®—æ•°æ®åº“çš„ç©ºè½¬æ—¶é•¿ ,åœ¨æœåŠ¡å™¨å¯ç”¨äº†maxmemoryåŠŸèƒ½çš„æƒ…å†µä¸‹,ç©ºè½¬æ—¶é•¿è¾ƒå¤§çš„é‚£äº›é”®å¯èƒ½ä¼šä¼˜å…ˆè¢«æœåŠ¡å™¨åˆ é™¤.</li>
</ol>
</li>
<li><p>å¯¹è±¡çš„ç±»å‹å’Œç¼–ç  type</p>
<p> Redisä½¿ç”¨å¯¹è±¡æ¥è¡¨ç¤ºæ•°æ®åº“ä¸­çš„é”®å€¼,æ¯æ¬¡æˆ‘ä»¬åœ¨åº“ä¸­æ–°åˆ›å»ºä¸€ä¸ªé”®å€¼å¯¹æ—¶,æˆ‘ä»¬è‡³å°‘ä¼šåˆ›å»ºä¸¤ä¸ªå¯¹è±¡,ä¸€ä¸ªæ˜¯é”®å¯¹è±¡,å¦ä¸€ä¸ªæ˜¯å€¼å¯¹è±¡.</p>
 <figure class="highlight accesslog"><table><tr><td class="code"><pre><span class="line"><span class="number">127.0.0.1:6379</span>&gt; set name aaron</span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0.0.1:6379</span>&gt; get name</span><br><span class="line"><span class="string">&quot;aaron&quot;</span></span><br><span class="line"><span class="number">127.0.0.1:6379</span>&gt; OBJECT ENCODING name</span><br><span class="line"><span class="string">&quot;embstr&quot;</span></span><br><span class="line"><span class="number">127.0.0.1:6379</span>&gt; type name</span><br><span class="line">string</span><br><span class="line"><span class="number">127.0.0.1:6379</span>&gt; OBJECT idletime name</span><br><span class="line">(integer) <span class="number">46</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p> æ¯ä¸€ä¸ªå¯¹è±¡éƒ½ç”±ä¸€ä¸ªredisObjectç»“æ„è¡¨ç¤º,è¯¥ç»“æ„ä¸­å’Œä¿å­˜æ•°æ®æœ‰å…³çš„ä¸‰ä¸ªå±æ€§åˆ†åˆ«æ˜¯typeå±æ€§,encodingå±æ€§å’Œptrå±æ€§:</p>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">redisObject</span>&#123;</span></span><br><span class="line"><span class="keyword">unsigned</span> type:<span class="number">4</span>;</span><br><span class="line"><span class="keyword">unsigned</span> encoding:<span class="number">4</span>;</span><br><span class="line"><span class="keyword">void</span> *ptr;<span class="comment">//æ¯æ—¥å‘åº•å±‚å®ç°æ•°æ®ç»“æ„çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">int</span> refcount;<span class="comment">//å¼•ç”¨è®¡æ•°</span></span><br><span class="line"><span class="keyword">unsigned</span> lru:<span class="number">22</span>;<span class="comment">//è¯¥å¯¹è±¡æœ€åä¸€æ¬¡è¢«è®¿é—®çš„æ—¶é—´</span></span><br><span class="line">&#125;robj;</span><br></pre></td></tr></table></figure>
<p> typeè®°å½•äº†å¯¹è±¡çš„ç±»å‹,è¿™ä¸ªå±æ€§çš„å€¼æœ‰ string,list,hash,set,zset</p>
</li>
<li><p>ç¼–ç å’Œåº•å±‚å®ç°  OBJECT ENCODING<br> å¯¹è±¡çš„ptræŒ‡é’ˆæŒ‡å‘å¯¹è±¡çš„åº•å±‚å®ç°æ•°æ®ç»“æ„,è€Œè¿™äº›æ•°æ®ç»“æ„ç”±å¯¹è±¡çš„encodingå±æ€§å†³å®š.ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå¯¹è±¡ä½¿ç”¨äº†ä»€ä¹ˆæ•°æ®ç»“æ„ä½œä¸ºå¯¹è±¡çš„åº•å±‚å®ç°,è¿™ä¸ªå±æ€§å€¼å¯ä»¥æ˜¯</p>
 <figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">int (<span class="name">long</span> ç±»å‹)</span><br><span class="line">embstr (<span class="name">embstr</span>ç¼–ç çš„ç®€å•åŠ¨æ€å­—ç¬¦ä¸²)</span><br><span class="line">raw (ç®€å•åŠ¨æ€å­—ç¬¦ä¸²)</span><br><span class="line">ht (å­—å…¸)</span><br><span class="line">linkedlist (åŒç«¯é“¾è¡¨)</span><br><span class="line">ziplist (å‹ç¼©é“¾è¡¨)</span><br><span class="line">intset (æ•´æ•°é›†åˆ)</span><br><span class="line">skiplist (è·³è·ƒé“¾è¡¨å’Œå­—å…¸)</span><br></pre></td></tr></table></figure>
<p> æ¯ç§ç±»å‹å¯¹è±¡éƒ½è‡³å°‘ä½¿ç”¨äº†ä¸¤ç§ä¸åŒçš„ç¼–ç .</p>
 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">string int/embstr/raw</span><br><span class="line">list ziplist/linkedlist</span><br><span class="line">hash ziplist/ht</span><br><span class="line"><span class="builtin-name">set</span>  intset/ht</span><br><span class="line">zset  ziplist/skiplist</span><br></pre></td></tr></table></figure></li>
<li><p>æ•°æ®å…±äº« åªå…±äº«0-9999çš„å­—ç¬¦ä¸²å¯¹è±¡</p>
 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SET a <span class="number">100</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; OBJECT <span class="built_in">ref</span>count a</span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">2</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; OBJECT <span class="built_in">ref</span>count a</span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">2</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SET b <span class="number">100</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; OBJECT <span class="built_in">ref</span>count a</span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">3</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
</ol>
<h3 id="å•æœºæ•°æ®åº“çš„å®ç°"><a href="#å•æœºæ•°æ®åº“çš„å®ç°" class="headerlink" title="å•æœºæ•°æ®åº“çš„å®ç°"></a>å•æœºæ•°æ®åº“çš„å®ç°</h3><ol>
<li><p>åœ¨redisServerç»“æ„çš„dbæ•°ç»„ä¸­,æ¯ä¸ªredisDb ç»“æ„ä»£è¡¨ä¸€ä¸ªæ•°æ®åº“,å¯åŠ¨æœåŠ¡å™¨æ—¶,æœåŠ¡å™¨ä¼šæ ¹æ®dbnumæ¥å†³å®šåº”è¯¥åˆ›å»ºå¤šå°‘ä¸ªæ•°æ®åº“:</p>
 <figure class="highlight python-repl"><table><tr><td class="code"><pre><span class="line">struct redisServer&#123;</span><br><span class="line"><span class="meta">...</span></span><br><span class="line">redisDb *db;</span><br><span class="line">int dbnum;</span><br><span class="line"><span class="meta">...</span></span><br><span class="line">&#125;redisClient</span><br></pre></td></tr></table></figure>
<p> å®¢æˆ·ç«¯å¯ä»¥æ ¹æ®å‘½ä»¤selectæ¥è¿›è¡Œåˆ‡æ¢ç›®æ ‡æ•°æ®åº“</p>
</li>
<li><p>æ•°æ®åº“é”®ç©ºé—´</p>
<p> æ˜¯ä¸€ä¸ªé”®å€¼å¯¹æ•°æ®åº“æœåŠ¡å™¨,å…¶ä¸­æ¯ä¸ªæ•°æ®åº“éƒ½ç”±ä¸€ä¸ªredisDbç»“æ„è¡¨ç¤º,å…¶ä¸­redisDbç»“æ„çš„dictå­—å…¸ä¿å­˜äº†æ•°æ®åº“ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹,æˆ‘ä»¬ç§°è¿™ä¸ªå­—å…¸ä¸º é”®ç©ºé—´<br> typedef struct redisDb{<br> dict *dict;<br> dict *expires;  key æ˜¯å¯¹è±¡,value æ˜¯è¿‡æœŸæ—¶é—´<br> }redisDb</p>
</li>
<li><p>è®¾ç½®ç”Ÿå­˜æ—¶é—´æˆ–è¿‡æœŸæ—¶é—´</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set name wansong</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; expire name 10</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">&quot;wansong&quot;</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">(nil)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>æ•°æ®åº“é€šçŸ¥<br> 2.8 æ–°ç‰ˆæœ¬ä¸­å¢åŠ çš„åŠŸèƒ½,å¯ä»¥é€šè¿‡è®¢é˜…ç»™å®ƒçš„é¢‘é“æˆ–è€…æ¨¡å¼,æ¥è·çŸ¥æ•°æ®åº“ä¸­é”®çš„å˜åŒ–.åŠæ•°æ®åº“ä¸­å‘½ä»¤çš„æ‰§è¡Œæƒ…å†µ.</p>
</li>
</ol>
<h3 id="RDB-æŒä¹…åŒ–å’Œ-AOF-æŒä¹…åŒ–çš„å®ç°åŸç†"><a href="#RDB-æŒä¹…åŒ–å’Œ-AOF-æŒä¹…åŒ–çš„å®ç°åŸç†" class="headerlink" title="RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–çš„å®ç°åŸç†"></a>RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–çš„å®ç°åŸç†</h3><p>RDBæŒä¹…åŒ–åŠŸèƒ½,å¯ä»¥å°†Redisåœ¨å†…å­˜ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜é‡Œé¢,é¿å…æ•°æ®æ„å¤–ä¸¢å¤±.ä¹Ÿå¯ä»¥æ ¹æ®æœåŠ¡å™¨é…ç½®é€‰é¡¹å®šæœŸæ‰§è¡Œ.<br>è¯¥åŠŸèƒ½å¯ä»¥å°†æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„æ•°æ®åº“çŠ¶æ€ä¿å­˜åˆ°ä¸€ä¸ªRDBæ–‡ä»¶ä¸­.è¯¥æ–‡ä»¶æ˜¯ä¸€ä¸ªç»è¿‡å‹ç¼©çš„äºŒè¿›åˆ¶æ–‡ä»¶,é€šè¿‡è¯¥æ–‡ä»¶å¯ä»¥è¿˜åŸç”ŸæˆRDBæ–‡ä»¶æ—¶çš„æ•°æ®åº“çŠ¶æ€.</p>
<ol>
<li><p>RDBæ–‡ä»¶çš„åˆ›å»ºä¸è½½å…¥</p>
<p> save å‘½ä»¤ä¼šé˜»å¡RedisæœåŠ¡å™¨è¿›ç¨‹,ç›´åˆ°RDBæ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¸ºæ­¢,åœ¨æœåŠ¡å™¨è¿›ç¨‹é˜»å¡æœŸé—´,æœåŠ¡å™¨ä¸å¤„ç†ä»»åŠ¡å‘½ä»¤è¯·æ±‚.</p>
<p> bgsave background saving started è¯¥å‘½ä»¤ä¼šæ´¾ç”Ÿå‡ºä¸€ä¸ªå­è¿›ç¨‹,ç„¶åç”±å­è¿›ç¨‹è´Ÿè´£åˆ›å»ºRDBæ–‡ä»¶,æœåŠ¡å™¨è¿›ç¨‹ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚</p>
<p> åˆ›å»ºæ–‡ä»¶çš„å®é™…å·¥ä½œç”±rdbSaveå‡½æ•°å®Œæˆ,saveå’Œbgsaveå‘½ä»¤ä¼šä»¥ä¸åŒçš„æ–¹å¼è°ƒç”¨è¿™ä¸ªå‡½æ•°.</p>
<p> RDBæ–‡ä»¶çš„è½½å…¥æ˜¯è‡ªåŠ¨çš„,å½“ç¨‹åºå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨è½½å…¥,å¦å¤–æ³¨æ„AOFæ–‡ä»¶çš„æ›´æ–°é¢‘ç‡é€šå¸¸æ¯”RDBé«˜,æ‰€ä»¥:</p>
<ol>
<li><p>å¦‚æœæœåŠ¡å™¨å¼€å¯äº†AOFæŒä¹…åŒ–åŠŸèƒ½,é‚£ä¹ˆæœåŠ¡å™¨ä¼šä¼˜å…ˆä½¿ç”¨AOFæ–‡ä»¶è¿˜åŸæ•°æ®åº“çŠ¶æ€</p>
</li>
<li><p>åªæœ‰åœ¨AOFæŒä¹…åŒ–åŠŸèƒ½å¤„äºå…³é—­çŠ¶æ€æ—¶,æœåŠ¡å™¨æ‰ä¼šä½¿ç”¨RDBæ–‡ä»¶æ¥è¿˜åŸæ•°æ®åº“çŠ¶æ€.</p>
<p>è½½å…¥RDBæ–‡ä»¶çš„å®é™…å·¥ä½œç”±rdbLoadå‡½æ•°å®Œæˆ;æ–‡ä»¶è½½å…¥æ—¶æœåŠ¡å™¨å¤„äºé˜»å¡çŠ¶æ€.</p>
</li>
</ol>
</li>
<li><p>è‡ªåŠ¨é—´éš”æ€§ä¿å­˜</p>
<p>å¯ä»¥é€šè¿‡saveé€‰é¡¹è®¾ç½®å¤šä¸ªä¿å­˜æ¡ä»¶,ä½†åªè¦å…¶ä¸­ä»»æ„ä¸€ä¸ªæ¡ä»¶è¢«æ»¡è¶³,æœåŠ¡å™¨å°±ä¼šæ‰§è¡Œbgsave.</p>
<p>save 900 1  æœåŠ¡å™¨900ç§’ä¹‹å†…,å¯¹æ•°æ®åº“è¿›è¡Œè‡³å°‘ä¸€æ¬¡ä¿®æ”¹,å°±è¿›è¡Œbgsave</p>
</li>
</ol>
<h3 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><h4 id="Redis-åŸºäº-Reactoræ¨¡å¼å¼€å‘çš„ç½‘ç»œäº‹ä»¶å¤„ç†å™¨-ç§°ä½œ-æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨-File-Event-Handler"><a href="#Redis-åŸºäº-Reactoræ¨¡å¼å¼€å‘çš„ç½‘ç»œäº‹ä»¶å¤„ç†å™¨-ç§°ä½œ-æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨-File-Event-Handler" class="headerlink" title="Redis åŸºäº Reactoræ¨¡å¼å¼€å‘çš„ç½‘ç»œäº‹ä»¶å¤„ç†å™¨,ç§°ä½œ æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ (File Event Handler)"></a>Redis åŸºäº Reactoræ¨¡å¼å¼€å‘çš„ç½‘ç»œäº‹ä»¶å¤„ç†å™¨,ç§°ä½œ æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ (File Event Handler)</h4><ol>
<li>ä½¿ç”¨I/Oå¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—,å¹¶æ ¹æ®ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶</li>
<li>å½“è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”,è¯»å–,å†™å…¥,å…³é—­ ç­‰æ“ä½œæ—¶,ä¸å…¶å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶å°±ä¼šäº§ç”Ÿ,è¿™æ—¶1ä¸­æ³¨å†Œå¥½çš„äº‹ä»¶å¤„ç†å™¨å°±æ¥è¿›è¡Œå¤„ç†è¿™äº›äº‹ä»¶</li>
</ol>
<h4 id="æ—¶é—´äº‹ä»¶-id-when-handlers"><a href="#æ—¶é—´äº‹ä»¶-id-when-handlers" class="headerlink" title="æ—¶é—´äº‹ä»¶ id/when/handlers"></a>æ—¶é—´äº‹ä»¶ id/when/handlers</h4><ol>
<li>å®šæ—¶äº‹ä»¶</li>
<li>å‘¨æœŸæ€§äº‹ä»¶</li>
</ol>
<h3 id="äº‹åŠ¡å®ç°åŸç†-ACID"><a href="#äº‹åŠ¡å®ç°åŸç†-ACID" class="headerlink" title="äº‹åŠ¡å®ç°åŸç† ACID"></a>äº‹åŠ¡å®ç°åŸç† ACID</h3><h3 id="ServerCronå‡½æ•°"><a href="#ServerCronå‡½æ•°" class="headerlink" title="ServerCronå‡½æ•°"></a>ServerCronå‡½æ•°</h3><blockquote>
<blockquote>
<p>æœåŠ¡å™¨ é»˜è®¤æ¯100æ¯«ç§’æ‰§è¡Œä¸€æ¬¡</p>
</blockquote>
</blockquote>
<ol>
<li>æ›´æ–°æœåŠ¡å™¨æ—¶é—´ç¼“å­˜</li>
<li>æ›´æ–°LRUæ—¶é’Ÿ(å¦‚ Rediså¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ªLRUå±æ€§,è¿™ä¸ªå±æ€§ä¿å­˜äº†å¯¹è±¡æœ€åä¸€æ¬¡è¢«å‘½ä»¤è®¿é—®çš„æ—¶é—´)</li>
<li>æ›´æ–°æœåŠ¡å™¨æ¯ç§’æ‰§è¡Œå‘½ä»¤çš„æ¬¡æ•°(INFO status)</li>
<li>æ›´æ–°æœåŠ¡å™¨å†…å­˜å³°å€¼è®°å½•</li>
<li>å¤„ç†SIGTERMä¿¡å· æ¯æ¬¡è¿è¡Œæ—¶,ç¨‹åºä¼šå¯¹æœåŠ¡å™¨çŠ¶æ€çš„shutdown_asapå±æ€§è¿›è¡Œæ£€æŸ¥,çœ‹æ˜¯å¦è¦å…³é—­æœåŠ¡å™¨</li>
<li>ç®¡ç†å®¢æˆ·ç«¯èµ„æº: å·²è¶…æ—¶ æˆ– æ˜¯å¦æ¸…ç†è¾“å‡ºç¼“å†²åŒº</li>
<li>ç®¡ç†æ•°æ®åº“èµ„æº: åˆ é™¤è¿‡æœŸé”®,å¹¶åœ¨éœ€è¦æ—¶ å¯¹å­—å…¸è¿›è¡Œæ”¶ç¼©æ“ä½œ</li>
<li>æ£€æŸ¥æŒä¹…åŒ–æ“ä½œçš„è¿è¡ŒçŠ¶æ€</li>
<li>å°†AOFç¼“å†²åŒºçš„å†…å®¹å†™å…¥åˆ°AOFæ–‡ä»¶</li>
<li>å…³é—­å¼‚æ­¥å®¢æˆ·ç«¯</li>
<li>å¢åŠ cronloopsè®¡æ•°å™¨çš„å€¼</li>
</ol>
<h3 id="åˆå§‹åŒ–è¿‡ç¨‹"><a href="#åˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="åˆå§‹åŒ–è¿‡ç¨‹"></a>åˆå§‹åŒ–è¿‡ç¨‹</h3><p>åˆå§‹åŒ–æœåŠ¡å™¨çŠ¶æ€ç»“æ„,è½½å…¥é…ç½®é€‰é¡¹,è¿˜åŸæ•°æ®åº“çŠ¶æ€,æ‰§è¡Œäº‹ä»¶å¾ªç¯</p>
<h3 id="è®¢é˜…ä¸å‘å¸ƒå®ç°åŸç†"><a href="#è®¢é˜…ä¸å‘å¸ƒå®ç°åŸç†" class="headerlink" title="è®¢é˜…ä¸å‘å¸ƒå®ç°åŸç†"></a>è®¢é˜…ä¸å‘å¸ƒå®ç°åŸç†</h3><h3 id="Lua-è„šæœ¬åŠŸèƒ½çš„å®ç°åŸç†ã€‚"><a href="#Lua-è„šæœ¬åŠŸèƒ½çš„å®ç°åŸç†ã€‚" class="headerlink" title="Lua è„šæœ¬åŠŸèƒ½çš„å®ç°åŸç†ã€‚"></a>Lua è„šæœ¬åŠŸèƒ½çš„å®ç°åŸç†ã€‚</h3><h3 id="SORT-å‘½ä»¤çš„å®ç°åŸç†ã€‚"><a href="#SORT-å‘½ä»¤çš„å®ç°åŸç†ã€‚" class="headerlink" title="SORT å‘½ä»¤çš„å®ç°åŸç†ã€‚"></a>SORT å‘½ä»¤çš„å®ç°åŸç†ã€‚</h3><h3 id="æ…¢æŸ¥è¯¢æ—¥å¿—çš„å®ç°åŸç†ã€‚-æ‰“å¼€æ…¢æŸ¥è¯¢-æŸ¥çœ‹æ—¥æœŸ-SLOWLOG-GET"><a href="#æ…¢æŸ¥è¯¢æ—¥å¿—çš„å®ç°åŸç†ã€‚-æ‰“å¼€æ…¢æŸ¥è¯¢-æŸ¥çœ‹æ—¥æœŸ-SLOWLOG-GET" class="headerlink" title="æ…¢æŸ¥è¯¢æ—¥å¿—çš„å®ç°åŸç†ã€‚ æ‰“å¼€æ…¢æŸ¥è¯¢,æŸ¥çœ‹æ—¥æœŸ SLOWLOG GET"></a>æ…¢æŸ¥è¯¢æ—¥å¿—çš„å®ç°åŸç†ã€‚ æ‰“å¼€æ…¢æŸ¥è¯¢,æŸ¥çœ‹æ—¥æœŸ SLOWLOG GET</h3><h3 id="é«˜å¹¶å‘å¦‚ä½•åšåˆ°"><a href="#é«˜å¹¶å‘å¦‚ä½•åšåˆ°" class="headerlink" title="é«˜å¹¶å‘å¦‚ä½•åšåˆ°"></a>é«˜å¹¶å‘å¦‚ä½•åšåˆ°</h3><pre><code>è™½æ˜¯å•çº¿ç¨‹å•è¿›è¡Œ,ä½† ä½¿ç”¨I/Oå¤šè·¯å¤ç”¨(select/epoll,evport,kqueue)ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­— çš„æ–¹å¼æ¥å¤„ç†å‘½ä»¤è¯·æ±‚,å¹¶ä¸å¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡.</code></pre>
<h2 id="äºŒ-redis-ä¸»è¦å…³æ³¨ç‚¹"><a href="#äºŒ-redis-ä¸»è¦å…³æ³¨ç‚¹" class="headerlink" title="äºŒ. redis ä¸»è¦å…³æ³¨ç‚¹"></a>äºŒ. redis ä¸»è¦å…³æ³¨ç‚¹</h2><h3 id="redis-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹"><a href="#redis-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹" class="headerlink" title="redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/qqqqq1993qqqqq/article/details/77538202">redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹</a></h3><h3 id="redis-è¿‡æœŸç´¢å¼•æ˜¯å¦‚ä½•åšåˆ°çš„"><a href="#redis-è¿‡æœŸç´¢å¼•æ˜¯å¦‚ä½•åšåˆ°çš„" class="headerlink" title="redis è¿‡æœŸç´¢å¼•æ˜¯å¦‚ä½•åšåˆ°çš„"></a>redis è¿‡æœŸç´¢å¼•æ˜¯å¦‚ä½•åšåˆ°çš„</h3><ol>
<li><p>redis çš„å­˜å‚¨ç»“æ„</p>
</li>
<li><p>åˆ é™¤ç­–ç•¥</p>
 <figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">* </span>å®šæ—¶åˆ é™¤:åœ¨è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´çš„åŒæ—¶,åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨,è®©å®šæ—¶å™¨åœ¨é”®çš„è¿‡æœŸæ—¶é—´æ¥ä¸´æ—¶,ç«‹å³å¯¹é”®æ‰§è¡Œåˆ é™¤æ“ä½œ(å¯¹å†…å­˜å‹å¥½,æœ€åŠæ—¶)</span><br><span class="line"><span class="bullet">* </span>å®šæœŸåˆ é™¤:æ¯ä¸€æ®µæ—¶é—´,è¿›è¡Œæ•°æ®åº“è¿‡æœŸç´¢å¼•çš„æ‰«ç„,å°†å·²ç»è¿‡æœŸçš„é”® è¿›è¡Œåˆ é™¤; è‡³äºåˆ é™¤å¤šå°‘è¿‡æœŸé”®å’Œæ£€æŸ¥å“ªäº›æ•°æ®åº“,éƒ½ç”±ç®—æ³•å†³å®š</span><br><span class="line"><span class="bullet">* </span>æƒ°æ€§åˆ é™¤: æ¯æ¬¡å–é”®æ—¶,æ ¡éªŒä¸€ä¸‹æ˜¯å¦è¿‡æœŸ,è‹¥å·²ç»è¿‡æœŸ å°±è¿›è¡Œåˆ é™¤</span><br><span class="line"></span><br><span class="line">å…¶å®æœ€ç»ˆä½¿ç”¨çš„æ˜¯ å®šæœŸå’Œæƒ°æ€§ ä¸¤ä¸ªç­–ç•¥ é…åˆå®ç°</span><br></pre></td></tr></table></figure>
<h3 id="redis-æœåŠ¡å™¨é…ç½®"><a href="#redis-æœåŠ¡å™¨é…ç½®" class="headerlink" title="redis æœåŠ¡å™¨é…ç½®"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/joshua317/p/5635297.html">redis æœåŠ¡å™¨é…ç½®</a></h3><h3 id="redis-æœ‰å“ªäº›åŠŸèƒ½"><a href="#redis-æœ‰å“ªäº›åŠŸèƒ½" class="headerlink" title="redis æœ‰å“ªäº›åŠŸèƒ½"></a><a href="">redis æœ‰å“ªäº›åŠŸèƒ½</a></h3><h3 id="redis-å¦‚ä½•Failover"><a href="#redis-å¦‚ä½•Failover" class="headerlink" title="redis å¦‚ä½•Failover()"></a>redis å¦‚ä½•Failover()</h3> <figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">å“¨å…µï¼ˆSentinelï¼‰å’Œå¤åˆ¶ï¼ˆ<span class="keyword">Replication</span>ï¼‰</span><br><span class="line">Sentinelå¯ä»¥ç®¡ç†å¤šä¸ªRedisæœåŠ¡å™¨ï¼Œå®ƒæä¾›äº†ç›‘æ§ï¼Œæé†’ä»¥åŠè‡ªåŠ¨çš„æ•…éšœè½¬ç§»çš„åŠŸèƒ½ï¼›<span class="keyword">Replication</span>åˆ™æ˜¯è´Ÿè´£è®©ä¸€ä¸ªRedisæœåŠ¡å™¨å¯ä»¥é…å¤‡å¤šä¸ªå¤‡ä»½çš„æœåŠ¡å™¨</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="redis-ç›®å‰æµç¨‹çš„å®æ–½æ¶æ„æœ‰å“ªäº›"><a href="#redis-ç›®å‰æµç¨‹çš„å®æ–½æ¶æ„æœ‰å“ªäº›" class="headerlink" title="redis ç›®å‰æµç¨‹çš„å®æ–½æ¶æ„æœ‰å“ªäº›"></a>redis ç›®å‰æµç¨‹çš„å®æ–½æ¶æ„æœ‰å“ªäº›</h3><ol>
<li>å“¨å…µSentinel,å¤åˆ¶ï¼ˆreplicationï¼‰</li>
<li>é›†ç¾¤ï¼ˆclusterï¼‰</li>
</ol>
<h2 id="ä¸‰-redis-åº”ç”¨åœºæ™¯"><a href="#ä¸‰-redis-åº”ç”¨åœºæ™¯" class="headerlink" title="ä¸‰. redis åº”ç”¨åœºæ™¯"></a>ä¸‰. <a target="_blank" rel="noopener" href="https://www.cnblogs.com/NiceCui/p/7794659.html">redis åº”ç”¨åœºæ™¯</a></h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/11486101.html">Redisè®¾è®¡ä¸å®ç°</a></li>
</ol>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E7%BC%93%E5%AD%98/">ç¼“å­˜</a>
                
                    <a href="/tags/redis/">redis</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2018/03/29/%E6%8E%92%E5%BA%8F/">
                    æ’åº
                </a>
            </h2>
        
        <time>
            3æœˆ 29, 2018
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        

        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E7%AE%97%E6%B3%95/">ç®—æ³•</a>
                
                    <a href="/tags/%E6%8E%92%E5%BA%8F/">æ’åº</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2018/03/29/%E4%BA%8C%E5%88%86%E6%B3%95%E6%9F%A5%E6%89%BE%E5%8F%8A%E6%89%A9%E5%B1%95/">
                    äºŒåˆ†æ³•æŸ¥æ‰¾åŠæ‰©å±•
                </a>
            </h2>
        
        <time>
            3æœˆ 29, 2018
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <h2 id="äºŒåˆ†æ³•æŸ¥æ‰¾"><a href="#äºŒåˆ†æ³•æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æ³•æŸ¥æ‰¾"></a>äºŒåˆ†æ³•æŸ¥æ‰¾</h2><blockquote>
<blockquote>
<p>ç»™ä¸€ä¸ªæœ‰åºæ•°ç»„,æŸ¥æ‰¾å‡ºkæ‰€åœ¨ä½ç½®</p>
</blockquote>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Aaron</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 6.2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TheFirstLessThan100</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> low = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> high = array.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">            <span class="keyword">int</span> middle = (low + high) &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> middleValue = array[middle];</span><br><span class="line">            count++;</span><br><span class="line">            <span class="keyword">if</span> (middleValue &lt; value) &#123;</span><br><span class="line">                low = middle + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (middleValue &gt; value) &#123;</span><br><span class="line">                high = middle - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.printf(<span class="string">&quot;times:%d,index:%d,value:%d\n&quot;</span>, count, middle, value);</span><br><span class="line">                <span class="keyword">return</span> middle;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> index = find(array, array[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="æŸ¥å‡ºç¬¬ä¸€ä¸ªå¤§äºNçš„ä½ç½®"><a href="#æŸ¥å‡ºç¬¬ä¸€ä¸ªå¤§äºNçš„ä½ç½®" class="headerlink" title="æŸ¥å‡ºç¬¬ä¸€ä¸ªå¤§äºNçš„ä½ç½®"></a>æŸ¥å‡ºç¬¬ä¸€ä¸ªå¤§äºNçš„ä½ç½®</h2><blockquote>
<blockquote>
<p>ä»æœ‰åºçš„æ•°ç»„ä¸­,æ‰¾å‡ºç¬¬ä¸€ä¸ªå¤§äºNçš„æ•°å­—çš„ä½ç½®</p>
</blockquote>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">findFirstBigIndex</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> lastBigIndex=-<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> low = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> high = array.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">            <span class="keyword">int</span> middle = (low + high) &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> middleValue = array[middle];</span><br><span class="line">            count++;</span><br><span class="line">            <span class="keyword">if</span> (middleValue &lt;= value) &#123;</span><br><span class="line">                low = middle + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (middleValue &gt; value) &#123;</span><br><span class="line">                high = middle - <span class="number">1</span>;</span><br><span class="line">                lastBigIndex=middle;</span><br><span class="line">                System.out.printf(<span class="string">&quot;times:%d,index:%d,value:%d,middle:%d\n&quot;</span>, count, middle, value,middleValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lastBigIndex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">findFirstBigIndex1</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> low = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> high = array.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">            <span class="keyword">int</span> middle = (low + high) &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> middleValue = array[middle];</span><br><span class="line">            count++;</span><br><span class="line">            <span class="keyword">if</span> (middleValue &lt;= value) &#123;</span><br><span class="line">                low = middle + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (middleValue &gt; value) &#123;</span><br><span class="line">                high = middle - <span class="number">1</span>;</span><br><span class="line">                System.out.printf(<span class="string">&quot;times:%d,index:%d,value:%d,middle:%d\n&quot;</span>, count, middle, value,middleValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> low;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">34</span>,<span class="number">324</span>,<span class="number">546</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> index = findFirstBigIndex1(array, i);</span><br><span class="line">            <span class="keyword">int</span> index2 = findFirstBigIndex(array, i);</span><br><span class="line">            System.out.println(index+<span class="string">&quot;--&quot;</span>+index2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E7%AE%97%E6%B3%95/">ç®—æ³•</a>
                
                    <a href="/tags/%E6%9F%A5%E6%89%BE/">æŸ¥æ‰¾</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2018/03/25/%E5%BE%AE%E4%BF%A1%E5%A4%B4%E5%83%8F%E4%B9%9D%E5%AE%AB%E6%A0%BC%E7%AE%97%E6%B3%95/">
                    å¾®ä¿¡å¤´åƒä¹å®«æ ¼ç®—æ³•
                </a>
            </h2>
        
        <time>
            3æœˆ 25, 2018
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <blockquote>
<blockquote>
<p>åˆ†åˆ«è®¡ç®—1-9ä¸ªå¤´åƒåœ¨ä¹å®«æ ¼ä¸­çš„ä½ç½®</p>
</blockquote>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;ImageCell&gt; <span class="title">createMergeCell</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> totalWidth)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> totalRow = (<span class="keyword">int</span>) Math.ceil(Math.sqrt(n));</span><br><span class="line">      <span class="keyword">int</span> outline = <span class="number">5</span>;</span><br><span class="line">      <span class="keyword">int</span> width = ((totalWidth - outline) / totalRow);</span><br><span class="line">      <span class="keyword">int</span> border = width / <span class="number">20</span>;</span><br><span class="line">      <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> Lists.newArrayList(<span class="keyword">new</span> ImageCell(border, border, width - <span class="number">2</span> * border));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">int</span> lastAloneNum = n % totalRow;</span><br><span class="line">      <span class="keyword">int</span> totalFullRow = n / totalRow;</span><br><span class="line">      <span class="keyword">int</span> lastRow = totalRow - totalFullRow - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">int</span> firstStartX = (totalWidth - lastAloneNum * width) / <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">int</span> firstStartY = lastRow * width;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">int</span> otherSpace = (totalWidth - totalRow * width) / <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">int</span> yOffset = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> (totalRow != totalFullRow + (lastAloneNum != <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>)) &#123;</span><br><span class="line">          yOffset = -width / <span class="number">2</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      List&lt;ImageCell&gt; imageCells = Lists.newArrayList();</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">          <span class="keyword">int</span> x = <span class="number">0</span>, y = firstStartY;</span><br><span class="line">          <span class="keyword">if</span> (i &lt; lastAloneNum) &#123;</span><br><span class="line">              x = firstStartX + i * width;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              x = (i - lastAloneNum) % totalRow * width;</span><br><span class="line">              y = firstStartY + ((i - lastAloneNum) / totalRow + <span class="number">1</span>) * width;</span><br><span class="line">          &#125;</span><br><span class="line">          imageCells.add(<span class="keyword">new</span> ImageCell(x + border + otherSpace, y + border + otherSpace + yOffset, width - <span class="number">2</span> * border));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> imageCells;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Data</span></span><br><span class="line">  <span class="meta">@AllArgsConstructor</span></span><br><span class="line">  <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageCell</span> </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> x;</span><br><span class="line">      <span class="keyword">int</span> y;</span><br><span class="line">      <span class="keyword">int</span> width;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">-------------------n=1---------------------</span><br><span class="line">			x:7,y:7,width:131</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=2---------------------</span><br><span class="line">			x:6,y:42,width:66</span><br><span class="line">			x:78,y:42,width:66</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=3---------------------</span><br><span class="line">			x:45,y:6,width:66</span><br><span class="line">			x:6,y:78,width:66</span><br><span class="line">			x:78,y:78,width:66</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=4---------------------</span><br><span class="line">			x:6,y:6,width:66</span><br><span class="line">			x:78,y:6,width:66</span><br><span class="line">			x:6,y:78,width:66</span><br><span class="line">			x:78,y:78,width:66</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=5---------------------</span><br><span class="line">			x:32,y:29,width:44</span><br><span class="line">			x:80,y:29,width:44</span><br><span class="line">			x:5,y:77,width:44</span><br><span class="line">			x:53,y:77,width:44</span><br><span class="line">			x:101,y:77,width:44</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=6---------------------</span><br><span class="line">			x:5,y:29,width:44</span><br><span class="line">			x:53,y:29,width:44</span><br><span class="line">			x:101,y:29,width:44</span><br><span class="line">			x:5,y:77,width:44</span><br><span class="line">			x:53,y:77,width:44</span><br><span class="line">			x:101,y:77,width:44</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=7---------------------</span><br><span class="line">			x:56,y:5,width:44</span><br><span class="line">			x:5,y:53,width:44</span><br><span class="line">			x:53,y:53,width:44</span><br><span class="line">			x:101,y:53,width:44</span><br><span class="line">			x:5,y:101,width:44</span><br><span class="line">			x:53,y:101,width:44</span><br><span class="line">			x:101,y:101,width:44</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=8---------------------</span><br><span class="line">			x:32,y:5,width:44</span><br><span class="line">			x:80,y:5,width:44</span><br><span class="line">			x:5,y:53,width:44</span><br><span class="line">			x:53,y:53,width:44</span><br><span class="line">			x:101,y:53,width:44</span><br><span class="line">			x:5,y:101,width:44</span><br><span class="line">			x:53,y:101,width:44</span><br><span class="line">			x:101,y:101,width:44</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------n=9---------------------</span><br><span class="line">			x:5,y:5,width:44</span><br><span class="line">			x:53,y:5,width:44</span><br><span class="line">			x:101,y:5,width:44</span><br><span class="line">			x:5,y:53,width:44</span><br><span class="line">			x:53,y:53,width:44</span><br><span class="line">			x:101,y:53,width:44</span><br><span class="line">			x:5,y:101,width:44</span><br><span class="line">			x:53,y:101,width:44</span><br><span class="line">			x:101,y:101,width:44</span><br><span class="line"></span><br></pre></td></tr></table></figure>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E7%AE%97%E6%B3%95/">ç®—æ³•</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2018/03/24/%E5%8F%96%E4%B8%80%E4%B8%AA%E6%95%B0%E5%AD%97%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%AD1%E7%9A%84%E4%B8%AA%E6%95%B0/">
                    å–ä¸€ä¸ªæ•°å­—äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°
                </a>
            </h2>
        
        <time>
            3æœˆ 24, 2018
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><ol>
<li><p>äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°</p>
<pre><code> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">countBits</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count=<span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (n&gt;<span class="number">0</span>)  &#123;</span><br><span class="line">        count++ ;</span><br><span class="line">        n &amp;= (n - <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 å¤æ‚åº¦: &lt; log2n</code></pre>
</li>
<li><p>æ–¹æ¡ˆäºŒ</p>
<pre><code> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns the number of one-bits in the two&#x27;s complement binary</span></span><br><span class="line"><span class="comment"> * representation of the specified &#123;<span class="doctag">@code</span> int&#125; value.  This function is</span></span><br><span class="line"><span class="comment"> * sometimes referred to as the &lt;i&gt;population count&lt;/i&gt;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> i the value whose bits are to be counted</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the number of one-bits in the two&#x27;s complement binary</span></span><br><span class="line"><span class="comment"> *     representation of the specified &#123;<span class="doctag">@code</span> int&#125; value.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">bitCount</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// HD, Figure 5-2</span></span><br><span class="line">    i = i - ((i &gt;&gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x55555555</span>);</span><br><span class="line">    i = (i &amp; <span class="number">0x33333333</span>) + ((i &gt;&gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x33333333</span>);</span><br><span class="line">    i = (i + (i &gt;&gt;&gt; <span class="number">4</span>)) &amp; <span class="number">0x0f0f0f0f</span>;</span><br><span class="line">    i = i + (i &gt;&gt;&gt; <span class="number">8</span>);</span><br><span class="line">    i = i + (i &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> i &amp; <span class="number">0x3f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
 å¤æ‚åº¦: 1</code></pre>
</li>
<li><p>æ–¹æ¡ˆä¸‰</p>
<pre><code> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">countBit1</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count=<span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> temp=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (temp&lt;=n)  &#123;</span><br><span class="line">        <span class="keyword">if</span>((temp&amp;n)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            count++ ;</span><br><span class="line">        &#125;</span><br><span class="line">        temp&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre>
</li>
</ol>
<h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><ol>
<li>ç»™å®šä¸€ä¸ªæ•°å­—nè®¡ç®—ä»1åˆ°næ¯ä¸€ä¸ªæ•°å­—çš„äºŒè¿›åˆ¶ä¸­åŒ…å«1çš„ä¸ªæ•°</li>
</ol>
<pre><code>        <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] countBits(<span class="keyword">int</span> num) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] ret = <span class="keyword">new</span> <span class="keyword">int</span>[num + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= num; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> div = i / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> mod = i % <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (mod == <span class="number">1</span>) &#123;</span><br><span class="line">                ret[i] = ret[div] + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ret[i] = ret[div];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></code></pre>
<!--```flow-->
<!--st=>start: Start|past:>http://www.google.com[blank]-->
<!--e=>end: End:>http://www.google.com-->
<!--op1=>operation: My Operation|past-->
<!--op2=>operation: Stuff|current-->
<!--sub1=>subroutine: My Subroutine|invalid-->
<!--cond=>condition: Yes-->
<!--or No?|approved:>http://www.google.com-->
<!--c2=>condition: Good idea|rejected-->
<!--io=>inputoutput: catch something...|request-->

<!--st->op1(right)->cond-->
<!--cond(yes, right)->c2-->
<!--cond(no)->sub1(left)->op1-->
<!--c2(yes)->io->e-->
<!--c2(no)->op2->e-->
<!--```-->


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E7%AE%97%E6%B3%95/">ç®—æ³•</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2018/03/24/java-util-concurrent%E6%A6%82%E8%A7%88/">
                    java.util.concurrentæ¦‚è§ˆ
                </a>
            </h2>
        
        <time>
            3æœˆ 24, 2018
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <blockquote>
<blockquote>
<p>java.util.concurrent åŒ…å«è®¸å¤šçº¿ç¨‹å®‰å…¨ã€æµ‹è¯•è‰¯å¥½ã€é«˜æ€§èƒ½çš„å¹¶å‘æ„å»ºå—ã€‚ä¸å®¢æ°”åœ°è¯´ï¼Œåˆ›å»º java.util.concurrent çš„ç›®çš„å°±æ˜¯è¦å®ç° Collection æ¡†æ¶å¯¹æ•°æ®ç»“æ„æ‰€æ‰§è¡Œçš„å¹¶å‘æ“ä½œã€‚é€šè¿‡æä¾›ä¸€ç»„å¯é çš„ã€é«˜æ€§èƒ½å¹¶å‘æ„å»ºå—ï¼Œå¼€å‘äººå‘˜å¯ä»¥æé«˜å¹¶å‘ç±»çš„çº¿ç¨‹å®‰å…¨ã€å¯ä¼¸ç¼©æ€§ã€æ€§èƒ½ã€å¯è¯»æ€§å’Œå¯é æ€§ã€‚</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>å¦‚æœä¸€äº›ç±»åçœ‹èµ·æ¥ç›¸ä¼¼ï¼Œå¯èƒ½æ˜¯å› ä¸º java.util.concurrent ä¸­çš„è®¸å¤šæ¦‚å¿µæºè‡ª Doug Lea çš„ util.concurrent åº“ï¼ˆè¯·å‚é˜… å‚è€ƒèµ„æ–™ï¼‰ã€‚</p>
</blockquote>
</blockquote>
<h2 id="JDK-5-0-ä¸­çš„å¹¶å‘æ”¹è¿›å¯ä»¥åˆ†ä¸ºä¸‰ç»„ï¼š"><a href="#JDK-5-0-ä¸­çš„å¹¶å‘æ”¹è¿›å¯ä»¥åˆ†ä¸ºä¸‰ç»„ï¼š" class="headerlink" title="JDK 5.0 ä¸­çš„å¹¶å‘æ”¹è¿›å¯ä»¥åˆ†ä¸ºä¸‰ç»„ï¼š"></a>JDK 5.0 ä¸­çš„å¹¶å‘æ”¹è¿›å¯ä»¥åˆ†ä¸ºä¸‰ç»„ï¼š</h2><pre><code>1. JVM çº§åˆ«æ›´æ”¹ã€‚

    å¤§å¤šæ•°ç°ä»£å¤„ç†å™¨å¯¹å¹¶å‘å¯¹æŸä¸€ç¡¬ä»¶çº§åˆ«æä¾›æ”¯æŒï¼Œé€šå¸¸ä»¥ compare-and-swap ï¼ˆCASï¼‰æŒ‡ä»¤å½¢å¼ã€‚CAS æ˜¯ä¸€ç§ä½çº§åˆ«çš„ã€ç»†ç²’åº¦çš„æŠ€æœ¯ï¼Œå®ƒå…è®¸å¤šä¸ªçº¿ç¨‹æ›´æ–°ä¸€ä¸ªå†…å­˜ä½ç½®ï¼ŒåŒæ—¶èƒ½å¤Ÿæ£€æµ‹å…¶ä»–çº¿ç¨‹çš„å†²çªå¹¶è¿›è¡Œæ¢å¤ã€‚å®ƒæ˜¯è®¸å¤šé«˜æ€§èƒ½å¹¶å‘ç®—æ³•çš„åŸºç¡€ã€‚åœ¨ JDK 5.0 ä¹‹å‰ï¼ŒJava è¯­è¨€ä¸­ç”¨äºåè°ƒçº¿ç¨‹ä¹‹é—´çš„è®¿é—®çš„æƒŸä¸€åŸè¯­æ˜¯åŒæ­¥ï¼ŒåŒæ­¥æ˜¯æ›´é‡é‡çº§å’Œç²—ç²’åº¦çš„ã€‚å…¬å¼€ CAS å¯ä»¥å¼€å‘é«˜åº¦å¯ä¼¸ç¼©çš„å¹¶å‘ Java ç±»ã€‚è¿™äº›æ›´æ”¹ä¸»è¦ç”± JDK åº“ç±»ä½¿ç”¨ï¼Œè€Œä¸æ˜¯ç”±å¼€å‘äººå‘˜ä½¿ç”¨ã€‚

2. ä½çº§å®ç”¨ç¨‹åºç±» -- é”å®šå’ŒåŸå­ç±»ã€‚

    ä½¿ç”¨ CAS ä½œä¸ºå¹¶å‘åŸè¯­ï¼ŒReentrantLock ç±»æä¾›ä¸ synchronized åŸè¯­ç›¸åŒçš„é”å®šå’Œå†…å­˜è¯­ä¹‰ï¼Œç„¶è€Œè¿™æ ·å¯ä»¥æ›´å¥½åœ°æ§åˆ¶é”å®šï¼ˆå¦‚è®¡æ—¶çš„é”å®šç­‰å¾…ã€é”å®šè½®è¯¢å’Œå¯ä¸­æ–­çš„é”å®šç­‰å¾…ï¼‰å’Œæä¾›æ›´å¥½çš„å¯ä¼¸ç¼©æ€§ï¼ˆç«äº‰æ—¶çš„é«˜æ€§èƒ½ï¼‰ã€‚å¤§å¤šæ•°å¼€å‘äººå‘˜å°†ä¸å†ç›´æ¥ä½¿ç”¨ ReentrantLock ç±»ï¼Œè€Œæ˜¯ä½¿ç”¨åœ¨ ReentrantLock ç±»ä¸Šæ„å»ºçš„é«˜çº§ç±»ã€‚

3. é«˜çº§å®ç”¨ç¨‹åºç±»ã€‚

    è¿™äº›ç±»å®ç°å¹¶å‘æ„å»ºå—ï¼Œæ¯ä¸ªè®¡ç®—æœºç§‘å­¦æ–‡æœ¬ä¸­éƒ½ä¼šè®²è¿°è¿™äº›ç±» -- ä¿¡å·ã€äº’æ–¥ã€é—©é”ã€å±éšœã€äº¤æ¢ç¨‹åºã€çº¿ç¨‹æ± å’Œçº¿ç¨‹å®‰å…¨é›†åˆç±»ç­‰ã€‚å¤§éƒ¨åˆ†å¼€å‘äººå‘˜éƒ½å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­ç”¨è¿™äº›ç±»ï¼Œæ¥æ›¿æ¢è®¸å¤šï¼ˆå¦‚æœä¸æ˜¯å…¨éƒ¨ï¼‰åŒæ­¥ã€wait() å’Œ notify() çš„ä½¿ç”¨ï¼Œä»è€Œæé«˜æ€§èƒ½ã€å¯è¯»æ€§å’Œæ­£ç¡®æ€§ã€‚</code></pre>
<h2 id="æœ¬æ–‡ä¸»è¦å†…å®¹"><a href="#æœ¬æ–‡ä¸»è¦å†…å®¹" class="headerlink" title="æœ¬æ–‡ä¸»è¦å†…å®¹"></a>æœ¬æ–‡ä¸»è¦å†…å®¹</h2><pre><code>æœ¬æ•™ç¨‹å°†é‡ç‚¹ä»‹ç» java.util.concurrent åŒ…æä¾›çš„é«˜çº§å®ç”¨ç¨‹åºç±» -- çº¿ç¨‹å®‰å…¨é›†åˆã€çº¿ç¨‹æ± å’ŒåŒæ­¥å®ç”¨ç¨‹åºã€‚è¿™äº›æ˜¯åˆå­¦è€…å’Œä¸“å®¶éƒ½å¯ä»¥ä½¿ç”¨çš„&quot;ç°æˆ&quot;ç±»ã€‚

åœ¨ç¬¬ä¸€å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å›é¡¾å¹¶å‘çš„åŸºæœ¬çŸ¥è¯†ï¼Œå°½ç®¡å®ƒä¸åº”å–ä»£å¯¹çº¿ç¨‹å’Œçº¿ç¨‹å®‰å…¨çš„äº†è§£ã€‚é‚£äº›ä¸€ç‚¹éƒ½ä¸ç†Ÿæ‚‰çº¿ç¨‹çš„è¯»è€…åº”è¯¥å…ˆå‚è€ƒä¸€äº›å…³äºçº¿ç¨‹çš„ä»‹ç»ï¼Œå¦‚&quot;Introduction to Java Threads&quot;æ•™ç¨‹ï¼ˆè¯·å‚é˜…å‚è€ƒèµ„æ–™ï¼‰ã€‚

æ¥ä¸‹æ¥çš„å‡ ä¸ªå°èŠ‚å°†ç ”ç©¶ java.util.concurrent ä¸­çš„é«˜çº§å®ç”¨ç¨‹åºç±» -- çº¿ç¨‹å®‰å…¨é›†åˆã€çº¿ç¨‹æ± ã€ä¿¡å·å’ŒåŒæ­¥å·¥å…·ã€‚

æœ€åä¸€å°èŠ‚å°†ä»‹ç» java.util.concurrent ä¸­çš„ä½çº§å¹¶å‘æ„å»ºå—ï¼Œå¹¶æä¾›ä¸€äº›æ€§èƒ½æµ‹è¯„æ¥æ˜¾ç¤ºæ–° java.util.concurrent ç±»çš„å¯ä¼¸ç¼©æ€§çš„æ”¹è¿›ã€‚</code></pre>
<h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><ol>
<li><p>ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ</p>
<p> æ‰€æœ‰é‡è¦çš„æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒè¿›ç¨‹çš„æ¦‚å¿µ â€“ ç‹¬ç«‹è¿è¡Œçš„ç¨‹åºï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šç›¸äº’éš”ç¦»ã€‚</p>
<p> çº¿ç¨‹æœ‰æ—¶ç§°ä¸º è½»é‡çº§è¿›ç¨‹ã€‚ä¸è¿›ç¨‹ä¸€æ ·ï¼Œå®ƒä»¬æ‹¥æœ‰é€šè¿‡ç¨‹åºè¿è¡Œçš„ç‹¬ç«‹çš„å¹¶å‘è·¯å¾„ï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œç§°ä¸ºå †æ ˆå’Œæœ¬åœ°å˜é‡ã€‚ç„¶è€Œï¼Œçº¿ç¨‹å­˜åœ¨äºè¿›ç¨‹ä¸­ï¼Œå®ƒä»¬ä¸åŒä¸€è¿›ç¨‹å†…çš„å…¶ä»–çº¿ç¨‹å…±äº«å†…å­˜ã€æ–‡ä»¶å¥æŸ„ä»¥åŠæ¯è¿›ç¨‹çŠ¶æ€ã€‚</p>
<p> ä»Šå¤©ï¼Œå‡ ä¹æ¯ä¸ªæ“ä½œç³»ç»Ÿéƒ½æ”¯æŒçº¿ç¨‹ï¼Œå…è®¸æ‰§è¡Œå¤šä¸ªå¯ç‹¬ç«‹è°ƒåº¦çš„çº¿ç¨‹ï¼Œä»¥ä¾¿å…±å­˜äºä¸€ä¸ªè¿›ç¨‹ä¸­ã€‚å› ä¸ºä¸€ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹æ˜¯åœ¨åŒä¸€ä¸ªåœ°å€ç©ºé—´ä¸­æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ç›¸åŒå¯¹è±¡ï¼Œå¹¶ä¸”å®ƒä»¬ä»åŒä¸€å †æ ˆä¸­åˆ†é…å¯¹è±¡ã€‚è™½ç„¶è¿™ä½¿çº¿ç¨‹æ›´æ˜“äºä¸å…¶ä»–çº¿ç¨‹å…±äº«ä¿¡æ¯ï¼Œä½†ä¹Ÿæ„å‘³ç€æ‚¨å¿…é¡»ç¡®ä¿çº¿ç¨‹ä¹‹é—´ä¸ç›¸äº’å¹²æ¶‰ã€‚</p>
<p> æ­£ç¡®ä½¿ç”¨çº¿ç¨‹æ—¶ï¼Œçº¿ç¨‹èƒ½å¸¦æ¥è¯¸å¤šå¥½å¤„ï¼Œå…¶ä¸­åŒ…æ‹¬æ›´å¥½çš„èµ„æºåˆ©ç”¨ã€ç®€åŒ–å¼€å‘ã€é«˜ååé‡ã€æ›´æ˜“å“åº”çš„ç”¨æˆ·ç•Œé¢ä»¥åŠèƒ½æ‰§è¡Œå¼‚æ­¥å¤„ç†ã€‚</p>
<p> Java è¯­è¨€åŒ…æ‹¬ç”¨äºåè°ƒçº¿ç¨‹è¡Œä¸ºçš„åŸè¯­ï¼Œä»è€Œå¯ä»¥åœ¨ä¸è¿åè®¾è®¡åŸå‹æˆ–è€…ä¸ç ´åæ•°æ®ç»“æ„çš„å‰æä¸‹å®‰å…¨åœ°è®¿é—®å’Œä¿®æ”¹å…±äº«å˜é‡ã€‚</p>
</li>
<li><p>çº¿ç¨‹æœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ</p>
<p> åœ¨ Java ç¨‹åºä¸­å­˜åœ¨å¾ˆå¤šç†ç”±ä½¿ç”¨çº¿ç¨‹ï¼Œå¹¶ä¸”ä¸ç®¡å¼€å‘äººå‘˜çŸ¥é“çº¿ç¨‹ä¸å¦ï¼Œå‡ ä¹æ¯ä¸ª Java åº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨çº¿ç¨‹ã€‚è®¸å¤š J2SE å’Œ J2EE å·¥å…·å¯ä»¥åˆ›å»ºçº¿ç¨‹ï¼Œå¦‚ RMIã€Servletã€Enterprise JavaBeans ç»„ä»¶å’Œ Swing GUI å·¥å…·åŒ…ã€‚</p>
</li>
<li><p>ä½¿ç”¨çº¿ç¨‹çš„ç†ç”±åŒ…æ‹¬ï¼š</p>
<p> â€¢ æ›´æ˜“å“åº”çš„ç”¨æˆ·ç•Œé¢ã€‚ äº‹ä»¶é©±åŠ¨çš„ GUI å·¥å…·åŒ…ï¼ˆå¦‚ AWT æˆ– Swingï¼‰ä½¿ç”¨å•ç‹¬çš„äº‹ä»¶çº¿ç¨‹æ¥å¤„ç† GUI äº‹ä»¶ã€‚ä»äº‹ä»¶çº¿ç¨‹ä¸­è°ƒç”¨é€šè¿‡ GUI å¯¹è±¡æ³¨å†Œçš„äº‹ä»¶ç›‘å¬å™¨ã€‚ç„¶è€Œï¼Œå¦‚æœäº‹ä»¶ç›‘å¬å™¨å°†æ‰§è¡Œå†—é•¿çš„ä»»åŠ¡ï¼ˆå¦‚æ–‡æ¡£æ‹¼å†™æ£€æŸ¥ï¼‰ï¼Œé‚£ä¹ˆ UI å°†å‡ºç°å†»ç»“ï¼Œå› ä¸ºäº‹ä»¶çº¿ç¨‹ç›´åˆ°å†—é•¿ä»»åŠ¡å®Œæ¯•ä¹‹åæ‰èƒ½å¤„ç†å…¶ä»–äº‹ä»¶ã€‚é€šè¿‡åœ¨å•ç‹¬çº¿ç¨‹ä¸­æ‰§è¡Œå†—é•¿æ“ä½œï¼Œå½“æ‰§è¡Œå†—é•¿åå°ä»»åŠ¡æ—¶ï¼ŒUI èƒ½ç»§ç»­å“åº”ã€‚</p>
<p> â€¢ ä½¿ç”¨å¤šå¤„ç†å™¨ã€‚ å¤šå¤„ç†å™¨ï¼ˆMPï¼‰ç³»ç»Ÿå˜å¾—è¶Šæ¥è¶Šä¾¿å®œï¼Œå¹¶ä¸”åˆ†å¸ƒè¶Šæ¥è¶Šå¹¿æ³›ã€‚å› ä¸ºè°ƒåº¦çš„åŸºæœ¬å•ä½é€šå¸¸æ˜¯çº¿ç¨‹ï¼Œæ‰€ä»¥ä¸ç®¡æœ‰å¤šå°‘å¤„ç†å™¨å¯ç”¨ï¼Œä¸€ä¸ªçº¿ç¨‹çš„åº”ç”¨ç¨‹åºä¸€æ¬¡åªèƒ½åœ¨ä¸€ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œã€‚åœ¨è®¾è®¡è‰¯å¥½çš„ç¨‹åºä¸­ï¼Œé€šè¿‡æ›´å¥½åœ°åˆ©ç”¨å¯ç”¨çš„è®¡ç®—æœºèµ„æºï¼Œå¤šçº¿ç¨‹èƒ½å¤Ÿæé«˜ååé‡å’Œæ€§èƒ½ã€‚</p>
<p> â€¢ ç®€åŒ–å»ºæ¨¡ã€‚ æœ‰æ•ˆä½¿ç”¨çº¿ç¨‹èƒ½å¤Ÿä½¿ç¨‹åºç¼–å†™å˜å¾—æ›´ç®€å•ï¼Œå¹¶æ˜“äºç»´æŠ¤ã€‚é€šè¿‡åˆç†ä½¿ç”¨çº¿ç¨‹ï¼Œä¸ªåˆ«ç±»å¯ä»¥é¿å…ä¸€äº›è°ƒåº¦çš„è¯¦ç»†ã€äº¤å‰å­˜å–æ“ä½œã€å¼‚æ­¥ IO å’Œèµ„æºç­‰å¾…ä»¥åŠå…¶ä»–å¤æ‚é—®é¢˜ã€‚ç›¸åï¼Œå®ƒä»¬èƒ½ä¸“æ³¨äºåŸŸçš„è¦æ±‚ï¼Œç®€åŒ–å¼€å‘å¹¶æ”¹è¿›å¯é æ€§ã€‚</p>
<p> â€¢ å¼‚æ­¥æˆ–åå°å¤„ç†ã€‚ æœåŠ¡å™¨åº”ç”¨ç¨‹åºå¯ä»¥åŒæ—¶æœåŠ¡äºè®¸å¤šè¿œç¨‹å®¢æˆ·æœºã€‚å¦‚æœåº”ç”¨ç¨‹åºä» socket ä¸­è¯»å–æ•°æ®ï¼Œå¹¶ä¸”æ²¡æœ‰æ•°æ®å¯ä»¥è¯»å–ï¼Œé‚£ä¹ˆå¯¹ read() çš„è°ƒç”¨å°†è¢«é˜»å¡ï¼Œç›´åˆ°æœ‰æ•°æ®å¯è¯»ã€‚åœ¨å•çº¿ç¨‹åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™æ„å‘³ç€å½“æŸä¸€ä¸ªçº¿ç¨‹è¢«é˜»å¡æ—¶ï¼Œä¸ä»…å¤„ç†ç›¸åº”è¯·æ±‚è¦å»¶è¿Ÿï¼Œè€Œä¸”å¤„ç†æ‰€æœ‰è¯·æ±‚ä¹Ÿå°†å»¶è¿Ÿã€‚ç„¶è€Œï¼Œå¦‚æœæ¯ä¸ª socket éƒ½æœ‰è‡ªå·±çš„ IO çº¿ç¨‹ï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªçº¿ç¨‹è¢«é˜»å¡æ—¶ï¼Œå¯¹å…¶ä»–å¹¶å‘è¯·æ±‚è¡Œä¸ºæ²¡æœ‰å½±å“ã€‚</p>
</li>
<li><p>çº¿ç¨‹å®‰å…¨</p>
<p> å¦‚æœå°†è¿™äº›ç±»ç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œè™½ç„¶ç¡®ä¿è¿™äº›ç±»çš„çº¿ç¨‹å®‰å…¨æ¯”è¾ƒå›°éš¾ï¼Œä½†çº¿ç¨‹å®‰å…¨å´æ˜¯å¿…éœ€çš„ã€‚java.util.concurrent è§„èŒƒè¿›ç¨‹çš„ä¸€ä¸ªç›®æ ‡å°±æ˜¯æä¾›ä¸€ç»„çº¿ç¨‹å®‰å…¨çš„ã€é«˜æ€§èƒ½çš„å¹¶å‘æ„å»ºå—ï¼Œä»è€Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿå‡è½»ä¸€äº›ç¼–å†™çº¿ç¨‹å®‰å…¨ç±»çš„è´Ÿæ‹…ã€‚</p>
<p> çº¿ç¨‹å®‰å…¨ç±»éå¸¸éš¾ä»¥æ˜ç¡®å®šä¹‰ï¼Œå¤§å¤šæ•°å®šä¹‰ä¼¼ä¹éƒ½æ˜¯å®Œå…¨å¾ªç¯çš„ã€‚å¿«é€Ÿ Google æœç´¢ä¼šæ˜¾ç¤ºä¸‹åˆ—çº¿ç¨‹å®‰å…¨ä»£ç å®šä¹‰çš„ä¾‹å­ï¼Œä½†è¿™äº›å®šä¹‰ï¼ˆæˆ–è€…æ›´ç¡®åˆ‡åœ°è¯´æ˜¯æè¿°ï¼‰é€šå¸¸æ²¡ä»€ä¹ˆå¸®åŠ©ï¼š</p>
<p> â€¢ . . . can be called from multiple programming threads without unwanted interaction between the threads.</p>
<p> â€¢ . . . may be called by more than on thread at a time without requiring any other action on the callerâ€™s part.</p>
<p> é€šè¿‡ç±»ä¼¼è¿™æ ·çš„å®šä¹‰ï¼Œä¸å¥‡æ€ªæˆ‘ä»¬ä¸ºä»€ä¹ˆå¯¹çº¿ç¨‹å®‰å…¨å¦‚æ­¤è¿·æƒ‘ã€‚è¿™äº›å®šä¹‰å‡ ä¹å°±æ˜¯åœ¨è¯´â€å¦‚æœå¯ä»¥ä»å¤šä¸ªçº¿ç¨‹å®‰å…¨è°ƒç”¨ç±»ï¼Œé‚£ä¹ˆè¯¥ç±»å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„â€ã€‚è¿™å½“ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„è§£é‡Šï¼Œä½†å¯¹æˆ‘ä»¬åŒºåˆ«çº¿ç¨‹å®‰å…¨ç±»å’Œä¸å®‰å…¨ç±»æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ã€‚æˆ‘ä»¬ä½¿ç”¨â€å®‰å…¨â€æ˜¯ä¸ºäº†è¯´æ˜ä»€ä¹ˆï¼Ÿ</p>
<p> è¦æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œé¦–å…ˆå®ƒå¿…é¡»åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­æ­£ç¡®è¿è¡Œã€‚å¦‚æœæ­£ç¡®å®ç°äº†ç±»ï¼Œé‚£ä¹ˆè¯´æ˜å®ƒç¬¦åˆè§„èŒƒï¼Œå¯¹è¯¥ç±»çš„å¯¹è±¡çš„ä»»ä½•é¡ºåºçš„æ“ä½œï¼ˆå…¬å…±å­—æ®µçš„è¯»å†™ã€å…¬å…±æ–¹æ³•çš„è°ƒç”¨ï¼‰éƒ½ä¸åº”è¯¥ä½¿å¯¹è±¡å¤„äºæ— æ•ˆçŠ¶æ€ï¼›è§‚å¯Ÿå°†å¤„äºæ— æ•ˆçŠ¶æ€çš„å¯¹è±¡ï¼›æˆ–è¿åç±»çš„ä»»ä½•å˜é‡ã€å‰ç½®æ¡ä»¶æˆ–åç½®æ¡ä»¶ã€‚</p>
<p> è€Œä¸”ï¼Œè¦æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œåœ¨ä»å¤šä¸ªçº¿ç¨‹è®¿é—®æ—¶ï¼Œå®ƒå¿…é¡»ç»§ç»­æ­£ç¡®è¿è¡Œï¼Œè€Œä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒæ‰§è¡Œé‚£äº›çº¿ç¨‹çš„è°ƒåº¦å’Œäº¤å‰ï¼Œä¸”æ— éœ€å¯¹éƒ¨åˆ†è°ƒç”¨ä»£ç æ‰§è¡Œä»»ä½•å…¶ä»–åŒæ­¥ã€‚ç»“æœæ˜¯å¯¹çº¿ç¨‹å®‰å…¨å¯¹è±¡çš„æ“ä½œå°†ç”¨äºæŒ‰å›ºå®šçš„æ•´ä½“ä¸€è‡´é¡ºåºå‡ºç°æ‰€æœ‰çº¿ç¨‹ã€‚</p>
<p> å¦‚æœæ²¡æœ‰çº¿ç¨‹ä¹‹é—´çš„æŸç§æ˜ç¡®åè°ƒï¼Œæ¯”å¦‚é”å®šï¼Œè¿è¡Œæ—¶å¯ä»¥éšæ„åœ¨éœ€è¦æ—¶åœ¨å¤šçº¿ç¨‹ä¸­äº¤å‰æ“ä½œæ‰§è¡Œã€‚</p>
<p> åœ¨ JDK 5.0 ä¹‹å‰ï¼Œç¡®ä¿çº¿ç¨‹å®‰å…¨çš„ä¸»è¦æœºåˆ¶æ˜¯ synchronized åŸè¯­ã€‚è®¿é—®å…±äº«å˜é‡ï¼ˆé‚£äº›å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹è®¿é—®çš„å˜é‡ï¼‰çš„çº¿ç¨‹å¿…é¡»ä½¿ç”¨åŒæ­¥æ¥åè°ƒå¯¹å…±äº«å˜é‡çš„è¯»å†™è®¿é—®ã€‚java.util.concurrent åŒ…æä¾›äº†ä¸€äº›å¤‡ç”¨å¹¶å‘åŸè¯­ï¼Œä»¥åŠä¸€ç»„ä¸éœ€è¦ä»»ä½•å…¶ä»–åŒæ­¥çš„çº¿ç¨‹å®‰å…¨å®ç”¨ç¨‹åºç±»ã€‚</p>
</li>
<li><p>ä»¤äººåŒçƒ¦çš„å¹¶å‘</p>
<p> å³ä½¿æ‚¨çš„ç¨‹åºä»æ²¡æœ‰æ˜ç¡®åˆ›å»ºçº¿ç¨‹ï¼Œä¹Ÿå¯èƒ½ä¼šæœ‰è®¸å¤šå·¥å…·æˆ–æ¡†æ¶ä»£è¡¨æ‚¨åˆ›å»ºäº†çº¿ç¨‹ï¼Œè¿™æ—¶è¦æ±‚ä»è¿™äº›çº¿ç¨‹è°ƒç”¨çš„ç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚è¿™æ ·ä¼šå¯¹å¼€å‘äººå‘˜å¸¦æ¥è¾ƒå¤§çš„è®¾è®¡å’Œå®ç°è´Ÿæ‹…ï¼Œå› ä¸ºå¼€å‘çº¿ç¨‹å®‰å…¨ç±»æ¯”å¼€å‘éçº¿ç¨‹å®‰å…¨ç±»æœ‰æ›´å¤šè¦æ³¨æ„çš„äº‹é¡¹ï¼Œä¸”éœ€è¦æ›´å¤šçš„åˆ†æã€‚</p>
</li>
<li><p>AWT å’Œ Swing</p>
<p> è¿™äº› GUI å·¥å…·åŒ…åˆ›å»ºäº†ç§°ä¸ºæ—¶é—´çº¿ç¨‹çš„åå°çº¿ç¨‹ï¼Œå°†ä»è¯¥çº¿ç¨‹è°ƒç”¨é€šè¿‡ GUI ç»„ä»¶æ³¨å†Œçš„ç›‘å¬å™¨ã€‚å› æ­¤ï¼Œå®ç°è¿™äº›ç›‘å¬å™¨çš„ç±»å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
</li>
<li><p>TimerTask</p>
<p> JDK 1.3 ä¸­å¼•å…¥çš„ TimerTask å·¥å…·å…è®¸ç¨åæ‰§è¡Œä»»åŠ¡æˆ–è®¡åˆ’å®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚åœ¨ Timer çº¿ç¨‹ä¸­æ‰§è¡Œ TimerTask äº‹ä»¶ï¼Œè¿™æ„å‘³ç€ä½œä¸º TimerTask æ‰§è¡Œçš„ä»»åŠ¡å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
</li>
<li><p>Servlet å’Œ JavaServer Page æŠ€æœ¯</p>
<p> Servlet å®¹å™¨å¯ä»¥åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œåœ¨å¤šä¸ªçº¿ç¨‹ä¸­åŒæ—¶è°ƒç”¨ç»™å®š servletï¼Œä»è€Œè¿›è¡Œå¤šä¸ªè¯·æ±‚ã€‚å› æ­¤ servlet ç±»å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
</li>
<li><p>RMI</p>
<p> è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆremote method invocationï¼ŒRMIï¼‰å·¥å…·å…è®¸è°ƒç”¨å…¶ä»– JVM ä¸­è¿è¡Œçš„æ“ä½œã€‚å®ç°è¿œç¨‹å¯¹è±¡æœ€æ™®éçš„æ–¹æ³•æ˜¯æ‰©å±• UnicastRemoteObjectã€‚ä¾‹ç¤º UnicastRemoteObject æ—¶ï¼Œå®ƒæ˜¯é€šè¿‡ RMI è°ƒåº¦å™¨æ³¨å†Œçš„ï¼Œè¯¥è°ƒåº¦å™¨å¯èƒ½åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼Œå°†åœ¨è¿™äº›çº¿ç¨‹ä¸­æ‰§è¡Œè¿œç¨‹æ–¹æ³•ã€‚å› æ­¤ï¼Œè¿œç¨‹ç±»å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<p> æ­£å¦‚æ‰€çœ‹åˆ°çš„ï¼Œå³ä½¿åº”ç”¨ç¨‹åºæ²¡æœ‰æ˜ç¡®åˆ›å»ºçº¿ç¨‹ï¼Œä¹Ÿä¼šå‘ç”Ÿè®¸å¤šå¯èƒ½ä¼šä»å…¶ä»–çº¿ç¨‹è°ƒç”¨ç±»çš„æƒ…å†µã€‚å¹¸è¿çš„æ˜¯ï¼Œjava.util.concurrent ä¸­çš„ç±»å¯ä»¥å¤§å¤§ç®€åŒ–ç¼–å†™çº¿ç¨‹å®‰å…¨ç±»çš„ä»»åŠ¡ã€‚</p>
</li>
</ol>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">ä¾‹å­ -- éçº¿ç¨‹å®‰å…¨ servlet</span><br><span class="line"></span><br><span class="line">    ä¸‹åˆ— servlet çœ‹èµ·æ¥åƒæ— å®³çš„ç•™è¨€æ¿ servletï¼Œå®ƒä¿å­˜æ¯ä¸ªæ¥è®¿è€…çš„å§“åã€‚ç„¶è€Œï¼Œè¯¥ servlet ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œè¿™ä¸ª servlet åº”è¯¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚é—®é¢˜åœ¨äºå®ƒä½¿ç”¨ <span class="type">HashSet</span> å­˜å‚¨æ¥è®¿è€…çš„å§“åï¼Œ<span class="type">HashSet</span> ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ç±»ã€‚</span><br><span class="line"></span><br><span class="line">    å½“æˆ‘ä»¬è¯´è¿™ä¸ª servlet ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„æ—¶ï¼Œæ˜¯è¯´å®ƒæ‰€é€ æˆçš„ç ´åä¸ä»…ä»…æ˜¯ä¸¢å¤±ç•™è¨€æ¿è¾“å…¥ã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œç•™è¨€æ¿æ•°æ®ç»“æ„éƒ½å¯èƒ½è¢«ç ´åå¹¶ä¸”æ— æ³•æ¢å¤ã€‚</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">UnsafeGuestbookServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Set</span> visitorSet = <span class="keyword">new</span> <span class="type">HashSet</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> void doGet(<span class="type">HttpServletRequest</span> httpServletRequest,</span><br><span class="line"></span><br><span class="line">             <span class="type">HttpServletResponse</span> httpServletResponse) <span class="keyword">throws</span> <span class="type">ServletException</span>, <span class="type">IOException</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> visitorName = httpServletRequest.getParameter(<span class="string">&quot;NAME&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (visitorName != <span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line">            visitorSet.add(visitorName);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    é€šè¿‡å°† visitorSet çš„å®šä¹‰æ›´æ”¹ä¸ºä¸‹åˆ—ä»£ç ï¼Œå¯ä»¥ä½¿è¯¥ç±»å˜ä¸ºçº¿ç¨‹å®‰å…¨çš„ï¼š</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Set</span> visitorSet = <span class="type">Collections</span>.synchronizedSet(<span class="keyword">new</span> <span class="type">HashSet</span>());</span><br><span class="line"></span><br><span class="line">    å¦‚ä¸Šæ‰€ç¤ºçš„ä¾‹å­æ˜¾ç¤ºçº¿ç¨‹çš„å†…ç½®æ”¯æŒæ˜¯ä¸€æŠŠåŒåˆƒå‰‘ -- è™½ç„¶å®ƒä½¿æ„å»ºå¤šçº¿ç¨‹åº”ç”¨ç¨‹åºå˜å¾—å¾ˆå®¹æ˜“ï¼Œä½†å®ƒåŒæ—¶è¦æ±‚å¼€å‘äººå‘˜æ›´åŠ æ³¨æ„å¹¶å‘é—®é¢˜ï¼Œç”šè‡³åœ¨ä½¿ç”¨ç•™è¨€æ¿ servlet è¿™æ ·æ™®é€šçš„ä¸œè¥¿æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="çº¿ç¨‹å®‰å…¨é›†åˆ"><a href="#çº¿ç¨‹å®‰å…¨é›†åˆ" class="headerlink" title="çº¿ç¨‹å®‰å…¨é›†åˆ"></a>çº¿ç¨‹å®‰å…¨é›†åˆ</h2><blockquote>
<blockquote>
<p>JDK 1.2 ä¸­å¼•å…¥çš„ Collection æ¡†æ¶æ˜¯ä¸€ç§è¡¨ç¤ºå¯¹è±¡é›†åˆçš„é«˜åº¦çµæ´»çš„æ¡†æ¶ï¼Œå®ƒä½¿ç”¨åŸºæœ¬æ¥å£ Listã€Set å’Œ Mapã€‚é€šè¿‡ JDK æä¾›æ¯ä¸ªé›†åˆçš„å¤šæ¬¡å®ç°ï¼ˆHashMapã€Hashtableã€TreeMapã€WeakHashMapã€HashSetã€TreeSetã€Vectorã€ArrayListã€LinkedList ç­‰ç­‰ï¼‰ã€‚å…¶ä¸­ä¸€äº›é›†åˆå·²ç»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ˆHashtable å’Œ Vectorï¼‰ï¼Œé€šè¿‡åŒæ­¥çš„å°è£…å·¥å‚ï¼ˆCollections.synchronizedMap()ã€synchronizedList() å’Œ synchronizedSet()ï¼‰ï¼Œå…¶ä½™çš„é›†åˆå‡å¯è¡¨ç°ä¸ºçº¿ç¨‹å®‰å…¨çš„ã€‚<br>java.util.concurrent åŒ…æ·»åŠ äº†å¤šä¸ªæ–°çš„çº¿ç¨‹å®‰å…¨é›†åˆç±»ï¼ˆConcurrentHashMapã€CopyOnWriteArrayList å’Œ CopyOnWriteArraySetï¼‰ã€‚è¿™äº›ç±»çš„ç›®çš„æ˜¯æä¾›é«˜æ€§èƒ½ã€é«˜åº¦å¯ä¼¸ç¼©æ€§ã€çº¿ç¨‹å®‰å…¨çš„åŸºæœ¬é›†åˆç±»å‹ç‰ˆæœ¬ã€‚<br>java.util ä¸­çš„çº¿ç¨‹é›†åˆä»æœ‰ä¸€äº›ç¼ºç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿­ä»£é”å®šæ—¶ï¼Œé€šå¸¸éœ€è¦å°†è¯¥é”å®šä¿ç•™åœ¨é›†åˆä¸­ï¼Œå¦åˆ™ï¼Œä¼šæœ‰æŠ›å‡º ConcurrentModificationException çš„å±é™©ã€‚ï¼ˆè¿™ä¸ªç‰¹æ€§æœ‰æ—¶ç§°ä¸ºæ¡ä»¶çº¿ç¨‹å®‰å…¨ï¼›æœ‰å…³çš„æ›´å¤šè¯´æ˜ï¼Œè¯·å‚é˜…å‚è€ƒèµ„æ–™ã€‚ï¼‰æ­¤å¤–ï¼Œå¦‚æœä»å¤šä¸ªçº¿ç¨‹é¢‘ç¹åœ°è®¿é—®é›†åˆï¼Œåˆ™å¸¸å¸¸ä¸èƒ½å¾ˆå¥½åœ°æ‰§è¡Œè¿™äº›ç±»ã€‚java.util.concurrent ä¸­çš„æ–°é›†åˆç±»å…è®¸é€šè¿‡åœ¨è¯­ä¹‰ä¸­çš„å°‘é‡æ›´æ”¹æ¥è·å¾—æ›´é«˜çš„å¹¶å‘ã€‚<br>JDK 5.0 è¿˜æä¾›äº†ä¸¤ä¸ªæ–°é›†åˆæ¥å£ â€“ Queue å’Œ BlockingQueueã€‚Queue æ¥å£ä¸ List ç±»ä¼¼ï¼Œä½†å®ƒåªå…è®¸ä»åé¢æ’å…¥ï¼Œä»å‰é¢åˆ é™¤ã€‚é€šè¿‡æ¶ˆé™¤ List çš„éšæœºè®¿é—®è¦æ±‚ï¼Œå¯ä»¥åˆ›å»ºæ¯”ç°æœ‰ ArrayList å’Œ LinkedList å®ç°æ€§èƒ½æ›´å¥½çš„ Queue å®ç°ã€‚å› ä¸º List çš„è®¸å¤šåº”ç”¨ç¨‹åºå®é™…ä¸Šä¸éœ€è¦éšæœºè®¿é—®ï¼Œæ‰€ä»¥Queue é€šå¸¸å¯ä»¥æ›¿ä»£ Listï¼Œæ¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p>
</blockquote>
</blockquote>
<ol>
<li><p>å¼±ä¸€è‡´çš„è¿­ä»£å™¨</p>
<p> java.util åŒ…ä¸­çš„é›†åˆç±»éƒ½è¿”å› fail-fast è¿­ä»£å™¨ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å‡è®¾çº¿ç¨‹åœ¨é›†åˆå†…å®¹ä¸­è¿›è¡Œè¿­ä»£æ—¶ï¼Œé›†åˆä¸ä¼šæ›´æ”¹å®ƒçš„å†…å®¹ã€‚å¦‚æœ fail-fast è¿­ä»£å™¨æ£€æµ‹åˆ°åœ¨è¿­ä»£è¿‡ç¨‹ä¸­è¿›è¡Œäº†æ›´æ”¹æ“ä½œï¼Œé‚£ä¹ˆå®ƒä¼šæŠ›å‡º ConcurrentModificationExceptionï¼Œè¿™æ˜¯ä¸å¯æ§å¼‚å¸¸ã€‚</p>
<p> åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¸æ›´æ”¹é›†åˆçš„è¦æ±‚é€šå¸¸ä¼šå¯¹è®¸å¤šå¹¶å‘åº”ç”¨ç¨‹åºé€ æˆä¸ä¾¿ã€‚ç›¸åï¼Œæ¯”è¾ƒå¥½çš„æ˜¯å®ƒå…è®¸å¹¶å‘ä¿®æ”¹å¹¶ç¡®ä¿è¿­ä»£å™¨åªè¦è¿›è¡Œåˆç†æ“ä½œï¼Œå°±å¯ä»¥æä¾›é›†åˆçš„ä¸€è‡´è§†å›¾ï¼Œå¦‚ java.util.concurrent é›†åˆç±»ä¸­çš„è¿­ä»£å™¨æ‰€åšçš„é‚£æ ·ã€‚</p>
<p> java.util.concurrent é›†åˆè¿”å›çš„è¿­ä»£å™¨ç§°ä¸ºå¼±ä¸€è‡´çš„ï¼ˆweakly consistentï¼‰è¿­ä»£å™¨ã€‚å¯¹äºè¿™äº›ç±»ï¼Œå¦‚æœå…ƒç´ è‡ªä»è¿­ä»£å¼€å§‹å·²ç»åˆ é™¤ï¼Œä¸”å°šæœªç”± next() æ–¹æ³•è¿”å›ï¼Œé‚£ä¹ˆå®ƒå°†ä¸è¿”å›åˆ°è°ƒç”¨è€…ã€‚å¦‚æœå…ƒç´ è‡ªè¿­ä»£å¼€å§‹å·²ç»æ·»åŠ ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½è¿”å›è°ƒç”¨è€…ï¼Œä¹Ÿå¯èƒ½ä¸è¿”å›ã€‚åœ¨ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œæ— è®ºå¦‚ä½•æ›´æ”¹åº•å±‚é›†åˆï¼Œå…ƒç´ ä¸ä¼šè¢«è¿”å›ä¸¤æ¬¡ã€‚</p>
</li>
<li><p>CopyOnWriteArrayList å’Œ CopyOnWriteArraySet</p>
<p> å¯ä»¥ç”¨ä¸¤ç§æ–¹æ³•åˆ›å»ºçº¿ç¨‹å®‰å…¨æ”¯æŒæ•°æ®çš„ List â€“ Vector æˆ–å°è£… ArrayList å’Œ Collections.synchronizedList()ã€‚java.util.concurrent åŒ…æ·»åŠ äº†åç§°ç¹ççš„ CopyOnWriteArrayListã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬æƒ³è¦æ–°çš„çº¿ç¨‹å®‰å…¨çš„Listç±»ï¼Ÿä¸ºä»€ä¹ˆVectorè¿˜ä¸å¤Ÿï¼Ÿ</p>
<p> æœ€ç®€å•çš„ç­”æ¡ˆæ˜¯ä¸è¿­ä»£å’Œå¹¶å‘ä¿®æ”¹ä¹‹é—´çš„äº¤äº’æœ‰å…³ã€‚ä½¿ç”¨ Vector æˆ–ä½¿ç”¨åŒæ­¥çš„ List å°è£…å™¨ï¼Œè¿”å›çš„è¿­ä»£å™¨æ˜¯ fail-fast çš„ï¼Œè¿™æ„å‘³ç€å¦‚æœåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä»»ä½•å…¶ä»–çº¿ç¨‹ä¿®æ”¹ Listï¼Œè¿­ä»£å¯èƒ½å¤±è´¥ã€‚</p>
</li>
<li><p>Vector çš„éå¸¸æ™®éçš„åº”ç”¨ç¨‹åºæ˜¯å­˜å‚¨é€šè¿‡ç»„ä»¶æ³¨å†Œçš„ç›‘å¬å™¨çš„åˆ—è¡¨ã€‚å½“å‘ç”Ÿé€‚åˆçš„äº‹ä»¶æ—¶ï¼Œè¯¥ç»„ä»¶å°†åœ¨ç›‘å¬å™¨çš„åˆ—è¡¨ä¸­è¿­ä»£ï¼Œè°ƒç”¨æ¯ä¸ªç›‘å¬å™¨ã€‚ä¸ºäº†é˜²æ­¢ ConcurrentModificationExceptionï¼Œè¿­ä»£çº¿ç¨‹å¿…é¡»å¤åˆ¶åˆ—è¡¨æˆ–é”å®šåˆ—è¡¨ï¼Œä»¥ä¾¿è¿›è¡Œæ•´ä½“è¿­ä»£ï¼Œè€Œè¿™ä¸¤ç§æƒ…å†µéƒ½éœ€è¦å¤§é‡çš„æ€§èƒ½æˆæœ¬ã€‚</p>
</li>
<li><p>CopyOnWriteArrayList ç±»é€šè¿‡æ¯æ¬¡æ·»åŠ æˆ–åˆ é™¤å…ƒç´ æ—¶åˆ›å»ºæ”¯æŒæ•°ç»„çš„æ–°å‰¯æœ¬ï¼Œé¿å…äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯è¿›è¡Œä¸­çš„è¿­ä»£ä¿æŒå¯¹åˆ›å»ºè¿­ä»£å™¨æ—¶çš„å½“å‰å‰¯æœ¬è¿›è¡Œæ“ä½œã€‚è™½ç„¶å¤åˆ¶ä¹Ÿä¼šæœ‰ä¸€äº›æˆæœ¬ï¼Œä½†æ˜¯åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿­ä»£è¦æ¯”ä¿®æ”¹å¤šå¾—å¤šï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå†™å…¥æ—¶å¤åˆ¶è¦æ¯”å…¶ä»–å¤‡ç”¨æ–¹æ³•å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œå¹¶å‘æ€§ã€‚</p>
</li>
<li><p>å¦‚æœåº”ç”¨ç¨‹åºéœ€è¦ Set è¯­ä¹‰ï¼Œè€Œä¸æ˜¯ Listï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸€ä¸ª Set ç‰ˆæœ¬ â€“ CopyOnWriteArraySetã€‚</p>
</li>
<li><p>ConcurrentHashMap</p>
<p> æ­£å¦‚å·²ç»å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„ List çš„å®ç°ï¼Œæ‚¨å¯ä»¥ç”¨å¤šç§æ–¹æ³•åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„ã€åŸºäº hash çš„ Map â€“ Hashtableï¼Œå¹¶ä½¿ç”¨ Collections.synchronizedMap() å°è£… HashMapã€‚JDK 5.0 æ·»åŠ äº† ConcurrentHashMap å®ç°ï¼Œè¯¥å®ç°æä¾›äº†ç›¸åŒçš„åŸºæœ¬çº¿ç¨‹å®‰å…¨çš„ Map åŠŸèƒ½ï¼Œä½†å®ƒå¤§å¤§æé«˜äº†å¹¶å‘æ€§ã€‚</p>
<p> Hashtable å’Œ synchronizedMap æ‰€é‡‡å–çš„è·å¾—åŒæ­¥çš„ç®€å•æ–¹æ³•ï¼ˆåŒæ­¥ Hashtable ä¸­æˆ–è€…åŒæ­¥çš„ Map å°è£…å™¨å¯¹è±¡ä¸­çš„æ¯ä¸ªæ–¹æ³•ï¼‰æœ‰ä¸¤ä¸ªä¸»è¦çš„ä¸è¶³ã€‚é¦–å…ˆï¼Œè¿™ç§æ–¹æ³•å¯¹äºå¯ä¼¸ç¼©æ€§æ˜¯ä¸€ç§éšœç¢ï¼Œå› ä¸ºä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—® hash è¡¨ã€‚åŒæ—¶ï¼Œè¿™æ ·ä»ä¸è¶³ä»¥æä¾›çœŸæ­£çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œè®¸å¤šå…¬ç”¨çš„æ··åˆæ“ä½œä»ç„¶éœ€è¦é¢å¤–çš„åŒæ­¥ã€‚è™½ç„¶è¯¸å¦‚ get() å’Œ put() ä¹‹ç±»çš„ç®€å•æ“ä½œå¯ä»¥åœ¨ä¸éœ€è¦é¢å¤–åŒæ­¥çš„æƒ…å†µä¸‹å®‰å…¨åœ°å®Œæˆï¼Œä½†è¿˜æ˜¯æœ‰ä¸€äº›å…¬ç”¨çš„æ“ä½œåºåˆ—ï¼Œä¾‹å¦‚è¿­ä»£æˆ–è€… put-if-absentï¼ˆç©ºåˆ™æ”¾å…¥ï¼‰ï¼Œéœ€è¦å¤–éƒ¨çš„åŒæ­¥ï¼Œä»¥é¿å…æ•°æ®äº‰ç”¨ã€‚</p>
<p> Hashtable å’Œ Collections.synchronizedMap é€šè¿‡åŒæ­¥æ¯ä¸ªæ–¹æ³•è·å¾—çº¿ç¨‹å®‰å…¨ã€‚è¿™æ„å‘³ç€å½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ª Map æ–¹æ³•æ—¶ï¼Œæ— è®ºå…¶ä»–çº¿ç¨‹è¦å¯¹ Map è¿›è¡Œä»€ä¹ˆæ ·æ“ä½œï¼Œéƒ½ä¸èƒ½æ‰§è¡Œï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹ç»“æŸæ‰å¯ä»¥ã€‚</p>
<p> å¯¹æ¯”æ¥è¯´ï¼ŒConcurrentHashMap å…è®¸å¤šä¸ªè¯»å–å‡ ä¹æ€»æ˜¯å¹¶å‘æ‰§è¡Œï¼Œè¯»å’Œå†™æ“ä½œé€šå¸¸å¹¶å‘æ‰§è¡Œï¼Œå¤šä¸ªåŒæ—¶å†™å…¥ç»å¸¸å¹¶å‘æ‰§è¡Œã€‚ç»“æœæ˜¯å½“å¤šä¸ªçº¿ç¨‹éœ€è¦è®¿é—®åŒä¸€ Map æ—¶ï¼Œå¯ä»¥è·å¾—æ›´é«˜çš„å¹¶å‘æ€§ã€‚</p>
<p> åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒConcurrentHashMap æ˜¯ Hashtableæˆ– Collections.synchronizedMap(new HashMap()) çš„ç®€å•æ›¿æ¢ã€‚ç„¶è€Œï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ˜¾è‘—ä¸åŒï¼Œå³ ConcurrentHashMap å®ä¾‹ä¸­çš„åŒæ­¥ä¸é”å®šæ˜ å°„è¿›è¡Œç‹¬å ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œæ²¡æœ‰åŠæ³•é”å®š ConcurrentHashMap è¿›è¡Œç‹¬å ä½¿ç”¨ï¼Œå®ƒè¢«è®¾è®¡ç”¨äºè¿›è¡Œå¹¶å‘è®¿é—®ã€‚ä¸ºäº†ä½¿é›†åˆä¸è¢«é”å®šè¿›è¡Œç‹¬å ä½¿ç”¨ï¼Œè¿˜æä¾›äº†å…¬ç”¨çš„æ··åˆæ“ä½œçš„å…¶ä»–ï¼ˆåŸå­ï¼‰æ–¹æ³•ï¼Œå¦‚ put-if-absentã€‚ConcurrentHashMap è¿”å›çš„è¿­ä»£å™¨æ˜¯å¼±ä¸€è‡´çš„ï¼Œæ„å‘³ç€å®ƒä»¬å°†ä¸æŠ›å‡ºConcurrentModificationException ï¼Œå°†è¿›è¡Œâ€åˆç†æ“ä½œâ€æ¥åæ˜ è¿­ä»£è¿‡ç¨‹ä¸­å…¶ä»–çº¿ç¨‹å¯¹ Map çš„ä¿®æ”¹ã€‚</p>
</li>
<li><p>é˜Ÿåˆ—</p>
<p> åŸå§‹é›†åˆæ¡†æ¶åŒ…å«ä¸‰ä¸ªæ¥å£ï¼šListã€Map å’Œ Setã€‚List æè¿°äº†å…ƒç´ çš„æœ‰åºé›†åˆï¼Œæ”¯æŒå®Œå…¨éšå³è®¿é—® â€“ å¯ä»¥åœ¨ä»»ä½•ä½ç½®æ·»åŠ ã€æå–æˆ–åˆ é™¤å…ƒç´ ã€‚</p>
<p> LinkedList ç±»ç»å¸¸ç”¨äºå­˜å‚¨å·¥ä½œå…ƒç´ ï¼ˆç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼‰çš„åˆ—è¡¨æˆ–é˜Ÿåˆ—ã€‚ç„¶è€Œï¼ŒList æä¾›çš„çµæ´»æ€§æ¯”è¯¥å…¬ç”¨åº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„å¤šå¾—å¤šï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºé€šå¸¸åœ¨åé¢æ’å…¥å…ƒç´ ï¼Œä»å‰é¢åˆ é™¤å…ƒç´ ã€‚ä½†æ˜¯è¦æ”¯æŒå®Œæ•´ List æ¥å£åˆ™æ„å‘³ç€ LinkedList å¯¹äºè¿™é¡¹ä»»åŠ¡ä¸åƒåŸæ¥é‚£æ ·æœ‰æ•ˆã€‚Queue æ¥å£æ¯” List ç®€å•å¾—å¤šï¼Œä»…åŒ…å« put() å’Œ take() æ–¹æ³•ï¼Œå¹¶å…è®¸æ¯” LinkedList æ›´æœ‰æ•ˆçš„å®ç°ã€‚</p>
<p> Queue æ¥å£è¿˜å…è®¸å®ç°æ¥ç¡®å®šå­˜å‚¨å…ƒç´ çš„é¡ºåºã€‚ConcurrentLinkedQueue ç±»å®ç°å…ˆè¿›å…ˆå‡ºï¼ˆfirst-in-first-outï¼ŒFIFOï¼‰é˜Ÿåˆ—ï¼Œè€Œ PriorityQueue ç±»å®ç°ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆä¹Ÿç§°ä¸ºå †ï¼‰ï¼Œå®ƒå¯¹äºæ„å»ºè°ƒåº¦å™¨éå¸¸æœ‰ç”¨ï¼Œè°ƒåº¦å™¨å¿…é¡»æŒ‰ä¼˜å…ˆçº§æˆ–é¢„æœŸçš„æ‰§è¡Œæ—¶é—´æ‰§è¡Œä»»åŠ¡ã€‚</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Queue</span> <span class="keyword">extends</span> <span class="title">Collection</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">offer</span><span class="params">(E x)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">E <span class="title">poll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">E <span class="title">remove</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchElementException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">E <span class="title">peek</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">E <span class="title">element</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchElementException</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> å®ç° Queue çš„ç±»æ˜¯ï¼š</p>
<pre><code> â€¢ LinkedList å·²ç»è¿›è¡Œäº†æ”¹è¿›æ¥å®ç° Queueã€‚

 â€¢ PriorityQueue éçº¿ç¨‹å®‰å…¨çš„ä¼˜å…ˆçº§å¯¹åˆ—ï¼ˆå †ï¼‰å®ç°ï¼Œæ ¹æ®è‡ªç„¶é¡ºåºæˆ–æ¯”è¾ƒå™¨è¿”å›å…ƒç´ ã€‚

 â€¢ ConcurrentLinkedQueue å¿«é€Ÿã€çº¿ç¨‹å®‰å…¨çš„ã€æ— é˜»å¡ FIFO é˜Ÿåˆ—ã€‚</code></pre>
</li>
<li><p>ä»»åŠ¡ç®¡ç†ä¹‹çº¿ç¨‹åˆ›å»º</p>
<p> çº¿ç¨‹æœ€æ™®éçš„ä¸€ä¸ªåº”ç”¨ç¨‹åºæ˜¯åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼Œä»¥æ‰§è¡Œç‰¹å®šç±»å‹çš„ä»»åŠ¡ã€‚Timer ç±»åˆ›å»ºçº¿ç¨‹æ¥æ‰§è¡Œ TimerTask å¯¹è±¡ï¼ŒSwing åˆ›å»ºçº¿ç¨‹æ¥å¤„ç† UI äº‹ä»¶ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸­ï¼Œåœ¨å•ç‹¬çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä»»åŠ¡éƒ½å‡å®šæ˜¯çŸ­æœŸçš„ï¼Œè¿™äº›çº¿ç¨‹æ˜¯ä¸ºäº†å¤„ç†å¤§é‡çŸ­æœŸä»»åŠ¡è€Œå­˜åœ¨çš„ã€‚</p>
<p> åœ¨å…¶ä¸­æ¯ç§æƒ…å†µä¸­ï¼Œè¿™äº›çº¿ç¨‹ä¸€èˆ¬éƒ½æœ‰éå¸¸ç®€å•çš„ç»“æ„ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (no tasks)</span><br><span class="line"></span><br><span class="line">    wait <span class="keyword">for</span> a task;</span><br><span class="line"></span><br><span class="line">  execute the task;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> é€šè¿‡ä¾‹ç¤ºä» Thread è·å¾—çš„å¯¹è±¡å¹¶è°ƒç”¨ Thread.start() æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹ã€‚å¯ä»¥ç”¨ä¸¤ç§æ–¹æ³•åˆ›å»ºçº¿ç¨‹ï¼šé€šè¿‡æ‰©å±• Thread å’Œè¦†ç›– run() æ–¹æ³•ï¼Œæˆ–è€…é€šè¿‡å®ç° Runnable æ¥å£å’Œä½¿ç”¨ Thread(Runnable) æ„é€ å‡½æ•°ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WorkerThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123; <span class="comment">/* do work */</span> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Thread t = <span class="keyword">new</span> WorkerThread();</span><br><span class="line"></span><br><span class="line">t.start();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> æˆ–è€…ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123; <span class="comment">/* do work */</span> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t.start();</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>é‡æ–°ä½¿ç”¨çº¿ç¨‹</p>
<p> å› ä¸ºå¤šä¸ªåŸå› ï¼Œç±»ä¼¼ Swing GUI çš„æ¡†æ¶ä¸ºäº‹ä»¶ä»»åŠ¡åˆ›å»ºå•ä¸€çº¿ç¨‹ï¼Œè€Œä¸æ˜¯ä¸ºæ¯é¡¹ä»»åŠ¡åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚é¦–å…ˆæ˜¯å› ä¸ºåˆ›å»ºçº¿ç¨‹ä¼šæœ‰é—´æ¥æˆæœ¬ï¼Œæ‰€ä»¥åˆ›å»ºçº¿ç¨‹æ¥æ‰§è¡Œç®€å•ä»»åŠ¡å°†æ˜¯ä¸€ç§èµ„æºæµªè´¹ã€‚é€šè¿‡é‡æ–°ä½¿ç”¨äº‹ä»¶çº¿ç¨‹æ¥å¤„ç†å¤šä¸ªäº‹ä»¶ï¼Œå¯åŠ¨å’Œæ‹†å¸æˆæœ¬ï¼ˆéšå¹³å°è€Œå˜ï¼‰ä¼šåˆ†æ‘Šåœ¨å¤šä¸ªäº‹ä»¶ä¸Šã€‚</p>
<p> Swing ä¸ºäº‹ä»¶ä½¿ç”¨å•ä¸€åå°çº¿ç¨‹çš„å¦ä¸€ä¸ªåŸå› æ˜¯ç¡®ä¿äº‹ä»¶ä¸ä¼šäº’ç›¸å¹²æ¶‰ï¼Œå› ä¸ºç›´åˆ°å‰ä¸€äº‹ä»¶ç»“æŸï¼Œä¸‹ä¸€äº‹ä»¶æ‰å¼€å§‹å¤„ç†ã€‚è¯¥æ–¹æ³•ç®€åŒ–äº†äº‹ä»¶å¤„ç†ç¨‹åºçš„ç¼–å†™ã€‚</p>
<p> ä½¿ç”¨å¤šä¸ªçº¿ç¨‹ï¼Œå°†è¦åšæ›´å¤šçš„å·¥ä½œæ¥ç¡®ä¿ä¸€æ¬¡ä»…ä¸€ä¸ªçº¿ç¨‹åœ°æ‰§è¡Œçº¿ç¨‹ç›¸å…³çš„ä»£ç ã€‚</p>
</li>
<li><p>å¦‚ä½•ä¸å¯¹ä»»åŠ¡è¿›è¡Œç®¡ç†</p>
<p> å¤§å¤šæ•°æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼ˆå¦‚ Web æœåŠ¡å™¨ã€POP æœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨æˆ–æ–‡ä»¶æœåŠ¡å™¨ï¼‰ä»£è¡¨è¿œç¨‹å®¢æˆ·æœºå¤„ç†è¯·æ±‚ï¼Œè¿™äº›å®¢æˆ·æœºé€šå¸¸ä½¿ç”¨ socket è¿æ¥åˆ°æœåŠ¡å™¨ã€‚å¯¹äºæ¯ä¸ªè¯·æ±‚ï¼Œé€šå¸¸è¦è¿›è¡Œå°‘é‡å¤„ç†ï¼ˆè·å¾—è¯¥æ–‡ä»¶çš„ä»£ç å—ï¼Œå¹¶å°†å…¶å‘é€å› socketï¼‰ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰å¤§é‡ï¼ˆä¸”ä¸å—é™åˆ¶ï¼‰çš„å®¢æˆ·æœºè¯·æ±‚æœåŠ¡ã€‚</p>
<p> ç”¨äºæ„å»ºæœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„ç®€å•åŒ–æ¨¡å‹ä¼šä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚ä¸‹åˆ—ä»£ç æ®µå®ç°ç®€å•çš„ Web æœåŠ¡å™¨ï¼Œå®ƒæ¥å—ç«¯å£ 80 çš„ socket è¿æ¥ï¼Œå¹¶åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†è¯·æ±‚ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¯¥ä»£ç ä¸æ˜¯å®ç° Web æœåŠ¡å™¨çš„å¥½æ–¹æ³•ï¼Œå› ä¸ºåœ¨é‡è´Ÿè½½æ¡ä»¶ä¸‹å®ƒå°†å¤±è´¥ï¼Œåœæ­¢æ•´å°æœåŠ¡å™¨ã€‚</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UnreliableWebServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ServerSocket socket = <span class="keyword">new</span> ServerSocket(<span class="number">80</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">final</span> Socket connection = socket.accept();</span><br><span class="line"></span><br><span class="line">      Runnable r = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">          handleRequest(connection);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Don&#x27;t do this!</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">new</span> Thread(r).start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> å½“æœåŠ¡å™¨è¢«è¯·æ±‚åæ²¡æ—¶ï¼ŒUnreliableWebServer ç±»ä¸èƒ½å¾ˆå¥½åœ°å¤„ç†è¿™ç§æƒ…å†µã€‚æ¯æ¬¡æœ‰è¯·æ±‚æ—¶ï¼Œå°±ä¼šåˆ›å»ºæ–°çš„ç±»ã€‚æ ¹æ®æ“ä½œç³»ç»Ÿå’Œå¯ç”¨å†…å­˜ï¼Œå¯ä»¥åˆ›å»ºçš„çº¿ç¨‹æ•°æ˜¯æœ‰é™çš„ã€‚</p>
<p> ä¸å¹¸çš„æ˜¯ï¼Œæ‚¨é€šå¸¸ä¸çŸ¥é“é™åˆ¶æ˜¯å¤šå°‘ â€“ åªæœ‰å½“åº”ç”¨ç¨‹åºå› ä¸º OutOfMemoryError è€Œå´©æºƒæ—¶æ‰å‘ç°ã€‚</p>
<p> å¦‚æœè¶³å¤Ÿå¿«åœ°åœ¨è¿™å°æœåŠ¡å™¨ä¸ŠæŠ›å‡ºè¯·æ±‚çš„è¯ï¼Œæœ€ç»ˆå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹åˆ›å»ºå°†å¤±è´¥ï¼Œç”Ÿæˆçš„ Error ä¼šå…³é—­æ•´ä¸ªåº”ç”¨ç¨‹åºã€‚å½“ä¸€æ¬¡ä»…èƒ½æœ‰æ•ˆæ”¯æŒå¾ˆå°‘çº¿ç¨‹æ—¶ï¼Œæ²¡æœ‰å¿…è¦åˆ›å»ºä¸Šåƒä¸ª</p>
<p> çº¿ç¨‹ï¼Œæ— è®ºå¦‚ä½•ï¼Œè¿™æ ·ä½¿ç”¨èµ„æºå¯èƒ½ä¼šæŸå®³æ€§èƒ½ã€‚åˆ›å»ºçº¿ç¨‹ä¼šä½¿ç”¨ç›¸å½“ä¸€éƒ¨åˆ†å†…å­˜ï¼Œå…¶ä¸­åŒ…æ‹¬æœ‰ä¸¤ä¸ªå †æ ˆï¼ˆJava å’Œ Cï¼‰ï¼Œä»¥åŠæ¯çº¿ç¨‹æ•°æ®ç»“æ„ã€‚å¦‚æœåˆ›å»ºè¿‡å¤šçº¿ç¨‹ï¼Œå…¶ä¸­</p>
<p> æ¯ä¸ªçº¿ç¨‹éƒ½å°†å ç”¨ä¸€äº› CPU æ—¶é—´ï¼Œç»“æœå°†ä½¿ç”¨è®¸å¤šå†…å­˜æ¥æ”¯æŒå¤§é‡çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½è¿è¡Œå¾—å¾ˆæ…¢ã€‚è¿™æ ·å°±æ— æ³•å¾ˆå¥½åœ°ä½¿ç”¨è®¡ç®—èµ„æºã€‚</p>
</li>
<li><p>ä½¿ç”¨çº¿ç¨‹æ± è§£å†³é—®é¢˜</p>
<p> ä¸ºä»»åŠ¡åˆ›å»ºæ–°çš„çº¿ç¨‹å¹¶ä¸ä¸€å®šä¸å¥½ï¼Œä½†æ˜¯å¦‚æœåˆ›å»ºä»»åŠ¡çš„é¢‘ç‡é«˜ï¼Œè€Œå¹³å‡ä»»åŠ¡æŒç»­æ—¶é—´ä½ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯é¡¹ä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹å°†äº§ç”Ÿæ€§èƒ½ï¼ˆå¦‚æœè´Ÿè½½ä¸å¯é¢„çŸ¥ï¼Œè¿˜æœ‰ç¨³å®šæ€§ï¼‰é—®é¢˜ã€‚</p>
<p> å¦‚æœä¸æ˜¯æ¯é¡¹ä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œåˆ™æœåŠ¡å™¨åº”ç”¨ç¨‹åºå¿…é¡»é‡‡å–ä¸€äº›æ–¹æ³•æ¥é™åˆ¶ä¸€æ¬¡å¯ä»¥å¤„ç†çš„è¯·æ±‚æ•°ã€‚è¿™æ„å‘³ç€æ¯æ¬¡éœ€è¦å¯åŠ¨æ–°çš„ä»»åŠ¡æ—¶ï¼Œå®ƒä¸èƒ½ä»…è°ƒç”¨ä¸‹åˆ—ä»£ç ã€‚</p>
<p> new Thread(runnable).start()</p>
<p> ç®¡ç†ä¸€å¤§ç»„å°ä»»åŠ¡çš„æ ‡å‡†æœºåˆ¶æ˜¯ç»„åˆå·¥ä½œé˜Ÿåˆ—å’Œçº¿ç¨‹æ± ã€‚å·¥ä½œé˜Ÿåˆ—å°±æ˜¯è¦å¤„ç†çš„ä»»åŠ¡çš„é˜Ÿåˆ—ï¼Œå‰é¢æè¿°çš„ Queue ç±»å®Œå…¨é€‚åˆã€‚çº¿ç¨‹æ± æ˜¯çº¿ç¨‹çš„é›†åˆï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æå–å…¬ç”¨å·¥ä½œé˜Ÿåˆ—ã€‚å½“ä¸€ä¸ªå·¥ä½œçº¿ç¨‹å®Œæˆä»»åŠ¡å¤„ç†åï¼Œå®ƒä¼šè¿”å›é˜Ÿåˆ—ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å…¶ä»–ä»»åŠ¡éœ€è¦å¤„ç†ã€‚å¦‚æœæœ‰ï¼Œå®ƒä¼šè½¬ç§»åˆ°ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶å¼€å§‹å¤„ç†ã€‚</p>
<p> çº¿ç¨‹æ± ä¸ºçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸé—´æ¥æˆæœ¬é—®é¢˜å’Œèµ„æºå´©æºƒé—®é¢˜æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡å¯¹å¤šä¸ªä»»åŠ¡é‡æ–°ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ›å»ºçº¿ç¨‹çš„é—´æ¥æˆæœ¬å°†åˆ†å¸ƒåˆ°å¤šä¸ªä»»åŠ¡ä¸­ã€‚ä½œä¸ºä¸€ç§é¢å¤–å¥½å¤„ï¼Œå› ä¸ºè¯·æ±‚åˆ°è¾¾æ—¶ï¼Œçº¿ç¨‹å·²ç»å­˜åœ¨ï¼Œä»è€Œå¯ä»¥æ¶ˆé™¤ç”±åˆ›å»ºçº¿ç¨‹å¼•èµ·çš„å»¶è¿Ÿã€‚å› æ­¤ï¼Œå¯ä»¥ç«‹å³å¤„ç†è¯·æ±‚ï¼Œä½¿åº”ç”¨ç¨‹åºæ›´æ˜“å“åº”ã€‚è€Œä¸”ï¼Œé€šè¿‡æ­£ç¡®è°ƒæ•´çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ï¼Œå¯ä»¥å¼ºåˆ¶è¶…å‡ºç‰¹å®šé™åˆ¶çš„ä»»ä½•è¯·æ±‚ç­‰å¾…ï¼Œç›´åˆ°æœ‰çº¿ç¨‹å¯ä»¥å¤„ç†å®ƒï¼Œå®ƒä»¬ç­‰å¾…æ—¶æ‰€æ¶ˆè€—çš„èµ„æºè¦å°‘äºä½¿ç”¨é¢å¤–çº¿ç¨‹æ‰€æ¶ˆè€—çš„èµ„æºï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢èµ„æºå´©æºƒã€‚</p>
</li>
<li><p>Executor æ¡†æ¶</p>
<p> java.util.concurrent åŒ…ä¸­åŒ…å«çµæ´»çš„çº¿ç¨‹æ± å®ç°ï¼Œä½†æ˜¯æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒåŒ…å«ç”¨äºç®¡ç†å®ç° Runnable çš„ä»»åŠ¡çš„æ‰§è¡Œçš„æ•´ä¸ªæ¡†æ¶ã€‚è¯¥æ¡†æ¶ç§°ä¸º Executor æ¡†æ¶ã€‚</p>
<p> Executor æ¥å£ç›¸å½“ç®€å•ã€‚å®ƒæè¿°å°†è¿è¡Œ Runnable çš„å¯¹è±¡ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Executor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> ä»»åŠ¡è¿è¡Œäºå“ªä¸ªçº¿ç¨‹ä¸æ˜¯ç”±è¯¥æ¥å£æŒ‡å®šçš„ï¼Œè¿™å–å†³äºä½¿ç”¨çš„ Executor çš„å®ç°ã€‚å®ƒå¯ä»¥è¿è¡Œäºåå°çº¿ç¨‹ï¼Œå¦‚ Swing äº‹ä»¶çº¿ç¨‹ï¼Œæˆ–è€…è¿è¡Œäºçº¿ç¨‹æ± ï¼Œæˆ–è€…è°ƒç”¨çº¿ç¨‹ï¼Œæˆ–è€…æ–°çš„çº¿ç¨‹ï¼Œå®ƒç”šè‡³å¯ä»¥è¿è¡Œäºå…¶ä»– JVMï¼é€šè¿‡åŒæ­¥çš„ Executor æ¥å£æäº¤ä»»åŠ¡ï¼Œä»ä»»åŠ¡æ‰§è¡Œç­–ç•¥ä¸­åˆ é™¤ä»»åŠ¡æäº¤ã€‚Executor æ¥å£ç‹¬è‡ªå…³æ³¨ä»»åŠ¡æäº¤ â€“ è¿™æ˜¯Executor å®ç°çš„é€‰æ‹©ï¼Œç¡®å®šæ‰§è¡Œç­–ç•¥ã€‚è¿™ä½¿åœ¨éƒ¨ç½²æ—¶è°ƒæ•´æ‰§è¡Œç­–ç•¥ï¼ˆé˜Ÿåˆ—é™åˆ¶ã€æ± å¤§å°ã€ä¼˜å…ˆçº§æ’åˆ—ç­‰ç­‰ï¼‰æ›´åŠ å®¹æ˜“ï¼Œæ›´æ”¹çš„ä»£ç æœ€å°‘ã€‚</p>
<p> java.util.concurrent ä¸­çš„å¤§å¤šæ•° Executor å®ç°è¿˜å®ç° ExecutorService æ¥å£ï¼Œè¿™æ˜¯å¯¹ Executor çš„æ‰©å±•ï¼Œå®ƒè¿˜ç®¡ç†æ‰§è¡ŒæœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ä½¿å®ƒä»¬æ›´æ˜“äºç®¡ç†ï¼Œå¹¶å‘ç”Ÿå‘½å¯èƒ½æ¯”å•ç‹¬ Executor çš„ç”Ÿå‘½æ›´é•¿çš„åº”ç”¨ç¨‹åºæä¾›æœåŠ¡ã€‚</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ExecutorService</span> <span class="keyword">extends</span> <span class="title">Executor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">List <span class="title">shutdownNow</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isShutdown</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isTerminated</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">awaitTermination</span><span class="params">(<span class="keyword">long</span> timeout,</span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">                           TimeUnit unit)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// other convenience methods for submitting tasks</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Executor</p>
<p> java.util.concurrent åŒ…åŒ…å«å¤šä¸ª Executor å®ç°ï¼Œæ¯ä¸ªå®ç°éƒ½å®ç°ä¸åŒçš„æ‰§è¡Œç­–ç•¥ã€‚ä»€ä¹ˆæ˜¯æ‰§è¡Œç­–ç•¥ï¼Ÿæ‰§è¡Œç­–ç•¥å®šä¹‰ä½•æ—¶åœ¨å“ªä¸ªçº¿ç¨‹ä¸­è¿è¡Œä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡å¯èƒ½æ¶ˆè€—çš„èµ„æºçº§åˆ«ï¼ˆçº¿ç¨‹ã€å†…å­˜ç­‰ç­‰ï¼‰ï¼Œä»¥åŠå¦‚æœæ‰§è¡Œç¨‹åºè¶…è½½è¯¥æ€ä¹ˆåŠã€‚</p>
<p> æ‰§è¡Œç¨‹åºé€šå¸¸é€šè¿‡å·¥å‚æ–¹æ³•ä¾‹ç¤ºï¼Œè€Œä¸æ˜¯é€šè¿‡æ„é€ å‡½æ•°ã€‚Executors ç±»åŒ…å«ç”¨äºæ„é€ è®¸å¤šä¸åŒç±»å‹çš„ Executor å®ç°çš„é™æ€å·¥å‚æ–¹æ³•ï¼š</p>
<p> â€¢ Executors.newCachedThreadPool() åˆ›å»ºä¸é™åˆ¶å¤§å°çš„çº¿ç¨‹æ± ï¼Œä½†æ˜¯å½“ä»¥å‰åˆ›å»ºçš„çº¿ç¨‹å¯ä»¥ä½¿ç”¨æ—¶å°†é‡æ–°ä½¿ç”¨é‚£äº›çº¿ç¨‹ã€‚å¦‚æœæ²¡æœ‰ç°æœ‰çº¿ç¨‹å¯ç”¨ï¼Œ</p>
<p> â€¢ å°†åˆ›å»ºæ–°çš„çº¿ç¨‹å¹¶å°†å…¶æ·»åŠ åˆ°æ± ä¸­ã€‚ä½¿ç”¨ä¸åˆ° 60 ç§’çš„çº¿ç¨‹å°†ç»ˆæ­¢å¹¶ä»ç¼“å­˜ä¸­åˆ é™¤ã€‚</p>
<p> â€¢ Executors.newFixedThreadPool(int n) åˆ›å»ºçº¿ç¨‹æ± ï¼Œå…¶é‡æ–°ä½¿ç”¨åœ¨ä¸å—é™åˆ¶çš„é˜Ÿåˆ—ä¹‹å¤–è¿è¡Œçš„å›ºå®šçº¿ç¨‹ç»„ã€‚åœ¨å…³é—­å‰ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½ä¼šå› ä¸ºæ‰§è¡Œ</p>
<p> â€¢ è¿‡ç¨‹ä¸­çš„å¤±è´¥è€Œç»ˆæ­¢ï¼Œå¦‚æœéœ€è¦æ‰§è¡Œåç»­ä»»åŠ¡ï¼Œå°†ä¼šæœ‰æ–°çš„çº¿ç¨‹æ¥ä»£æ›¿è¿™äº›çº¿ç¨‹ã€‚</p>
<p> â€¢ Executors.newSingleThreadExecutor() åˆ›å»º Executorï¼Œå…¶ä½¿ç”¨åœ¨ä¸å—é™åˆ¶çš„é˜Ÿåˆ—ä¹‹å¤–è¿è¡Œçš„å•ä¸€å·¥ä½œçº¿ç¨‹ï¼Œä¸ Swing äº‹ä»¶çº¿ç¨‹éå¸¸ç›¸ä¼¼ã€‚</p>
<p> â€¢ ä¿è¯é¡ºåºæ‰§è¡Œä»»åŠ¡ï¼Œåœ¨ä»»ä½•ç»™å®šæ—¶é—´ï¼Œä¸ä¼šæœ‰å¤šä¸ªä»»åŠ¡å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚</p>
<p> æ›´å¯é çš„ Web æœåŠ¡å™¨ â€“ ä½¿ç”¨ Executor</p>
<p> å‰é¢ å¦‚ä½•ä¸å¯¹ä»»åŠ¡è¿›è¡Œç®¡ç† ä¸­çš„ä»£ç æ˜¾ç¤ºäº†å¦‚ä½•ä¸ç”¨ç¼–å†™å¯é æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚å¹¸è¿çš„æ˜¯ï¼Œä¿®å¤è¿™ä¸ªç¤ºä¾‹éå¸¸ç®€å•ï¼Œåªéœ€å°† Thread.start() è°ƒç”¨æ›¿æ¢ä¸ºå‘ Executor æäº¤ä»»åŠ¡å³å¯ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReliableWebServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  Executor pool =</span><br><span class="line"></span><br><span class="line">    Executors.newFixedThreadPool(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ServerSocket socket = <span class="keyword">new</span> ServerSocket(<span class="number">80</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">final</span> Socket connection = socket.accept();</span><br><span class="line"></span><br><span class="line">      Runnable r = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">          handleRequest(connection);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      pool.execute(r);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> æ³¨æ„ï¼Œæœ¬ä¾‹ä¸å‰ä¾‹ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äº Executor çš„åˆ›å»ºä»¥åŠå¦‚ä½•æäº¤æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p>
</li>
</ol>
<ol start="9">
<li>å®šåˆ¶ ThreadPoolExecutor</li>
</ol>
<blockquote>
<blockquote>
<p>Executors ä¸­çš„ newFixedThreadPool å’Œ newCachedThreadPool å·¥å‚æ–¹æ³•è¿”å›çš„ Executor æ˜¯ç±» ThreadPoolExecutor çš„å®ä¾‹ï¼Œæ˜¯é«˜åº¦å¯å®šåˆ¶çš„ã€‚<br>é€šè¿‡ä½¿ç”¨åŒ…å« ThreadFactory å˜é‡çš„å·¥å‚æ–¹æ³•æˆ–æ„é€ å‡½æ•°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥å®šä¹‰æ± çº¿ç¨‹çš„åˆ›å»ºã€‚ThreadFactory æ˜¯å·¥å‚å¯¹è±¡ï¼Œå…¶æ„é€ æ‰§è¡Œç¨‹åºè¦ä½¿ç”¨çš„æ–°çº¿ç¨‹ã€‚<br>ä½¿ç”¨å®šåˆ¶çš„çº¿ç¨‹å·¥å‚ï¼Œåˆ›å»ºçš„çº¿ç¨‹å¯ä»¥åŒ…å«æœ‰ç”¨çš„çº¿ç¨‹åç§°ï¼Œå¹¶ä¸”è¿™äº›çº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œå±äºç‰¹å®šçº¿ç¨‹ç»„æˆ–å…·æœ‰ç‰¹å®šä¼˜å…ˆçº§ã€‚<br>ä¸‹é¢æ˜¯çº¿ç¨‹å·¥å‚çš„ä¾‹å­ï¼Œå®ƒåˆ›å»ºå®ˆæŠ¤çº¿ç¨‹ï¼Œè€Œä¸æ˜¯åˆ›å»ºç”¨æˆ·çº¿ç¨‹ï¼š</p>
</blockquote>
</blockquote>
<pre><code><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaemonThreadFactory</span> <span class="keyword">implements</span> <span class="title">ThreadFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Thread <span class="title">newThread</span><span class="params">(Runnable r)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(r);</span><br><span class="line"></span><br><span class="line">        thread.setDaemon(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> thread;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

æœ‰æ—¶ï¼ŒExecutor ä¸èƒ½æ‰§è¡Œä»»åŠ¡ï¼Œå› ä¸ºå®ƒå·²ç»å…³é—­æˆ–è€…å› ä¸º Executor ä½¿ç”¨å—é™åˆ¶é˜Ÿåˆ—å­˜å‚¨ç­‰å¾…ä»»åŠ¡ï¼Œè€Œè¯¥é˜Ÿåˆ—å·²æ»¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å’¨è¯¢æ‰§è¡Œç¨‹åºçš„ RejectedExecutionHandler æ¥ç¡®å®šå¦‚ä½•å¤„ç†ä»»åŠ¡ -- æŠ›å‡ºå¼‚å¸¸ï¼ˆé»˜è®¤æƒ…å†µï¼‰ï¼Œæ”¾å¼ƒä»»åŠ¡ï¼Œåœ¨è°ƒç”¨è€…çš„çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œæˆ–æ”¾å¼ƒé˜Ÿåˆ—ä¸­æœ€æ—©çš„ä»»åŠ¡ä»¥ä¸ºæ–°ä»»åŠ¡è…¾å‡ºç©ºé—´ã€‚ThreadPoolExecutor.setRejectedExecutionHandler å¯ä»¥è®¾ç½®æ‹’ç»çš„æ‰§è¡Œå¤„ç†ç¨‹åºã€‚

è¿˜å¯ä»¥æ‰©å±• ThreadPoolExecutorï¼Œå¹¶è¦†ç›–æ–¹æ³• beforeExecute å’Œ afterExecuteï¼Œä»¥æ·»åŠ è£…ç½®ï¼Œæ·»åŠ è®°å½•ï¼Œæ·»åŠ è®¡æ—¶ï¼Œé‡æ–°åˆå§‹åŒ–çº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œæˆ–è¿›è¡Œå…¶ä»–æ‰§è¡Œå®šåˆ¶ã€‚

 éœ€è¦ç‰¹åˆ«è€ƒè™‘çš„é—®é¢˜

    ä½¿ç”¨ Executor æ¡†æ¶ä¼šä»æ‰§è¡Œç­–ç•¥ä¸­åˆ é™¤ä»»åŠ¡æäº¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œäººä»¬å¸Œæœ›è¿™æ ·ï¼Œé‚£æ˜¯å› ä¸ºå®ƒå…è®¸æˆ‘ä»¬çµæ´»åœ°è°ƒæ•´æ‰§è¡Œç­–ç•¥ï¼Œä¸å¿…æ›´æ”¹è®¸å¤šä½ç½®çš„ä»£ç ã€‚ç„¶è€Œï¼Œå½“æäº¤ä»£ç æš—å«å‡è®¾ç‰¹å®šæ‰§è¡Œç­–ç•¥æ—¶ï¼Œå­˜åœ¨å¤šç§æƒ…å†µï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œé‡è¦çš„æ˜¯é€‰æ‹©çš„ Executor å®ç°ä¸€è‡´çš„æ‰§è¡Œç­–ç•¥ã€‚

    è¿™ç±»æƒ…å†µä¸­çš„å…¶ä¸­çš„ä¸€ç§å°±æ˜¯ä¸€äº›ä»»åŠ¡åŒæ—¶ç­‰å¾…å…¶ä»–ä»»åŠ¡å®Œæˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“çº¿ç¨‹æ± æ²¡æœ‰è¶³å¤Ÿçš„çº¿ç¨‹æ—¶ï¼Œå¦‚æœæ‰€æœ‰å½“å‰æ‰§è¡Œçš„ä»»åŠ¡éƒ½åœ¨ç­‰å¾…å¦ä¸€é¡¹ä»»åŠ¡ï¼Œè€Œè¯¥ä»»åŠ¡å› ä¸ºçº¿ç¨‹æ± å·²æ»¡ä¸èƒ½æ‰§è¡Œï¼Œé‚£ä¹ˆçº¿ç¨‹æ± å¯èƒ½ä¼šæ­»é”ã€‚

    å¦ä¸€ç§ç›¸ä¼¼çš„æƒ…å†µæ˜¯ä¸€ç»„çº¿ç¨‹å¿…é¡»ä½œä¸ºå…±åŒæ“ä½œç»„ä¸€èµ·å·¥ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦ç¡®ä¿çº¿ç¨‹æ± èƒ½å¤Ÿå®¹çº³æ‰€æœ‰çº¿ç¨‹ã€‚

    å¦‚æœåº”ç”¨ç¨‹åºå¯¹ç‰¹å®šæ‰§è¡Œç¨‹åºè¿›è¡Œäº†ç‰¹å®šå‡è®¾ï¼Œé‚£ä¹ˆåº”è¯¥åœ¨ Executor å®šä¹‰å’Œåˆå§‹åŒ–çš„é™„è¿‘å¯¹è¿™äº›è¿›è¡Œè¯´æ˜ï¼Œä»è€Œä½¿å–„æ„çš„æ›´æ”¹ä¸ä¼šç ´ååº”ç”¨ç¨‹åºçš„æ­£ç¡®åŠŸèƒ½ã€‚

è°ƒæ•´çº¿ç¨‹æ± 

    åˆ›å»º Executor æ—¶ï¼Œäººä»¬æ™®éä¼šé—®çš„ä¸€ä¸ªé—®é¢˜æ˜¯&quot;çº¿ç¨‹æ± åº”è¯¥æœ‰å¤šå¤§ï¼Ÿ&quot;ã€‚å½“ç„¶ï¼Œç­”æ¡ˆå–å†³äºç¡¬ä»¶å’Œå°†æ‰§è¡Œçš„ä»»åŠ¡ç±»å‹ï¼ˆå®ƒä»¬æ˜¯å—è®¡ç®—é™åˆ¶æˆ–æ˜¯å— IO çš„é™åˆ¶ï¼Ÿï¼‰ã€‚

    å¦‚æœçº¿ç¨‹æ± å¤ªå°ï¼Œèµ„æºå¯èƒ½ä¸èƒ½è¢«å……åˆ†åˆ©ç”¨ï¼Œåœ¨ä¸€äº›ä»»åŠ¡è¿˜åœ¨å·¥ä½œé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œæ—¶ï¼Œå¯èƒ½ä¼šæœ‰å¤„ç†å™¨å¤„äºé—²ç½®çŠ¶æ€ã€‚

    å¦ä¸€æ–¹é¢ï¼Œå¦‚æœçº¿ç¨‹æ± å¤ªå¤§ï¼Œåˆ™å°†æœ‰è®¸å¤šæœ‰æ•ˆçº¿ç¨‹ï¼Œå› ä¸ºå¤§é‡çº¿ç¨‹æˆ–æœ‰æ•ˆä»»åŠ¡ä½¿ç”¨å†…å­˜ï¼Œæˆ–è€…å› ä¸ºæ¯é¡¹ä»»åŠ¡è¦æ¯”ä½¿ç”¨å°‘é‡çº¿ç¨‹æœ‰æ›´å¤šä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½å¯èƒ½ä¼šå—æŸã€‚

    æ‰€ä»¥å‡è®¾ä¸ºäº†ä½¿å¤„ç†å™¨å¾—åˆ°å……åˆ†ä½¿ç”¨ï¼Œçº¿ç¨‹æ± åº”è¯¥æœ‰å¤šå¤§ï¼Ÿå¦‚æœçŸ¥é“ç³»ç»Ÿæœ‰å¤šå°‘å¤„ç†å™¨å’Œä»»åŠ¡çš„è®¡ç®—æ—¶é—´å’Œç­‰å¾…æ—¶é—´çš„è¿‘ä¼¼æ¯”ç‡ï¼ŒAmdahl æ³•åˆ™æä¾›å¾ˆå¥½çš„è¿‘ä¼¼å…¬å¼ã€‚

    ç”¨ WT è¡¨ç¤ºæ¯é¡¹ä»»åŠ¡çš„å¹³å‡ç­‰å¾…æ—¶é—´ï¼ŒST è¡¨ç¤ºæ¯é¡¹ä»»åŠ¡çš„å¹³å‡æœåŠ¡æ—¶é—´ï¼ˆè®¡ç®—æ—¶é—´ï¼‰ã€‚åˆ™ WT/ST æ˜¯æ¯é¡¹ä»»åŠ¡ç­‰å¾…æ‰€ç”¨æ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚å¯¹äº N å¤„ç†å™¨ç³»ç»Ÿï¼Œæ± ä¸­å¯ä»¥è¿‘ä¼¼æœ‰ N*(1+WT/ST) ä¸ªçº¿ç¨‹ã€‚

    å¥½çš„æ¶ˆæ¯æ˜¯æ‚¨ä¸å¿…ç²¾ç¡®ä¼°è®¡ WT/STã€‚&quot;åˆé€‚çš„&quot;æ± å¤§å°çš„èŒƒå›´ç›¸å½“å¤§ï¼›åªéœ€è¦é¿å…&quot;è¿‡å¤§&quot;å’Œ&quot;è¿‡å°&quot;çš„æç«¯æƒ…å†µå³å¯ã€‚</code></pre>
<ol start="10">
<li><p>Future æ¥å£</p>
<p>Future æ¥å£å…è®¸è¡¨ç¤ºå·²ç»å®Œæˆçš„ä»»åŠ¡ã€æ­£åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»åŠ¡æˆ–è€…å°šæœªå¼€å§‹æ‰§è¡Œçš„ä»»åŠ¡ã€‚é€šè¿‡ Future æ¥å£ï¼Œå¯ä»¥å°è¯•å–æ¶ˆå°šæœªå®Œæˆçš„ä»»åŠ¡ï¼ŒæŸ¥è¯¢ä»»åŠ¡å·²ç»å®Œæˆè¿˜æ˜¯å–æ¶ˆäº†ï¼Œä»¥åŠæå–ï¼ˆæˆ–ç­‰å¾…ï¼‰ä»»åŠ¡çš„ç»“æœå€¼ã€‚</p>
<p>FutureTask ç±»å®ç°äº† Futureï¼Œå¹¶åŒ…å«ä¸€äº›æ„é€ å‡½æ•°ï¼Œå…è®¸å°† Runnable æˆ– Callableï¼ˆä¼šäº§ç”Ÿç»“æœçš„ Runnableï¼‰å’Œ Future æ¥å£å°è£…ã€‚å› ä¸º FutureTask ä¹Ÿå®ç° Runnableï¼Œæ‰€ä»¥å¯ä»¥åªå°† FutureTask æä¾›ç»™ Executorã€‚ä¸€äº›æäº¤æ–¹æ³•ï¼ˆå¦‚ ExecutorService.submit()ï¼‰é™¤äº†æäº¤ä»»åŠ¡ä¹‹å¤–ï¼Œè¿˜å°†è¿”å› Future æ¥å£ã€‚</p>
<p>Future.get() æ–¹æ³•æ£€ç´¢ä»»åŠ¡è®¡ç®—çš„ç»“æœï¼ˆæˆ–å¦‚æœä»»åŠ¡å®Œæˆï¼Œä½†æœ‰å¼‚å¸¸ï¼Œåˆ™æŠ›å‡º ExecutionExceptionï¼‰ã€‚å¦‚æœä»»åŠ¡å°šæœªå®Œæˆï¼Œé‚£ä¹ˆ Future.get() å°†è¢«é˜»å¡ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆï¼›å¦‚æœä»»åŠ¡å·²ç»å®Œæˆï¼Œé‚£ä¹ˆå®ƒå°†ç«‹å³è¿”å›ç»“æœã€‚</p>
<p>ä½¿ç”¨ Future æ„å»ºç¼“å­˜</p>
<pre><code>è¯¥ç¤ºä¾‹ä»£ç ä¸ java.util.concurrent ä¸­çš„å¤šä¸ªç±»å…³è”ï¼Œçªå‡ºæ˜¾ç¤ºäº† Future çš„åŠŸèƒ½ã€‚å®ƒå®ç°ç¼“å­˜ï¼Œä½¿ç”¨ Future æè¿°ç¼“å­˜å€¼ï¼Œè¯¥å€¼å¯èƒ½å·²ç»è®¡ç®—ï¼Œæˆ–è€…å¯èƒ½åœ¨å…¶ä»–çº¿ç¨‹ä¸­&quot;æ­£åœ¨æ„é€ &quot;ã€‚

å®ƒåˆ©ç”¨ ConcurrentHashMap ä¸­çš„åŸå­ putIfAbsent() æ–¹æ³•ï¼Œç¡®ä¿ä»…æœ‰ä¸€ä¸ªçº¿ç¨‹è¯•å›¾è®¡ç®—ç»™å®šå…³é”®å­—çš„å€¼ã€‚å¦‚æœå…¶ä»–çº¿ç¨‹éšåè¯·æ±‚åŒä¸€å…³é”®å­—çš„å€¼ï¼Œå®ƒä»…èƒ½ç­‰å¾…ï¼ˆé€šè¿‡ Future.get() çš„å¸®åŠ©ï¼‰ç¬¬ä¸€ä¸ªçº¿ç¨‹å®Œæˆã€‚å› æ­¤ä¸¤ä¸ªçº¿ç¨‹ä¸ä¼šè®¡ç®—ç›¸åŒçš„å€¼ã€‚</code></pre>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cache</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ConcurrentMap&gt; map = <span class="keyword">new</span> ConcurrentHashMap();</span><br><span class="line"></span><br><span class="line">    Executor executor = Executors.newFixedThreadPool(<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(<span class="keyword">final</span> K key)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        FutureTask f = map.get(key);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (f == <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">            Callable c = <span class="keyword">new</span> Callable() &#123;</span><br><span class="line"></span><br><span class="line">                <span class="function"><span class="keyword">public</span> V <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// return value associated with key</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            f = <span class="keyword">new</span> FutureTask(c);</span><br><span class="line"></span><br><span class="line">            FutureTask old = map.putIfAbsent(key, f);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (old == <span class="keyword">null</span>)</span><br><span class="line"></span><br><span class="line">                executor.execute(f);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">                f = old;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> f.get();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CompletionService</p>
<p>CompletionService å°†æ‰§è¡ŒæœåŠ¡ä¸ç±»ä¼¼ Queue çš„æ¥å£ç»„åˆï¼Œä»ä»»åŠ¡æ‰§è¡Œä¸­åˆ é™¤ä»»åŠ¡ç»“æœçš„å¤„ç†ã€‚CompletionService æ¥å£åŒ…å«ç”¨æ¥æäº¤å°†è¦æ‰§è¡Œçš„ä»»åŠ¡çš„ submit() æ–¹æ³•å’Œç”¨æ¥è¯¢é—®ä¸‹ä¸€å®Œæˆä»»åŠ¡çš„ take()/poll() æ–¹æ³•ã€‚</p>
<p>CompletionService å…è®¸åº”ç”¨ç¨‹åºç»“æ„åŒ–ï¼Œä½¿ç”¨ Producer/Consumer æ¨¡å¼ï¼Œå…¶ä¸­ç”Ÿäº§è€…åˆ›å»ºä»»åŠ¡å¹¶æäº¤ï¼Œæ¶ˆè´¹è€…è¯·æ±‚å®Œæˆä»»åŠ¡çš„ç»“æœå¹¶å¤„ç†è¿™äº›ç»“æœã€‚CompletionService æ¥å£ç”± ExecutorCompletionService ç±»å®ç°ï¼Œè¯¥ç±»ä½¿ç”¨ Executor å¤„ç†ä»»åŠ¡å¹¶ä» CompletionService å¯¼å‡º submit/poll/take æ–¹æ³•ã€‚</p>
<p>ä¸‹åˆ—ä»£ç ä½¿ç”¨ Executor å’Œ CompletionService æ¥å¯åŠ¨è®¸å¤šâ€solverâ€ä»»åŠ¡ï¼Œå¹¶ä½¿ç”¨ç¬¬ä¸€ä¸ªç”Ÿæˆéç©ºç»“æœçš„ä»»åŠ¡çš„ç»“æœï¼Œç„¶åå–æ¶ˆå…¶ä½™ä»»åŠ¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(Executor e, Collection&gt; solvers)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line"></span><br><span class="line">        CompletionService ecs = <span class="keyword">new</span> ExecutorCompletionService(e);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> n = solvers.size();</span><br><span class="line"></span><br><span class="line">        List&gt; futures = <span class="keyword">new</span> ArrayList&gt;(n);</span><br><span class="line"></span><br><span class="line">        Result result = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (Callable s : solvers)</span><br><span class="line"></span><br><span class="line">                futures.add(ecs.submit(s));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">                    Result r = ecs.take().get();</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (r != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">                        result = r;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">catch</span>(ExecutionException ignore) &#123;&#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (Future f : futures)</span><br><span class="line"></span><br><span class="line">                f.cancel(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (result != <span class="keyword">null</span>)</span><br><span class="line"></span><br><span class="line">            use(result);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="java-util-concurrent-ä¸­å…¶ä»–ç±»åˆ«çš„æœ‰ç”¨çš„ç±»ä¹Ÿæ˜¯åŒæ­¥å·¥å…·ã€‚è¿™ç»„ç±»ç›¸äº’åä½œï¼Œæ§åˆ¶ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹çš„æ‰§è¡Œæµã€‚"><a href="#java-util-concurrent-ä¸­å…¶ä»–ç±»åˆ«çš„æœ‰ç”¨çš„ç±»ä¹Ÿæ˜¯åŒæ­¥å·¥å…·ã€‚è¿™ç»„ç±»ç›¸äº’åä½œï¼Œæ§åˆ¶ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹çš„æ‰§è¡Œæµã€‚" class="headerlink" title="java.util.concurrent ä¸­å…¶ä»–ç±»åˆ«çš„æœ‰ç”¨çš„ç±»ä¹Ÿæ˜¯åŒæ­¥å·¥å…·ã€‚è¿™ç»„ç±»ç›¸äº’åä½œï¼Œæ§åˆ¶ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹çš„æ‰§è¡Œæµã€‚"></a>java.util.concurrent ä¸­å…¶ä»–ç±»åˆ«çš„æœ‰ç”¨çš„ç±»ä¹Ÿæ˜¯åŒæ­¥å·¥å…·ã€‚è¿™ç»„ç±»ç›¸äº’åä½œï¼Œæ§åˆ¶ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹çš„æ‰§è¡Œæµã€‚</h2><p>Semaphoreã€CyclicBarrierã€CountdownLatch å’Œ Exchanger ç±»éƒ½æ˜¯åŒæ­¥å·¥å…·çš„ä¾‹å­ã€‚æ¯ä¸ªç±»éƒ½æœ‰çº¿ç¨‹å¯ä»¥è°ƒç”¨çš„æ–¹æ³•ï¼Œæ–¹æ³•æ˜¯å¦è¢«é˜»å¡å–å†³äºæ­£åœ¨ä½¿ç”¨çš„ç‰¹å®šåŒæ­¥å·¥å…·çš„çŠ¶æ€å’Œè§„åˆ™ã€‚</p>
</li>
<li><p>Semaphore</p>
<p> Semaphore ç±»å®ç°æ ‡å‡† Dijkstra è®¡æ•°ä¿¡å·ã€‚è®¡æ•°ä¿¡å·å¯ä»¥è®¤ä¸ºå…·æœ‰ä¸€å®šæ•°é‡çš„è®¸å¯æƒï¼Œè¯¥è®¸å¯æƒå¯ä»¥è·å¾—æˆ–é‡Šæ”¾ã€‚å¦‚æœæœ‰å‰©ä½™çš„è®¸å¯æƒï¼Œacquire() æ–¹æ³•å°†æˆåŠŸï¼Œå¦åˆ™è¯¥æ–¹æ³•å°†è¢«é˜»å¡ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„è®¸å¯æƒï¼ˆé€šè¿‡å…¶ä»–çº¿ç¨‹é‡Šæ”¾è®¸å¯æƒï¼‰ã€‚çº¿ç¨‹ä¸€æ¬¡å¯ä»¥è·å¾—å¤šä¸ªè®¸å¯æƒã€‚</p>
<p> è®¡æ•°ä¿¡å·å¯ä»¥ç”¨äºé™åˆ¶æœ‰æƒå¯¹èµ„æºè¿›è¡Œå¹¶å‘è®¿é—®çš„çº¿ç¨‹æ•°ã€‚è¯¥æ–¹æ³•å¯¹äºå®ç°èµ„æºæ± æˆ–é™åˆ¶ Web çˆ¬è™«ï¼ˆWeb crawlerï¼‰ä¸­çš„è¾“å‡º socket è¿æ¥éå¸¸æœ‰ç”¨ã€‚</p>
<p> æ³¨æ„ä¿¡å·ä¸è·Ÿè¸ªå“ªä¸ªçº¿ç¨‹æ‹¥æœ‰å¤šå°‘è®¸å¯æƒï¼›è¿™ç”±åº”ç”¨ç¨‹åºæ¥å†³å®šï¼Œä»¥ç¡®ä¿ä½•æ—¶çº¿ç¨‹é‡Šæ”¾è®¸å¯æƒï¼Œè¯¥ä¿¡å·è¡¨ç¤ºå…¶ä»–çº¿ç¨‹æ‹¥æœ‰è®¸å¯æƒæˆ–è€…æ­£åœ¨é‡Šæ”¾è®¸å¯æƒï¼Œä»¥åŠå…¶ä»–çº¿ç¨‹çŸ¥é“å®ƒçš„è®¸å¯æƒå·²é‡Šæ”¾ã€‚</p>
</li>
<li><p>äº’æ–¥</p>
<p> è®¡æ•°ä¿¡å·çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µæ˜¯äº’æ–¥ï¼Œæˆ–è€…äº’æ–¥ä¿¡å·ã€‚äº’æ–¥å°±æ˜¯å…·æœ‰å•ä¸€è®¸å¯æƒçš„è®¡æ•°ä¿¡å·ï¼Œæ„å‘³ç€åœ¨ç»™å®šæ—¶é—´ä»…ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å…·æœ‰è®¸å¯æƒï¼ˆä¹Ÿç§°ä¸ºäºŒè¿›åˆ¶ä¿¡å·ï¼‰ã€‚äº’æ–¥å¯ä»¥ç”¨äºç®¡ç†å¯¹å…±äº«èµ„æºçš„ç‹¬å è®¿é—®ã€‚</p>
<p> è™½ç„¶äº’æ–¥è®¸å¤šåœ°æ–¹ä¸é”å®šä¸€æ ·ï¼Œä½†äº’æ–¥è¿˜æœ‰ä¸€ä¸ªé”å®šé€šå¸¸æ²¡æœ‰çš„å…¶ä»–åŠŸèƒ½ï¼Œå°±æ˜¯äº’æ–¥å¯ä»¥ç”±å…·æœ‰è®¸å¯æƒçš„çº¿ç¨‹ä¹‹å¤–çš„å…¶ä»–çº¿ç¨‹æ¥é‡Šæ”¾ã€‚è¿™åœ¨æ­»é”æ¢å¤æ—¶ä¼šéå¸¸æœ‰ç”¨ã€‚</p>
<p> CyclicBarrier ç±»å¯ä»¥å¸®åŠ©åŒæ­¥ï¼Œå®ƒå…è®¸ä¸€ç»„çº¿ç¨‹ç­‰å¾…æ•´ä¸ªçº¿ç¨‹ç»„åˆ°è¾¾å…¬å…±å±éšœç‚¹ã€‚CyclicBarrier æ˜¯ä½¿ç”¨æ•´å‹å˜é‡æ„é€ çš„ï¼Œå…¶ç¡®å®šç»„ä¸­çš„çº¿ç¨‹æ•°ã€‚å½“ä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼ˆé€šè¿‡è°ƒç”¨ CyclicBarrier.await()ï¼‰ï¼Œå®ƒä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœï¼Œç„¶ååœ¨è¯¥ç‚¹å…è®¸æ‰€æœ‰çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚è¯¥æ“ä½œä¸è®¸å¤šå®¶åº­é€›å•†ä¸šè¡—ç›¸ä¼¼ â€“ æ¯ä¸ªå®¶åº­æˆå‘˜éƒ½è‡ªå·±èµ°ï¼Œå¹¶å•†å®š 1:00 åœ¨ç”µå½±é™¢é›†åˆã€‚å½“æ‚¨åˆ°ç”µå½±é™¢ä½†ä¸æ˜¯æ‰€æœ‰äººéƒ½åˆ°äº†æ—¶ï¼Œæ‚¨ä¼šåä¸‹æ¥ç­‰å…¶ä»–äººåˆ°è¾¾ã€‚ç„¶åæ‰€æœ‰äººä¸€èµ·ç¦»å¼€ã€‚</p>
<p> è®¤ä¸ºå±éšœæ˜¯å¾ªç¯çš„æ˜¯å› ä¸ºå®ƒå¯ä»¥é‡æ–°ä½¿ç”¨ï¼›ä¸€æ—¦æ‰€æœ‰çº¿ç¨‹éƒ½å·²ç»åœ¨å±éšœå¤„é›†åˆå¹¶é‡Šæ”¾ï¼Œåˆ™å¯ä»¥å°†è¯¥å±éšœé‡æ–°åˆå§‹åŒ–åˆ°å®ƒçš„åˆå§‹çŠ¶æ€ã€‚ è¿˜å¯ä»¥æŒ‡å®šåœ¨å±éšœå¤„ç­‰å¾…æ—¶çš„è¶…æ—¶ï¼›å¦‚æœåœ¨è¯¥æ—¶é—´å†…å…¶ä½™çº¿ç¨‹è¿˜æ²¡æœ‰åˆ°è¾¾å±éšœï¼Œåˆ™è®¤ä¸ºå±éšœè¢«æ‰“ç ´ï¼Œæ‰€æœ‰æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ä¼šæ”¶åˆ° BrokenBarrierExceptionã€‚</p>
<p> ä¸‹åˆ—ä»£ç å°†åˆ›å»º CyclicBarrier å¹¶å¯åŠ¨ä¸€ç»„çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å°†è®¡ç®—é—®é¢˜çš„ä¸€éƒ¨åˆ†ï¼Œç­‰å¾…æ‰€æœ‰å…¶ä»–çº¿ç¨‹ç»“æŸä¹‹åï¼Œå†æ£€æŸ¥è§£å†³æ–¹æ¡ˆæ˜¯å¦è¾¾æˆä¸€è‡´ã€‚å¦‚æœä¸ä¸€è‡´ï¼Œé‚£ä¹ˆæ¯ä¸ªå·¥ä½œçº¿ç¨‹å°†å¼€å§‹å¦ä¸€ä¸ªè¿­ä»£ã€‚è¯¥ä¾‹å°†ä½¿ç”¨ CyclicBarrier å˜é‡ï¼Œå®ƒå…è®¸æ³¨å†Œ Runnableï¼Œåœ¨æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾å±éšœä½†è¿˜æ²¡æœ‰é‡Šæ”¾ä»»ä½•çº¿ç¨‹æ—¶æ‰§è¡Œ Runnableã€‚</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solver</span> </span>&#123; <span class="comment">// Code sketch</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">final</span> Problem p, <span class="keyword">int</span> nThreads)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> CyclicBarrier barrier =</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> CyclicBarrier(nThreads,</span><br><span class="line"></span><br><span class="line">      <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123; p.checkConvergence(); &#125;&#125;</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nThreads; ++i) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">final</span> <span class="keyword">int</span> id = i;</span><br><span class="line"></span><br><span class="line">      Runnable worker = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> Segment segment = p.createSegment(id);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (!p.converged()) &#123;</span><br><span class="line"></span><br><span class="line">              segment.update();</span><br><span class="line"></span><br><span class="line">              barrier.await();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">catch</span>(Exception e) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">new</span> Thread(worker).start();</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CountdownLatch</p>
<p> CountdownLatch ç±»ä¸ CyclicBarrier ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒçš„è§’è‰²æ˜¯å¯¹å·²ç»åœ¨å®ƒä»¬ä¸­é—´åˆ†æ‘Šäº†é—®é¢˜çš„ä¸€ç»„çº¿ç¨‹è¿›è¡Œåè°ƒã€‚å®ƒä¹Ÿæ˜¯ä½¿ç”¨æ•´å‹å˜é‡æ„é€ çš„ï¼ŒæŒ‡æ˜è®¡æ•°çš„åˆå§‹å€¼ï¼Œä½†æ˜¯ä¸ CyclicBarrier ä¸åŒçš„æ˜¯ï¼ŒCountdownLatch ä¸èƒ½é‡æ–°ä½¿ç”¨ã€‚</p>
<p> å…¶ä¸­ï¼ŒCyclicBarrier æ˜¯åˆ°è¾¾å±éšœçš„æ‰€æœ‰çº¿ç¨‹çš„å¤§é—¨ï¼Œåªæœ‰å½“æ‰€æœ‰çº¿ç¨‹éƒ½å·²ç»åˆ°è¾¾å±éšœæˆ–å±éšœè¢«æ‰“ç ´æ—¶ï¼Œæ‰å…è®¸è¿™äº›çº¿ç¨‹é€šè¿‡ï¼ŒCountdownLatch å°†åˆ°è¾¾å’Œç­‰å¾…åŠŸèƒ½åˆ†ç¦»ã€‚ä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥é€šè¿‡è°ƒç”¨ countDown() å‡å°‘å½“å‰è®¡æ•°ï¼Œè¿™ç§ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œè€Œåªæ˜¯å‡å°‘è®¡æ•°ã€‚await() æ–¹æ³•çš„è¡Œä¸ºä¸ CyclicBarrier.await() ç¨å¾®æœ‰æ‰€ä¸åŒï¼Œè°ƒç”¨ await() ä»»ä½•çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é—©é”è®¡æ•°å‡å°‘ä¸ºé›¶ï¼Œåœ¨è¯¥ç‚¹ç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹æ‰è¢«é‡Šæ”¾ï¼Œå¯¹ await() çš„åç»­è°ƒç”¨å°†ç«‹å³è¿”å›ã€‚</p>
<p> å½“é—®é¢˜å·²ç»åˆ†è§£ä¸ºè®¸å¤šéƒ¨åˆ†ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½è¢«åˆ†é…ä¸€éƒ¨åˆ†è®¡ç®—æ—¶ï¼ŒCountdownLatch éå¸¸æœ‰ç”¨ã€‚åœ¨å·¥ä½œçº¿ç¨‹ç»“æŸæ—¶ï¼Œå®ƒä»¬å°†å‡å°‘è®¡æ•°ï¼Œåè°ƒçº¿ç¨‹å¯ä»¥åœ¨é—©é”å¤„ç­‰å¾…å½“å‰è¿™ä¸€æ‰¹è®¡ç®—ç»“æŸï¼Œç„¶åç»§ç»­ç§»è‡³ä¸‹ä¸€æ‰¹è®¡ç®—ã€‚</p>
<p> ç›¸ååœ°ï¼Œå…·æœ‰è®¡æ•° 1 çš„ CountdownLatch ç±»å¯ä»¥ç”¨ä½œâ€å¯åŠ¨å¤§é—¨â€ï¼Œæ¥ç«‹å³å¯åŠ¨ä¸€ç»„çº¿ç¨‹ï¼›å·¥ä½œçº¿ç¨‹å¯ä»¥åœ¨é—©é”å¤„ç­‰å¾…ï¼Œåè°ƒçº¿ç¨‹å‡å°‘è®¡æ•°ï¼Œä»è€Œç«‹å³é‡Šæ”¾æ‰€æœ‰å·¥ä½œçº¿ç¨‹ã€‚ä¸‹ä¾‹ä½¿ç”¨ä¸¤ä¸ª CountdownLatcheã€‚ä¸€ä¸ªä½œä¸ºå¯åŠ¨å¤§é—¨ï¼Œä¸€ä¸ªåœ¨æ‰€æœ‰å·¥ä½œçº¿ç¨‹ç»“æŸæ—¶é‡Šæ”¾çº¿ç¨‹ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Driver</span> </span>&#123; <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line"></span><br><span class="line">     CountDownLatch startSignal = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">     CountDownLatch doneSignal = <span class="keyword">new</span> CountDownLatch(N);</span><br><span class="line"></span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) <span class="comment">// create and start threads</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">new</span> Thread(<span class="keyword">new</span> Worker(startSignal, doneSignal)).start();</span><br><span class="line"></span><br><span class="line">     doSomethingElse();            <span class="comment">// don&#x27;t let them run yet</span></span><br><span class="line"></span><br><span class="line">     startSignal.countDown();      <span class="comment">// let all threads proceed</span></span><br><span class="line"></span><br><span class="line">     doSomethingElse();</span><br><span class="line"></span><br><span class="line">     doneSignal.await();           <span class="comment">// wait for all to finish</span></span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Worker</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> CountDownLatch startSignal;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> CountDownLatch doneSignal;</span><br><span class="line"></span><br><span class="line">   Worker(CountDownLatch startSignal, CountDownLatch doneSignal) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">this</span>.startSignal = startSignal;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">this</span>.doneSignal = doneSignal;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">        startSignal.await();</span><br><span class="line"></span><br><span class="line">        doWork();</span><br><span class="line"></span><br><span class="line">        doneSignal.countDown();</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;&#125; <span class="comment">// return;</span></span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Exchanger ç±»æ–¹ä¾¿äº†ä¸¤ä¸ªå…±åŒæ“ä½œçº¿ç¨‹ä¹‹é—´çš„åŒå‘äº¤æ¢ï¼›è¿™æ ·ï¼Œå°±åƒå…·æœ‰è®¡æ•°ä¸º 2 çš„ CyclicBarrierï¼Œå¹¶ä¸”ä¸¤ä¸ªçº¿ç¨‹åœ¨éƒ½åˆ°è¾¾å±éšœæ—¶å¯ä»¥â€äº¤æ¢â€ä¸€äº›çŠ¶æ€ã€‚ï¼ˆExchanger æ¨¡å¼æœ‰æ—¶ä¹Ÿç§°ä¸ºèšé›†ã€‚ï¼‰</p>
<p> Exchanger é€šå¸¸ç”¨äºä¸€ä¸ªçº¿ç¨‹å¡«å……ç¼“å†²ï¼ˆé€šè¿‡è¯»å– socketï¼‰ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹æ¸…ç©ºç¼“å†²ï¼ˆé€šè¿‡å¤„ç†ä» socket æ”¶åˆ°çš„å‘½ä»¤ï¼‰çš„æƒ…å†µã€‚å½“ä¸¤ä¸ªçº¿ç¨‹åœ¨å±éšœå¤„é›†åˆæ—¶ï¼Œå®ƒä»¬äº¤æ¢ç¼“å†²ã€‚ä¸‹åˆ—ä»£ç è¯´æ˜äº†è¿™é¡¹æŠ€æœ¯ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FillAndEmpty</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   Exchanger exchanger = <span class="keyword">new</span> Exchanger();</span><br><span class="line"></span><br><span class="line">   DataBuffer initialEmptyBuffer = <span class="keyword">new</span> DataBuffer();</span><br><span class="line"></span><br><span class="line">   DataBuffer initialFullBuffer = <span class="keyword">new</span> DataBuffer();</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">FillingLoop</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">       DataBuffer currentBuffer = initialEmptyBuffer;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">while</span> (currentBuffer != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">           addToBuffer(currentBuffer);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span> (currentBuffer.full())</span><br><span class="line"></span><br><span class="line">             currentBuffer = exchanger.exchange(currentBuffer);</span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123; ... handle ... &#125;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">EmptyingLoop</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">       DataBuffer currentBuffer = initialFullBuffer;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">while</span> (currentBuffer != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">           takeFromBuffer(currentBuffer);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span> (currentBuffer.empty())</span><br><span class="line"></span><br><span class="line">             currentBuffer = exchanger.exchange(currentBuffer);</span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123; ... handle ...&#125;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">new</span> Thread(<span class="keyword">new</span> FillingLoop()).start();</span><br><span class="line"></span><br><span class="line">     <span class="keyword">new</span> Thread(<span class="keyword">new</span> EmptyingLoop()).start();</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>é”å®šå’ŒåŸå­ä¹‹Lock</p>
<p> Java è¯­è¨€å†…ç½®äº†é”å®šå·¥å…· â€“ synchronized å…³é”®å­—ã€‚å½“çº¿ç¨‹è·å¾—ç›‘è§†å™¨æ—¶ï¼ˆå†…ç½®é”å®šï¼‰ï¼Œå…¶ä»–çº¿ç¨‹å¦‚æœè¯•å›¾è·å¾—ç›¸åŒé”å®šï¼Œé‚£ä¹ˆå®ƒä»¬å°†è¢«é˜»å¡ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾è¯¥é”å®šã€‚åŒæ­¥è¿˜ç¡®ä¿éšåè·å¾—ç›¸åŒé”å®šçš„çº¿ç¨‹å¯ä»¥çœ‹åˆ°ä¹‹å‰çš„çº¿ç¨‹åœ¨å…·æœ‰è¯¥é”å®šæ—¶æ‰€ä¿®æ”¹çš„å˜é‡çš„å€¼ï¼Œä»è€Œç¡®ä¿å¦‚æœç±»æ­£ç¡®åœ°åŒæ­¥äº†å…±äº«çŠ¶æ€çš„è®¿é—®æƒï¼Œé‚£ä¹ˆçº¿ç¨‹å°†ä¸ä¼šçœ‹åˆ°å˜é‡çš„â€å¤±æ•ˆâ€å€¼ï¼Œè¿™æ˜¯ç¼“å­˜æˆ–ç¼–è¯‘å™¨ä¼˜åŒ–çš„ç»“æœã€‚</p>
<p> è™½ç„¶åŒæ­¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å®ƒæœ‰ä¸€äº›é™åˆ¶ï¼Œåœ¨ä¸€äº›é«˜çº§åº”ç”¨ç¨‹åºä¸­ä¼šé€ æˆä¸ä¾¿ã€‚Lock æ¥å£å°†å†…ç½®ç›‘è§†å™¨é”å®šçš„é”å®šè¡Œä¸ºæ™®éåŒ–ï¼Œå…è®¸å¤šä¸ªé”å®šå®ç°ï¼ŒåŒæ—¶æä¾›ä¸€äº›å†…ç½®é”å®šç¼ºå°‘çš„åŠŸèƒ½ï¼Œå¦‚è®¡æ—¶çš„ç­‰å¾…ã€å¯ä¸­æ–­çš„ç­‰å¾…ã€é”å®šè½®è¯¢ã€æ¯ä¸ªé”å®šæœ‰å¤šä¸ªæ¡ä»¶ç­‰å¾…é›†åˆä»¥åŠæ— é˜»å¡ç»“æ„çš„é”å®šã€‚</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Lock</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">lockInterruptibly</span><span class="params">()</span> <span class="keyword">throws</span> IE</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">(<span class="keyword">long</span> time,</span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">                    TimeUnit unit)</span> <span class="keyword">throws</span> IE</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Condition <span class="title">newCondition</span><span class="params">()</span> <span class="keyword">throws</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">                    UnsupportedOperationException</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ReentrantLock</p>
<p> ReentrantLock æ˜¯å…·æœ‰ä¸éšå¼ç›‘è§†å™¨é”å®šï¼ˆä½¿ç”¨ synchronized æ–¹æ³•å’Œè¯­å¥è®¿é—®ï¼‰ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰çš„ Lock çš„å®ç°ï¼Œä½†å®ƒå…·æœ‰æ‰©å±•çš„èƒ½åŠ›ã€‚</p>
<p> ä½œä¸ºé¢å¤–æ”¶è·ï¼Œåœ¨ç«äº‰æ¡ä»¶ä¸‹ï¼ŒReentrantLock çš„å®ç°è¦æ¯”ç°åœ¨çš„ synchronized å®ç°æ›´å…·æœ‰å¯ä¼¸ç¼©æ€§ã€‚ï¼ˆæœ‰å¯èƒ½åœ¨ JVM çš„å°†æ¥ç‰ˆæœ¬ä¸­æ”¹è¿› synchronized çš„ç«äº‰æ€§èƒ½ã€‚ï¼‰</p>
<p> è¿™æ„å‘³ç€å½“è®¸å¤šçº¿ç¨‹éƒ½ç«äº‰ç›¸åŒé”å®šæ—¶ï¼Œä½¿ç”¨ ReentrantLock çš„ååé‡é€šå¸¸è¦æ¯” synchronized å¥½ã€‚æ¢å¥è¯è¯´ï¼Œå½“è®¸å¤šçº¿ç¨‹è¯•å›¾è®¿é—® ReentrantLock ä¿æŠ¤çš„å…±äº«èµ„æºæ—¶ï¼ŒJVM å°†èŠ±è´¹è¾ƒå°‘çš„æ—¶é—´æ¥è°ƒåº¦çº¿ç¨‹ï¼Œè€Œç”¨æ›´å¤šä¸ªæ—¶é—´æ‰§è¡Œçº¿ç¨‹ã€‚</p>
<p> è™½ç„¶ ReentrantLock ç±»æœ‰è®¸å¤šä¼˜ç‚¹ï¼Œä½†æ˜¯ä¸åŒæ­¥ç›¸æ¯”ï¼Œå®ƒæœ‰ä¸€ä¸ªä¸»è¦ç¼ºç‚¹ â€“ å®ƒå¯èƒ½å¿˜è®°é‡Šæ”¾é”å®šã€‚å»ºè®®å½“è·å¾—å’Œé‡Šæ”¾ ReentrantLock æ—¶ä½¿ç”¨ä¸‹åˆ—ç»“æ„ï¼š</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Lock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">lock.lock();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// perform operations protected by lock</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">catch</span>(Exception ex) &#123;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// restore invariants</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">  lock.unlock();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> å› ä¸ºé”å®šå¤±è¯¯ï¼ˆå¿˜è®°é‡Šæ”¾é”å®šï¼‰çš„é£é™©ï¼Œæ‰€ä»¥å¯¹äºåŸºæœ¬é”å®šï¼Œå¼ºçƒˆå»ºè®®æ‚¨ç»§ç»­ä½¿ç”¨ synchronizedï¼Œé™¤éçœŸçš„éœ€è¦ ReentrantLock é¢å¤–çš„çµæ´»æ€§å’Œå¯ä¼¸ç¼©æ€§ã€‚</p>
<p> ReentrantLock æ˜¯ç”¨äºé«˜çº§åº”ç”¨ç¨‹åºçš„é«˜çº§å·¥å…· â€“ æœ‰æ—¶éœ€è¦ï¼Œä½†æœ‰æ—¶ç”¨åŸæ¥çš„æ–¹æ³•å°±å¾ˆå¥½ã€‚</p>
</li>
<li><p>Condition</p>
<p> å°±åƒ Lock æ¥å£æ˜¯åŒæ­¥çš„å…·ä½“åŒ–ï¼ŒCondition æ¥å£æ˜¯ Object ä¸­ wait() å’Œ notify() æ–¹æ³•çš„å…·ä½“åŒ–ã€‚Lock ä¸­çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ newCondition()ï¼Œå®ƒè¦æ±‚é”å®šå‘è¯¥é”å®šè¿”å›æ–°çš„ Condition å¯¹è±¡é™åˆ¶ã€‚await()ã€signal() å’Œ signalAll() æ–¹æ³•ç±»ä¼¼äº wait()ã€notify() å’Œ notifyAll()ï¼Œä½†å¢åŠ äº†çµæ´»æ€§ï¼Œæ¯ä¸ª Lock éƒ½å¯ä»¥åˆ›å»ºå¤šä¸ªæ¡ä»¶å˜é‡ã€‚è¿™ç®€åŒ–äº†ä¸€äº›å¹¶å‘ç®—æ³•çš„å®ç°ã€‚</p>
</li>
<li><p>ReadWriteLock</p>
<p> ReentrantLock å®ç°çš„é”å®šè§„åˆ™éå¸¸ç®€å• â€“ æ¯å½“ä¸€ä¸ªçº¿ç¨‹å…·æœ‰é”å®šæ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°è¯¥é”å®šå¯ç”¨ã€‚æœ‰æ—¶ï¼Œå½“å¯¹æ•°æ®ç»“æ„çš„è¯»å–é€šå¸¸å¤šäºä¿®æ”¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„ç§°ä¸ºè¯»å†™é”å®šçš„é”å®šç»“æ„ï¼Œå®ƒå…è®¸æœ‰å¤šä¸ªå¹¶å‘è¯»è€…ï¼ŒåŒæ—¶è¿˜å…è®¸ä¸€ä¸ªå†™å…¥è€…ç‹¬å é”å®šã€‚è¯¥æ–¹æ³•åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ˆåªè¯»ï¼‰æä¾›äº†æ›´å¤§çš„å¹¶å‘æ€§ï¼ŒåŒæ—¶åœ¨å¿…è¦æ—¶ä»æä¾›ç‹¬å è®¿é—®çš„å®‰å…¨æ€§ã€‚ReadWriteLock æ¥å£å’Œ ReentrantReadWriteLock ç±»æä¾›è¿™ç§åŠŸèƒ½ â€“ å¤šè¯»è€…ã€å•å†™å…¥è€…é”å®šè§„åˆ™ï¼Œå¯ä»¥ç”¨è¿™ç§åŠŸèƒ½æ¥ä¿æŠ¤å…±äº«çš„æ˜“å˜èµ„æºã€‚</p>
</li>
<li><p>åŸå­å˜é‡</p>
<p> å³ä½¿å¤§å¤šæ•°ç”¨æˆ·å°†å¾ˆå°‘ç›´æ¥ä½¿ç”¨å®ƒä»¬ï¼ŒåŸå­å˜é‡ç±»ï¼ˆAtomicIntegerã€AtomicLongã€AtomicReference ç­‰ç­‰ï¼‰ä¹Ÿæœ‰å……åˆ†ç†ç”±æ˜¯æœ€æ˜¾è‘—çš„æ–°å¹¶å‘ç±»ã€‚è¿™äº›ç±»å…¬å¼€å¯¹ JVM çš„ä½çº§åˆ«æ”¹è¿›ï¼Œå…è®¸è¿›è¡Œå…·æœ‰é«˜åº¦å¯ä¼¸ç¼©æ€§çš„åŸå­è¯»-ä¿®æ”¹-å†™æ“ä½œã€‚å¤§å¤šæ•°ç°ä»£ CPU éƒ½æœ‰åŸå­è¯»-ä¿®æ”¹-å†™çš„åŸè¯­ï¼Œæ¯”å¦‚æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCASï¼‰æˆ–åŠ è½½é“¾æ¥/æ¡ä»¶å­˜å‚¨ï¼ˆLL/SCï¼‰ã€‚åŸå­å˜é‡ç±»ä½¿ç”¨ç¡¬ä»¶æä¾›çš„æœ€å¿«çš„å¹¶å‘ç»“æ„æ¥å®ç°ã€‚</p>
<p> è®¸å¤šå¹¶å‘ç®—æ³•éƒ½æ˜¯æ ¹æ®å¯¹è®¡æ•°å™¨æˆ–æ•°æ®ç»“æ„çš„æ¯”è¾ƒå¹¶äº¤æ¢æ“ä½œæ¥å®šä¹‰çš„ã€‚é€šè¿‡æš´éœ²é«˜æ€§èƒ½çš„ã€é«˜åº¦å¯ä¼¸ç¼©çš„ CAS æ“ä½œï¼ˆä»¥åŸå­å˜é‡çš„å½¢å¼ï¼‰ï¼Œç”¨ Java è¯­è¨€å®ç°é«˜æ€§èƒ½ã€æ— ç­‰å¾…ã€æ— é”å®šçš„å¹¶å‘ç®—æ³•å·²ç»å˜å¾—å¯è¡Œã€‚</p>
<p> å‡ ä¹ java.util.concurrent ä¸­çš„æ‰€æœ‰ç±»éƒ½æ˜¯åœ¨ ReentrantLock ä¹‹ä¸Šæ„å»ºçš„ï¼ŒReentrantLock åˆ™æ˜¯åœ¨åŸå­å˜é‡ç±»çš„åŸºç¡€ä¸Šæ„å»ºçš„ã€‚æ‰€ä»¥ï¼Œè™½ç„¶ä»…å°‘æ•°å¹¶å‘ä¸“å®¶ä½¿ç”¨åŸå­å˜é‡ç±»ï¼Œä½† java.util.concurrent ç±»çš„å¾ˆå¤šå¯ä¼¸ç¼©æ€§æ”¹è¿›éƒ½æ˜¯ç”±å®ƒä»¬æä¾›çš„ã€‚</p>
<p> åŸå­å˜é‡ä¸»è¦ç”¨äºä¸ºåŸå­åœ°æ›´æ–°â€çƒ­â€å­—æ®µæä¾›æœ‰æ•ˆçš„ã€ç»†ç²’åº¦çš„æ–¹å¼ï¼Œâ€çƒ­â€å­—æ®µæ˜¯æŒ‡ç”±å¤šä¸ªçº¿ç¨‹é¢‘ç¹è®¿é—®å’Œæ›´æ–°çš„å­—æ®µã€‚å¦å¤–ï¼ŒåŸå­å˜é‡è¿˜æ˜¯è®¡æ•°å™¨æˆ–ç”Ÿæˆåºå·çš„è‡ªç„¶æœºåˆ¶ã€‚</p>
</li>
<li><p>æ€§èƒ½ä¸å¯ä¼¸ç¼©æ€§</p>
<p>è™½ç„¶ java.util.concurrent åŠªåŠ›çš„é¦–è¦ç›®æ ‡æ˜¯ä½¿ç¼–å†™æ­£ç¡®ã€çº¿ç¨‹å®‰å…¨çš„ç±»æ›´åŠ å®¹æ˜“ï¼Œä½†å®ƒè¿˜æœ‰ä¸€ä¸ªæ¬¡è¦ç›®æ ‡ï¼Œå°±æ˜¯æä¾›å¯ä¼¸ç¼©æ€§ã€‚å¯ä¼¸ç¼©æ€§ä¸æ€§èƒ½å®Œå…¨ä¸åŒï¼Œå®é™…ä¸Šï¼Œå¯ä¼¸ç¼©æ€§æœ‰æ—¶è¦ä»¥æ€§èƒ½ä¸ºä»£ä»·æ¥è·å¾—ã€‚</p>
<p>æ€§èƒ½æ˜¯â€å¯ä»¥å¿«é€Ÿæ‰§è¡Œæ­¤ä»»åŠ¡çš„ç¨‹åº¦â€çš„è¯„æµ‹ã€‚å¯ä¼¸ç¼©æ€§æè¿°åº”ç”¨ç¨‹åºçš„ååé‡å¦‚ä½•è¡¨ç°ä¸ºå®ƒçš„å·¥ä½œé‡å’Œå¯ç”¨è®¡ç®—èµ„æºå¢åŠ ã€‚å¯ä¼¸ç¼©çš„ç¨‹åºå¯ä»¥æŒ‰æ¯”ä¾‹ä½¿ç”¨æ›´å¤šçš„å¤„ç†å™¨ã€å†…å­˜æˆ– I/O å¸¦å®½æ¥å¤„ç†æ›´å¤šä¸ªå·¥ä½œé‡ã€‚å½“æˆ‘ä»¬åœ¨å¹¶å‘ç¯å¢ƒä¸­è°ˆè®ºå¯ä¼¸ç¼©æ€§æ—¶ï¼Œæˆ‘ä»¬æ˜¯åœ¨é—®å½“è®¸å¤šçº¿ç¨‹åŒæ—¶è®¿é—®ç»™å®šç±»æ—¶ï¼Œè¿™ä¸ªç±»çš„æ‰§è¡Œæƒ…å†µã€‚</p>
<p>java.util.concurrent ä¸­çš„ä½çº§åˆ«ç±» ReentrantLock å’ŒåŸå­å˜é‡ç±»çš„å¯ä¼¸ç¼©æ€§è¦æ¯”å†…ç½®ç›‘è§†å™¨ï¼ˆåŒæ­¥ï¼‰é”å®šé«˜å¾—å¤šã€‚å› æ­¤ï¼Œä½¿ç”¨ ReentrantLock æˆ–åŸå­å˜é‡ç±»æ¥åè°ƒå…±äº«è®¿é—®çš„ç±»ä¹Ÿå¯èƒ½æ›´å…·æœ‰å¯ä¼¸ç¼©æ€§ã€‚</p>
</li>
<li><p>Hashtable ä¸ ConcurrentHashMap</p>
<p>ä½œä¸ºå¯ä¼¸ç¼©æ€§çš„ä¾‹å­ï¼ŒConcurrentHashMap å®ç°è®¾è®¡çš„å¯ä¼¸ç¼©æ€§è¦æ¯”å…¶çº¿ç¨‹å®‰å…¨çš„ä¸Šä¸€ä»£ Hashtable çš„å¯ä¼¸ç¼©æ€§å¼ºå¾—å¤šã€‚Hashtable ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—® Mapï¼›ConcurrentHashMap å…è®¸å¤šä¸ªè¯»è€…å¹¶å‘æ‰§è¡Œï¼Œè¯»è€…ä¸å†™å…¥è€…å¹¶å‘æ‰§è¡Œï¼Œä»¥åŠä¸€äº›å†™å…¥è€…å¹¶å‘æ‰§è¡Œã€‚å› æ­¤ï¼Œå¦‚æœè®¸å¤šçº¿ç¨‹é¢‘ç¹è®¿é—®å…±äº«æ˜ å°„ï¼Œä½¿ç”¨ ConcurrentHashMap çš„æ€»çš„ååé‡è¦æ¯”ä½¿ç”¨ Hashtable çš„å¥½ã€‚</p>
<p>ä¸‹è¡¨å¤§è‡´è¯´æ˜äº† Hashtable å’Œ ConcurrentHashMap ä¹‹é—´çš„å¯ä¼¸ç¼©æ€§å·®åˆ«ã€‚åœ¨æ¯æ¬¡è¿è¡Œæ—¶ï¼ŒN ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œç´§å¯†å¾ªç¯ï¼Œå®ƒä»¬ä» Hashtable æˆ– ConcurrentHashMap ä¸­æ£€ç´¢éšå³å…³é”®å­—ï¼Œ60% çš„å¤±è´¥æ£€ç´¢å°†æ‰§è¡Œ put() æ“ä½œï¼Œ2% çš„æˆåŠŸæ£€ç´¢æ‰§è¡Œ remove() æ“ä½œã€‚æµ‹è¯•åœ¨è¿è¡Œ Linux çš„åŒå¤„ç†å™¨ Xeon ç³»ç»Ÿä¸­æ‰§è¡Œã€‚æ•°æ®æ˜¾ç¤º 10,000,000 ä¸ªè¿­ä»£çš„è¿è¡Œæ—¶é—´ï¼Œå¯¹äº ConcurrentHashMapï¼Œæ ‡å‡†åŒ–ä¸ºä¸€ä¸ªçº¿ç¨‹çš„æƒ…å†µã€‚å¯ä»¥çœ‹åˆ°ç›´åˆ°è®¸å¤šçº¿ç¨‹ï¼ŒConcurrentHashMap çš„æ€§èƒ½ä»ä¿æŒå¯ä¼¸ç¼©æ€§ï¼Œè€Œ Hashtable çš„æ€§èƒ½åœ¨å‡ºç°é”å®šç«äº‰æ—¶å‡ ä¹ç«‹å³ä¸‹é™ã€‚</p>
<p>ä¸é€šå¸¸çš„æœåŠ¡å™¨åº”ç”¨ç¨‹åºç›¸æ¯”ï¼Œè¿™ä¸ªæµ‹è¯•ä¸­çš„çº¿ç¨‹æ•°çœ‹èµ·æ¥å¾ˆå°‘ã€‚ç„¶è€Œï¼Œå› ä¸ºæ¯ä¸ªçº¿ç¨‹æœªè¿›è¡Œå…¶ä»–æ“ä½œï¼Œä»…æ˜¯é‡å¤åœ°é€‰æ‹©ä½¿ç”¨è¯¥è¡¨ï¼Œæ‰€ä»¥è¿™æ ·å¯ä»¥æ¨¡æ‹Ÿåœ¨æ‰§è¡Œä¸€äº›å®é™…å·¥ä½œçš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥è¡¨çš„å¤§é‡çº¿ç¨‹çš„ç«äº‰ã€‚</p>
<table>
<thead>
<tr>
<th align="center">çº¿ç¨‹</th>
<th align="center">ConcurrentHashMap</th>
<th align="center">Hashtable</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">1.0</td>
<td align="center">1.51</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">1.44</td>
<td align="center">17.09</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">1.83</td>
<td align="center">29.9</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">4.06</td>
<td align="center">54.06</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">7.5</td>
<td align="center">119.44</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">15.32</td>
<td align="center">237.2</td>
</tr>
</tbody></table>
</li>
<li><p>Lock ä¸ synchronized ä¸åŸå­</p>
<p>ä¸‹åˆ—åŸºå‡†è¯´æ˜äº†ä½¿ç”¨ java.util.concurrent å¯èƒ½æ”¹è¿›å¯ä¼¸ç¼©æ€§çš„ä¾‹å­ã€‚è¯¥åŸºå‡†å°†æ¨¡æ‹Ÿæ—‹è½¬éª°å­ï¼Œä½¿ç”¨çº¿æ€§åŒä½™éšæœºæ•°ç”Ÿæˆå™¨ã€‚æœ‰ä¸‰ä¸ªå¯ç”¨çš„éšæœºæ•°ç”Ÿæˆå™¨çš„å®ç°ï¼šä¸€ä¸ªä½¿ç”¨åŒæ­¥æ¥ç®¡ç†ç”Ÿæˆå™¨çš„çŠ¶æ€ï¼ˆå•ä¸€å˜é‡ï¼‰ï¼Œä¸€ä¸ªä½¿ç”¨ ReentrantLockï¼Œå¦ä¸€ä¸ªåˆ™ä½¿ç”¨ AtomicLongã€‚ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ 8-way Ultrasparc3 ç³»ç»Ÿä¸Šï¼Œé€æ¸å¢åŠ çº¿ç¨‹æ•°é‡æ—¶è¿™ä¸‰ä¸ªç‰ˆæœ¬çš„ç›¸å¯¹ååé‡ã€‚ï¼ˆè¯¥å›¾å¯¹åŸå­å˜é‡æ–¹æ³•çš„å¯ä¼¸ç¼©æ€§æè¿°æ¯”è¾ƒä¿å®ˆã€‚ï¼‰</p>
</li>
</ol>
<ol start="13">
<li><p>å…¬å¹³ä¸ä¸å…¬å¹³</p>
<p>java.util.concurrent ä¸­è®¸å¤šç±»ä¸­çš„å¦å¤–ä¸€ä¸ªå®šåˆ¶å…ƒç´ æ˜¯â€å…¬å¹³â€çš„é—®é¢˜ã€‚å…¬å¹³é”å®šæˆ–å…¬å¹³ä¿¡å·æ˜¯æŒ‡åœ¨å…¶ä¸­æ ¹æ®å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŸåˆ™ç»™ä¸çº¿ç¨‹é”å®šæˆ–ä¿¡å·ã€‚ReentrantLockã€Semaphore å’Œ ReentrantReadWriteLock çš„æ„é€ å‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨å˜é‡ç¡®å®šé”å®šæ˜¯å¦å…¬å¹³ï¼Œæˆ–è€…æ˜¯å¦å…è®¸é—¯å…¥ï¼ˆçº¿ç¨‹è·å¾—é”å®šï¼Œå³ä½¿å®ƒä»¬ç­‰å¾…çš„æ—¶é—´ä¸æ˜¯æœ€é•¿ï¼‰ã€‚</p>
<p>è™½ç„¶é—¯å…¥é”å®šçš„æƒ³æ³•å¯èƒ½æœ‰äº›å¯ç¬‘ï¼Œä½†å®é™…ä¸Šä¸å…¬å¹³ã€é—¯å…¥çš„é”å®šéå¸¸æ™®éï¼Œä¸”é€šå¸¸å¾ˆå—æ¬¢è¿ã€‚ä½¿ç”¨åŒæ­¥è®¿é—®çš„å†…ç½®é”å®šä¸æ˜¯å…¬å¹³é”å®šï¼ˆä¸”æ²¡æœ‰åŠæ³•ä½¿å®ƒä»¬å…¬å¹³ï¼‰ã€‚ç›¸åï¼Œå®ƒä»¬æä¾›è¾ƒå¼±çš„ç”Ÿç—…ä¿è¯ï¼Œè¦æ±‚æ‰€æœ‰çº¿ç¨‹æœ€ç»ˆéƒ½å°†è·å¾—é”å®šã€‚</p>
<p>å¤§å¤šæ•°åº”ç”¨ç¨‹åºé€‰æ‹©ï¼ˆä¸”åº”è¯¥é€‰æ‹©ï¼‰é—¯å…¥é”å®šè€Œä¸æ˜¯å…¬å¹³é”å®šçš„åŸå› æ˜¯æ€§èƒ½ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®Œå…¨çš„å…¬å¹³ä¸æ˜¯ç¨‹åºæ­£ç¡®æ€§çš„è¦æ±‚ï¼ŒçœŸæ­£å…¬å¹³çš„æˆæœ¬ç›¸å½“é«˜ã€‚ä¸‹è¡¨å‘å‰é¢çš„é¢æ¿ä¸­çš„è¡¨ä¸­æ·»åŠ äº†ç¬¬å››ä¸ªæ•°æ®é›†ï¼Œå¹¶ç”±ä¸€ä¸ªå…¬å¹³é”å®šç®¡ç†å¯¹ PRNG çŠ¶æ€çš„è®¿é—®ã€‚æ³¨æ„é—¯å…¥é”å®šä¸å…¬å¹³é”å®šä¹‹é—´ååé‡çš„å·¨å¤§å·®åˆ«ã€‚</p>
</li>
</ol>
<h2 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h2><pre><code>java.util.concurrent åŒ…ä¸­åŒ…å«å¤§é‡æœ‰ç”¨çš„æ„å»ºå¿«ï¼Œå¯ä»¥ç”¨å®ƒä»¬æ¥æ”¹è¿›å¹¶å‘ç±»çš„æ€§èƒ½ã€å¯ä¼¸ç¼©æ€§ã€çº¿ç¨‹å®‰å…¨å’Œå¯ç»´æŠ¤æ€§ã€‚é€šè¿‡è¿™äº›æ„å»ºå¿«ï¼Œåº”è¯¥å¯ä»¥ä¸å†éœ€è¦åœ¨æ‚¨çš„ä»£ç ä¸­å¤§é‡ä½¿ç”¨åŒæ­¥ã€wait/notify å’Œ Thread.start()ï¼Œè€Œç”¨æ›´é«˜çº§åˆ«ã€æ ‡å‡†åŒ–çš„ã€é«˜æ€§èƒ½å¹¶å‘å®ç”¨ç¨‹åºæ¥æ›¿æ¢å®ƒä»¬ã€‚

Exchanger,CyclicBarrier,Synchronizer</code></pre>
<hr>
<p>æœ¬æ–‡ç”± blogåšä¸»Caoerï¼ˆè‰å„¿ï¼‰åŸåˆ›ï¼Œæ­¤å¤„ä¸ºè½¬è½½ã€‚</p>
<p>ç”±äºåŸæ–‡ä¸¤å¼ å›¾ç‰‡ä¸æ–¹ä¾¿æ˜¾ç¤º,è¿™é‡Œæš‚æ—¶å»æ‰ï¼Œè½¬è½½æ—¶æœ¬åš(<a target="_blank" rel="noopener" href="http://www.blogjava.net/mlh123caoer/archive/2007/10/24/155474.html)%E9%87%8D%E6%96%B0%E5%BC%95%E7%94%A8%E4%BA%86%E5%9B%BE%E7%89%87%EF%BC%8C%E5%B9%B6%E8%B0%83%E6%95%B4%E4%BA%86%E7%89%88%E9%9D%A2%E3%80%82">http://www.blogjava.net/mlh123caoer/archive/2007/10/24/155474.html)é‡æ–°å¼•ç”¨äº†å›¾ç‰‡ï¼Œå¹¶è°ƒæ•´äº†ç‰ˆé¢ã€‚</a></p>
<p>å¦‚åŸåˆ›ä½œè€…è®¤ä¸ºæœ¬æ–‡ä¾µæƒï¼Œè¯·é€šçŸ¥æœ¬åšã€‚</p>
<blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://tutorials.jenkov.com/java-concurrency/index.html">å¹¶å‘å‚è€ƒå­¦ä¹ </a></p>
</blockquote>
</blockquote>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">å¤šçº¿ç¨‹</a>
                
                    <a href="/tags/%E5%B9%B6%E5%8F%91/">å¹¶å‘</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2016/10/13/dubbo/">
                    Dubbo
                </a>
            </h2>
        
        <time>
            10æœˆ 13, 2016
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <h2 id="Dubboåœ¨é¡¹ç›®ä¸­çš„ä½œç”¨"><a href="#Dubboåœ¨é¡¹ç›®ä¸­çš„ä½œç”¨" class="headerlink" title="Dubboåœ¨é¡¹ç›®ä¸­çš„ä½œç”¨"></a>Dubboåœ¨é¡¹ç›®ä¸­çš„ä½œç”¨</h2><p>åˆ†å¸ƒå¼æœåŠ¡æ¶æ„</p>
<ol>
<li><p>å½“æœåŠ¡è¶Šæ¥è¶Šå¤šæ—¶ï¼ŒæœåŠ¡URLé…ç½®ç®¡ç†å˜å¾—éå¸¸å›°éš¾ï¼ŒF5ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨çš„å•ç‚¹å‹åŠ›ä¹Ÿè¶Šæ¥è¶Šå¤§ã€‚æ­¤æ—¶éœ€è¦ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ŒåŠ¨æ€çš„æ³¨å†Œå’Œå‘ç°æœåŠ¡ï¼Œä½¿æœåŠ¡çš„ä½ç½®é€æ˜ã€‚<br>å¹¶é€šè¿‡åœ¨æ¶ˆè´¹æ–¹è·å–æœåŠ¡æä¾›æ–¹åœ°å€åˆ—è¡¨ï¼Œå®ç°è½¯è´Ÿè½½å‡è¡¡å’ŒFailoverï¼Œé™ä½å¯¹F5ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨çš„ä¾èµ–ï¼Œä¹Ÿèƒ½å‡å°‘éƒ¨åˆ†æˆæœ¬ã€‚</p>
</li>
<li><p>å½“è¿›ä¸€æ­¥å‘å±•ï¼ŒæœåŠ¡é—´ä¾èµ–å…³ç³»å˜å¾—é”™è¸ªå¤æ‚ï¼Œç”šè‡³åˆ†ä¸æ¸…å“ªä¸ªåº”ç”¨è¦åœ¨å“ªä¸ªåº”ç”¨ä¹‹å‰å¯åŠ¨ï¼Œæ¶æ„å¸ˆéƒ½ä¸èƒ½å®Œæ•´çš„æè¿°åº”ç”¨çš„æ¶æ„å…³ç³»ã€‚<br>è¿™æ—¶ï¼Œéœ€è¦è‡ªåŠ¨ç”»å‡ºåº”ç”¨é—´çš„ä¾èµ–å…³ç³»å›¾ï¼Œä»¥å¸®åŠ©æ¶æ„å¸ˆç†æ¸…ç†å…³ç³»ã€‚</p>
</li>
<li><p>æ¥ç€ï¼ŒæœåŠ¡çš„è°ƒç”¨é‡è¶Šæ¥è¶Šå¤§ï¼ŒæœåŠ¡çš„å®¹é‡é—®é¢˜å°±æš´éœ²å‡ºæ¥ï¼Œè¿™ä¸ªæœåŠ¡éœ€è¦å¤šå°‘æœºå™¨æ”¯æ’‘ï¼Ÿä»€ä¹ˆæ—¶å€™è¯¥åŠ æœºå™¨ï¼Ÿ<br>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç¬¬ä¸€æ­¥ï¼Œè¦å°†æœåŠ¡ç°åœ¨æ¯å¤©çš„è°ƒç”¨é‡ï¼Œå“åº”æ—¶é—´ï¼Œéƒ½ç»Ÿè®¡å‡ºæ¥ï¼Œä½œä¸ºå®¹é‡è§„åˆ’çš„å‚è€ƒæŒ‡æ ‡ã€‚<br>å…¶æ¬¡ï¼Œè¦å¯ä»¥åŠ¨æ€è°ƒæ•´æƒé‡ï¼Œåœ¨çº¿ä¸Šï¼Œå°†æŸå°æœºå™¨çš„æƒé‡ä¸€ç›´åŠ å¤§ï¼Œå¹¶åœ¨åŠ å¤§çš„è¿‡ç¨‹ä¸­è®°å½•å“åº”æ—¶é—´çš„å˜åŒ–ï¼Œç›´åˆ°å“åº”æ—¶é—´åˆ°è¾¾é˜€å€¼ï¼Œè®°å½•æ­¤æ—¶çš„è®¿é—®é‡ï¼Œå†ä»¥æ­¤è®¿é—®é‡ä¹˜ä»¥æœºå™¨æ•°åæ¨æ€»å®¹é‡ã€‚</p>
</li>
</ol>
<h2 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h2><h3 id="è§’è‰²"><a href="#è§’è‰²" class="headerlink" title="è§’è‰²"></a>è§’è‰²</h3><ol>
<li>Provider: æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ã€‚</li>
<li>Consumer: è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ã€‚</li>
<li>Registry: æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒã€‚</li>
<li>Monitor: ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡è°ƒå’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒã€‚</li>
<li>Container: æœåŠ¡è¿è¡Œå®¹å™¨ã€‚</li>
</ol>
<h3 id="è°ƒç”¨å…³ç³»"><a href="#è°ƒç”¨å…³ç³»" class="headerlink" title="è°ƒç”¨å…³ç³»"></a>è°ƒç”¨å…³ç³»</h3><ol start="0">
<li>æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li>
<li>æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li>
<li>æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li>
</ol>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">åˆ†å¸ƒå¼</a>
                
                    <a href="/tags/dubbo/">dubbo</a>
                
                    <a href="/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">æœåŠ¡æ²»ç†</a>
                
                    <a href="/tags/rpc/">rpc</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2015/12/27/%E5%B0%86amr,caf%E8%BD%ACmp3/">
                    å°†amr,cafè½¬mp3
                </a>
            </h2>
        
        <time>
            12æœˆ 27, 2015
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%96%B9%E6%A1%88/">æ–¹æ¡ˆ</a>
    </div>

    </section>
    <section class="article typo">
        <h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><hr>
<p><code>å…¬å¸åŸæœ‰æ–‡ä»¶å­˜å‚¨ç°åœ¨è¦ç”¨javaè¿›è¡Œé‡æ„ï¼Œå…¶ä¸­æ¶‰åŠåˆ°Androidå’Œiosä¸Šçš„éŸ³é¢‘é—®é¢˜ã€‚</code></p>
<ol>
<li><p>Androidå½•éŸ³æ˜¯æ ¼å¼æ˜¯amrï¼Œåœ¨ç”µè„‘ä¸Šä¸€èˆ¬æ˜¯æ’­æ”¾ä¸å‡ºæ¥çš„ï¼Œå¿…é¡»è¦è¿›è¡Œè½¬ç ã€‚</p>
</li>
<li><p>iPhoneå½•éŸ³ä¼ ä¸Šæ¥çš„æ˜¯cafï¼Œåœ¨androidä¸Šæ˜¯ä¸èƒ½è¿›è¡Œæ’­æ”¾çš„ã€‚</p>
</li>
</ol>
<p><code>ç”±äºä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¦è¿›è¡Œæ–‡ä»¶çš„è½¬æ¢ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªéœ€æ±‚å°±æ˜¯ï¼Œamrè½¬wav ,è¿™é‡Œæˆ‘ä»¬å°†amrå’Œcafç»Ÿä¸€è½¬æ¢ä¸ºmap3,å¦å¤–æä¾›ä¸€ä¸ªæ¥å£è¿›è¡Œamr2wavçš„è½¬æ¢ã€‚ åœ¨ç½‘ä¸Šå‚è€ƒäº†è®¸å¤šï¼Œæ€»ç»“ä¸‹æ¥è¿˜éƒ½æ˜¯è°ƒç”¨ffmpeg è¿›è¡Œæƒ³ç€éŸ³é¢‘çš„è½¬æ¢ã€‚æ€»ä¹Ÿæ¥è¯´æ¯”è¾ƒç®€å•ã€‚è¿™é‡Œæ—¶é—´çš„å…³ç³» ï¼Œä¹Ÿä¸å¯èƒ½å»ç ”ç©¶åº•å±‚ç¼–è§£ç çš„ä¸œè¥¿ã€‚</code></p>
<hr>
<h1 id="å¼€å·¥"><a href="#å¼€å·¥" class="headerlink" title="å¼€å·¥"></a>å¼€å·¥</h1><h2 id="å®‰è£…ffmpeg"><a href="#å®‰è£…ffmpeg" class="headerlink" title="å®‰è£…ffmpeg"></a>å®‰è£…<a target="_blank" rel="noopener" href="https://www.ffmpeg.org/ffmpeg.html#Audio-Options">ffmpeg</a></h2><ul>
<li>å‚è€ƒ<a target="_blank" rel="noopener" href="http://my.oschina.net/ethan09/blog/372435">http://my.oschina.net/ethan09/blog/372435</a></li>
</ul>
<h2 id="æŸ¥çœ‹å½“å‰ffmpegå¯¹mp3çš„ç¼–è§£ç æ”¯æŒæƒ…å†µ"><a href="#æŸ¥çœ‹å½“å‰ffmpegå¯¹mp3çš„ç¼–è§£ç æ”¯æŒæƒ…å†µ" class="headerlink" title="æŸ¥çœ‹å½“å‰ffmpegå¯¹mp3çš„ç¼–è§£ç æ”¯æŒæƒ…å†µ"></a>æŸ¥çœ‹å½“å‰ffmpegå¯¹mp3çš„ç¼–è§£ç æ”¯æŒæƒ…å†µ</h2><pre><code>    ffmpeg -codecs|grep mp3                                       Â 

     D.A.L. mp3                  MP3 (MPEG audio layer 3) (decoders: mp3 mp3float )
     D.A.L. mp3adu               ADU (Application Data Unit) MP3 (MPEG audio layer 3) (decoders: mp3adu mp3adufloat )
     D.A.L. mp3on4               MP3onMP4 (decoders: mp3on4 mp3on4float )



    Â </code></pre>
<h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><ul>
<li>ffmpeg: error while loading shared libraries: libavdevice.so.53: cannot open shared object file: No such file or directory</li>
</ul>
<pre><code>      ffmpegæ­£å¸¸å®‰è£…åæ‰§è¡Œffmpegæ—¶å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š

      è§£å†³åŠæ³•ï¼š

      vi /etc/ld.so.conf

      åŠ å…¥ï¼š/usr/local/lib

      æ‰§è¡Œldconfig</code></pre>
<ul>
<li><p>ffmpeg -i test.amr test.mp3<br>ffmpeg: error while loading shared libraries: libavdevice.so.56: cannot open shared object file: No such file or directory</p>
<pre><code> &lt;http://www.tjcarroll.org/?p=51&gt;</code></pre>
</li>
</ul>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E9%9F%B3%E9%A2%91%E8%BD%AC%E6%8D%A2/">éŸ³é¢‘è½¬æ¢</a>
                
                    <a href="/tags/arm/">arm</a>
                
                    <a href="/tags/mp3/">mp3</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2015/10/10/jmeter%E8%BF%9B%E8%A1%8C%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/">
                    JMeter
                </a>
            </h2>
        
        <time>
            10æœˆ 10, 2015
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <p>##JMeteræ˜¯ç”¨æ¥åšä»€ä¹ˆçš„</p>
<blockquote>
<p>æ˜¯ä¸€ä¸ªApacheçš„ä¸€ä¸ªå¼€æºç¨‹åºï¼Œä¸€ä¸ª100%çš„é’ˆå¯¹å‹åŠ›æ¨¡å—å’ŒåŠŸèƒ½å‹åŠ›æµ‹è¯•çº¯Javaåº”ç”¨ï¼Œæœ€åˆæ˜¯ä¸“é—¨ä¸ºWebåº”ç”¨ç¨‹åºè€Œè®¾è®¡ çš„ï¼Œä½†æ˜¯ç›®å‰å·²ç»æ‰©å±•åˆ°åˆ«çš„åŠŸèƒ½ æµ‹è¯•ã€‚</p>
</blockquote>
<ul>
<li><p>èƒ½åšä»€ä¹ˆï¼Ÿ</p>
<p>ç”¨æ¥æµ‹è¯•åŠ¨æ€ å’Œ é™æ€èµ„æº(Webservices(SOAP/REST),Web dynamic languages -PHP,JAva,ASP.NET,Files,etc.Jav)</p>
</li>
</ul>
<p>##å¦‚ä½•æœ¬åœ°è¿›è¡ŒæœåŠ¡å‹åŠ›æµ‹è¯•</p>
<ul>
<li><p>åœ¨libä¸‹å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚testsï¼Œå°†æ‰€æœ‰è‡ªå·±ç”¨åˆ°çš„jarï¼Œæ”¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚</p>
</li>
<li><p>å°†è‡ªå·±çš„æµ‹è¯•jaræ”¾åˆ° lib/extä¸‹é¢</p>
</li>
<li><p>å°†è‡ªå·±çš„ç¨‹åºä¾èµ–çš„jaræ–‡ä»¶å¤¹ï¼Œé…ç½®åˆ°é…ç½®æ–‡ä»¶<br>user.classpath=../lib/tests</p>
</li>
</ul>
<p>##å¦‚ä½•åˆ†å‘åˆ°ä¸åŒçš„æœºå™¨è¿›è¡Œå‹åŠ›æµ‹è¯•</p>
<blockquote>
<p>å‚è€ƒå®˜æ–¹æ–‡æ¡£<a target="_blank" rel="noopener" href="http://jmeter.apache.org/usermanual/jmeter_distributed_testing_step_by_step.pdf">http://jmeter.apache.org/usermanual/jmeter_distributed_testing_step_by_step.pdf</a></p>
</blockquote>
<p>##èšåˆåˆ†æ</p>
<pre><code>Labelï¼šæ¯ä¸ª JMeter çš„ elementï¼ˆä¾‹å¦‚ HTTP Requestï¼‰éƒ½æœ‰ä¸€ä¸ª Name å±æ€§ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„å°±æ˜¯ Name å±æ€§çš„å€¼

#Samplesï¼šè¡¨ç¤ºä½ è¿™æ¬¡æµ‹è¯•ä¸­ä¸€å…±å‘å‡ºäº†å¤šå°‘ä¸ªè¯·æ±‚ï¼Œå¦‚æœæ¨¡æ‹Ÿ10ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·è¿­ä»£10æ¬¡ï¼Œé‚£ä¹ˆè¿™é‡Œæ˜¾ç¤º100

Averageï¼šå¹³å‡å“åº”æ—¶é—´â€”â€”é»˜è®¤æƒ…å†µä¸‹æ˜¯å•ä¸ª Request çš„å¹³å‡å“åº”æ—¶é—´ï¼Œå½“ä½¿ç”¨äº† Transaction Controller æ—¶ï¼Œä¹Ÿå¯ä»¥ä»¥Transaction ä¸ºå•ä½æ˜¾ç¤ºå¹³å‡å“åº”æ—¶é—´

Medianï¼šä¸­ä½æ•°ï¼Œä¹Ÿå°±æ˜¯ 50ï¼… ç”¨æˆ·çš„å“åº”æ—¶é—´

90% Lineï¼š90ï¼… ç”¨æˆ·çš„å“åº”æ—¶é—´

Noteï¼šå…³äº 50ï¼… å’Œ 90ï¼… å¹¶å‘ç”¨æˆ·æ•°çš„å«ä¹‰ï¼Œè¯·å‚è€ƒä¸‹æ–‡

http://www.cnblogs.com/jackei/archive/2006/11/11/557972.html

Minï¼šæœ€å°å“åº”æ—¶é—´

Maxï¼šæœ€å¤§å“åº”æ—¶é—´

Error%ï¼šæœ¬æ¬¡æµ‹è¯•ä¸­å‡ºç°é”™è¯¯çš„è¯·æ±‚çš„æ•°é‡/è¯·æ±‚çš„æ€»æ•°

Throughputï¼šååé‡â€”â€”é»˜è®¤æƒ…å†µä¸‹è¡¨ç¤ºæ¯ç§’å®Œæˆçš„è¯·æ±‚æ•°ï¼ˆRequest per Secondï¼‰ï¼Œå½“ä½¿ç”¨äº† Transaction Controller æ—¶ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºç±»ä¼¼ LoadRunner çš„ Transaction per Second æ•°

KB/Secï¼šæ¯ç§’ä»æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°çš„æ•°æ®é‡ï¼Œç›¸å½“äºLoadRunnerä¸­çš„Throughput/Sec</code></pre>
<p>###é—®é¢˜</p>
<p>####Jmeter-serverå¯åŠ¨å¤±è´¥ï¼šCannot start. Unable to get local host IP address. is a loopback address</p>
<pre><code>    åœ¨Windowsä¸‹å¯åŠ¨Jmeteréå¸¸é¡ºåˆ©ï¼Œè½¬åˆ°Linuxä¸‹å±…ç„¶å¯åŠ¨å¤±è´¥ã€‚
    æƒ³èµ·ä¹‹å‰ é‡åˆ°â€œ/etc/hostsæ–‡ä»¶è®¾ç½®ä¸å¯¹å¯¼è‡´Jbosså¯åŠ¨å¤±è´¥â€ï¼Œ ç«‹é©¬æŠŠç„¦ç‚¹æŒ‡å‘/etc/hostsã€‚

    æœç„¶è¿˜æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œè´´/etc/hostsç¤ºä¾‹ï¼š

    127.0.0.1       localhost.localdomain localhost
    10.20.10.31   higkoo.rdev.company.net higkoo

    æ‰§è¡Œå‘½ä»¤`hostname`æŸ¥çœ‹å½“å‰æœºå™¨åå¦‚æœå½“å‰æœºå™¨åä¸/etc/hostsä¸ä¸€è‡´ ï¼Œå¯æ‰‹åŠ¨å…ˆæ‰§è¡Œæˆä¸€æ¬¡`hostname yourhostname`æˆ–ç›´æ¥åŠ åˆ°jmeter-serveræ–‡ä»¶ä¸­ï¼ˆæ³¨æ„æœºå™¨åä¸­ä¸è¦å«åŸŸä¿¡æ¯ï¼Œè­¬å¦‚ï¼šmyname.rdev.company.comã€‚è¿™æ ·è®¾ç½®ä»ç„¶å¯åŠ¨å¤±è´¥ï¼‰ã€‚

    ç”±/etc/hostsæ–‡ä»¶å¯¼è‡´å¯åŠ¨å¤±è´¥çš„é”™è¯¯æœ‰ï¼š
    1
    Created remote object: UnicastServerRef [liveRef: [endpoint:[10.20.10.31:62090](local),objID:[2c639f6d:12794fca52a:-7fff, 712947915258586677]]]
    Server failed to start: java.rmi.RemoteException: Cannot start. higkoo is a loopback address.
    2
    Created remote object: UnicastServerRef [liveRef: [endpoint:[10.20.10.31:38796](local),objID:[-b0d822e:12794fee8b1:-7fff, 8314597152635832475]]]
    Server failed to start: java.rmi.RemoteException: Cannot start. Unable to get local host IP address.</code></pre>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E6%B5%8B%E8%AF%95/">æµ‹è¯•</a>
                
                    <a href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/">æ€§èƒ½æµ‹è¯•</a>
                
                    <a href="/tags/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/">å‹åŠ›æµ‹è¯•</a>
                
                    <a href="/tags/jmeter/">jmeter</a>
                
            </div>
        
    </section>
</article>

    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
    <section class="meta">
        
            <h2 class="title">
                <a href="/2015/09/25/zookeeper%E5%AD%A6%E4%B9%A0%E5%8F%8A%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/">
                    zookeeperå­¦ä¹ åŠé¡¹ç›®å®è·µ
                </a>
            </h2>
        
        <time>
            9æœˆ 25, 2015
        </time>
        
    
    <div class='cats'>
        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    </div>

    </section>
    <section class="article typo">
        <blockquote>
<blockquote>
<p>ZooKeeper is a centralized service for maintaining configuration information, naming, providing distributed synchronization, and providing group services. ã€‚</p>
</blockquote>
</blockquote>
<pre><code>å®ƒè®¾è®¡ä¸€ç§æ–°çš„æ•°æ®ç»“æ„â€”â€”Znodeï¼Œç„¶ååœ¨è¯¥æ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šå®šä¹‰äº†ä¸€äº›åŸè¯­ï¼Œä¹Ÿå°±æ˜¯ä¸€äº›å…³äºè¯¥æ•°æ®ç»“æ„çš„ä¸€äº›æ“ä½œã€‚æœ‰äº†è¿™äº›æ•°æ®ç»“æ„å’ŒåŸè¯­è¿˜ä¸å¤Ÿï¼Œå› ä¸ºæˆ‘ä»¬çš„ZooKeeperæ˜¯å·¥ä½œåœ¨ä¸€ä¸ªåˆ†å¸ƒå¼çš„ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬çš„æœåŠ¡æ˜¯é€šè¿‡æ¶ˆæ¯ä»¥ç½‘ç»œçš„å½¢å¼å‘é€ç»™æˆ‘ä»¬çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸€ä¸ªé€šçŸ¥æœºåˆ¶â€”â€”Watcheræœºåˆ¶ã€‚é‚£ä¹ˆæ€»ç»“ä¸€ä¸‹ï¼ŒZooKeeperæ‰€æä¾›çš„æœåŠ¡ä¸»è¦æ˜¯é€šè¿‡ï¼šæ•°æ®ç»“æ„+åŸè¯­+watcheræœºåˆ¶ï¼Œä¸‰ä¸ªéƒ¨åˆ†æ¥å®ç°çš„ã€‚</code></pre>
<h2 id="ä½¿ç”¨åœºæ™¯ä¸‹ä¼šä½¿ç”¨zookeeper"><a href="#ä½¿ç”¨åœºæ™¯ä¸‹ä¼šä½¿ç”¨zookeeper" class="headerlink" title="ä½¿ç”¨åœºæ™¯ä¸‹ä¼šä½¿ç”¨zookeeper"></a>ä½¿ç”¨åœºæ™¯ä¸‹ä¼šä½¿ç”¨zookeeper</h2><ol>
<li>é¡¹ç›®ä¸­åœ¨ç›‘æ§mongodbçš„oplogæ¥è¿›è¡ŒåŒæ­¥æ•°æ®åº“çš„å˜æ›´ç»™åˆ«çš„éƒ¨é—¨.è‹¥æƒ³åšçš„å¤šæœºäº’å¤‡,å°±éœ€è¦ä½¿ç”¨åˆ°åˆ†å¸ƒå¼é”,ç”±ä¸€å°æœºå™¨è¿›è¡Œå¯¹oplogçš„å˜åŒ–è¿›è¡ŒåŒæ­¥</li>
<li>é¡¹ç›®åœ¨å®šæ—¶å‘é€æé†’,å¤šå°æœåŠ¡å™¨è¿›è¡Œå‘¨æœŸæ‰«åº“æ“ä½œ,ä¹ŸåŒæ ·ç”¨åˆ°äº†1ä¸­çš„åˆ†å¸ƒå¼é”</li>
<li>å‡è®¾æˆ‘ä»¬æœ‰20ä¸ªæœç´¢å¼•æ“çš„æœåŠ¡å™¨(æ¯ä¸ªè´Ÿè´£æ€»ç´¢å¼•ä¸­çš„ä¸€éƒ¨åˆ†çš„æœç´¢ä»»åŠ¡)å’Œä¸€ä¸ªæ€»æœåŠ¡å™¨(è´Ÿè´£å‘è¿™20ä¸ªæœç´¢å¼•æ“çš„æœåŠ¡å™¨å‘å‡ºæœç´¢è¯·æ±‚å¹¶åˆå¹¶ç»“æœé›†)ï¼Œä¸€ä¸ªå¤‡ç”¨çš„æ€»æœåŠ¡å™¨(è´Ÿè´£å½“æ€»æœåŠ¡å™¨å®•æœºæ—¶æ›¿æ¢æ€»æœåŠ¡å™¨)ï¼Œä¸€ä¸ªwebçš„cgi(å‘æ€»æœåŠ¡å™¨å‘å‡ºæœç´¢è¯·æ±‚)ã€‚æœç´¢å¼•æ“çš„æœåŠ¡å™¨ä¸­çš„15ä¸ªæœåŠ¡å™¨æä¾›æœç´¢æœåŠ¡ï¼Œ5ä¸ªæœåŠ¡å™¨æ­£åœ¨ç”Ÿæˆç´¢å¼•ã€‚è¿™20ä¸ªæœç´¢å¼•æ“çš„æœåŠ¡å™¨ç»å¸¸è¦è®©æ­£åœ¨æä¾›æœç´¢æœåŠ¡çš„æœåŠ¡å™¨åœæ­¢æä¾›æœåŠ¡å¼€å§‹ç”Ÿæˆç´¢å¼•ï¼Œæˆ–ç”Ÿæˆç´¢å¼•çš„æœåŠ¡å™¨å·²ç»æŠŠç´¢å¼•ç”Ÿæˆå®Œæˆå¯ä»¥æä¾›æœç´¢æœåŠ¡äº†ã€‚ä½¿ç”¨Zookeeperå¯ä»¥ä¿è¯æ€»æœåŠ¡å™¨è‡ªåŠ¨æ„ŸçŸ¥æœ‰å¤šå°‘æä¾›æœç´¢å¼•æ“çš„æœåŠ¡å™¨å¹¶å‘è¿™äº›æœåŠ¡å™¨å‘å‡ºæœç´¢è¯·æ±‚ï¼Œå½“æ€»æœåŠ¡å™¨å®•æœºæ—¶è‡ªåŠ¨å¯ç”¨å¤‡ç”¨çš„æ€»æœåŠ¡å™¨.â€”<a target="_blank" rel="noopener" href="https://www.oschina.net/p/zookeeper">åˆ†å¸ƒå¼ç³»ç»Ÿåè°ƒ ZooKeeper</a></li>
</ol>
<h2 id="zookeeperæ¥æºæ˜¯ä»€ä¹ˆ"><a href="#zookeeperæ¥æºæ˜¯ä»€ä¹ˆ" class="headerlink" title="zookeeperæ¥æºæ˜¯ä»€ä¹ˆ?"></a>zookeeperæ¥æºæ˜¯ä»€ä¹ˆ?</h2><p>ZooKeeperæ˜¯ä¸€ç§ä¸ºåˆ†å¸ƒå¼åº”ç”¨æ‰€è®¾è®¡çš„é«˜å¯ç”¨ã€é«˜æ€§èƒ½ä¸”ä¸€è‡´çš„å¼€æºåè°ƒæœåŠ¡ï¼Œå®ƒæä¾›äº†ä¸€é¡¹åŸºæœ¬æœåŠ¡ï¼šåˆ†å¸ƒå¼é”æœåŠ¡ã€‚ç”±äºZooKeeperçš„å¼€æºç‰¹æ€§ï¼Œåæ¥æˆ‘ä»¬çš„å¼€å‘è€…åœ¨åˆ†å¸ƒå¼é”çš„åŸºç¡€ä¸Šï¼Œæ‘¸ç´¢äº†å‡ºäº†å…¶ä»–çš„ä½¿ç”¨æ–¹æ³•ï¼šé…ç½®ç»´æŠ¤ã€ç»„æœåŠ¡ã€åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ã€åˆ†å¸ƒå¼é€šçŸ¥/åè°ƒç­‰ã€‚</p>
<h2 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h2><ol>
<li>æ¯ä¸ªServeråœ¨å†…å­˜ä¸­å­˜å‚¨äº†ä¸€ä»½æ•°æ®ï¼›</li>
<li>Zookeeperå¯åŠ¨æ—¶ï¼Œå°†ä»å®ä¾‹ä¸­é€‰ä¸¾ä¸€ä¸ªleaderï¼ˆLeaderé€‰ä¸¾ç®—æ³•é‡‡ç”¨äº†<a href="/2016/09/16/Paxos/">Paxosåè®®</a>ï¼›Paxosæ ¸å¿ƒæ€æƒ³ï¼šå½“å¤šæ•°Serverå†™æˆåŠŸï¼Œåˆ™ä»»åŠ¡æ•°æ®å†™æˆåŠŸã€‚æ•… Serveræ•°ç›®ä¸€èˆ¬ä¸ºå¥‡æ•°ï¼‰ï¼›</li>
<li>Leaderè´Ÿè´£å¤„ç†æ•°æ®æ›´æ–°ç­‰æ“ä½œï¼ˆ<a target="_blank" rel="noopener" href="http://blog.jobbole.com/104985/">Zabåè®®</a>ï¼‰ï¼›</li>
<li>ä¸€ä¸ªæ›´æ–°æ“ä½œæˆåŠŸï¼Œå½“ä¸”ä»…å½“å¤§å¤šæ•°Serveråœ¨å†…å­˜ä¸­æˆåŠŸä¿®æ”¹æ•°æ®ã€‚</li>
</ol>
<h2 id="ç»“æ„ç»„æˆ"><a href="#ç»“æ„ç»„æˆ" class="headerlink" title="ç»“æ„ç»„æˆ"></a>ç»“æ„ç»„æˆ</h2><ol>
<li>Leader è´Ÿè´£è¿›è¡ŒæŠ•ç¥¨çš„å‘èµ·å’Œå†³è®®,æ›´æ–°ç³»ç»ŸçŠ¶æ€</li>
<li>Learnerâ€“&gt;è·Ÿéšè€…Follower ç”¨äºæ¥æ”¶å®¢æˆ·è¯·æ±‚å¹¶å‘å®¢æˆ·ç«¯è¿”å›ç»“æœ,åœ¨é€‰æ‹©ä¸­å‚ä¸æŠ•ç¥¨</li>
<li>Learnerâ€“&gt;è§‚å¯Ÿè€…Observer å¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥,å°†å†™è¯·æ±‚è½¬å‘ç»™LeaderèŠ‚ç‚¹,ä½†å…¶ä¸å‚æ‚ŸæŠ•ç¥¨è¿‡ç¨‹,åªåŒæ­¥Leaderçš„çŠ¶æ€.å…¶ç›®çš„æ˜¯ä¸ºäº†æ‰©å±•ç³»ç»Ÿ,æé«˜è¯»å–é€Ÿåº¦</li>
<li>client è¯·æ±‚å‘èµ·æ–¹</li>
</ol>
<h2 id="å…·ä½“ç”¨åœ¨å“ªé‡Œ"><a href="#å…·ä½“ç”¨åœ¨å“ªé‡Œ" class="headerlink" title="å…·ä½“ç”¨åœ¨å“ªé‡Œ"></a>å…·ä½“ç”¨åœ¨å“ªé‡Œ</h2><ol>
<li>é…ç½®ç®¡ç†,ä¸€å¤„ä¿®æ”¹,ç›‘å¬è€…è¿›è¡Œæ›´æ–°</li>
<li>å‘½åæœåŠ¡</li>
<li>åˆ†å¸ƒå¼é” å³ Leader Election</li>
<li>é›†ç¾¤ç®¡ç†</li>
<li>é˜Ÿåˆ—ç®¡ç†</li>
</ol>
<h2 id="Zookeeperæ–‡ä»¶ç³»ç»Ÿ"><a href="#Zookeeperæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="Zookeeperæ–‡ä»¶ç³»ç»Ÿ"></a>Zookeeperæ–‡ä»¶ç³»ç»Ÿ</h2><p>   æ¯ä¸ªå­ç›®å½•é¡¹å¦‚ NameService éƒ½è¢«ç§°ä½œä¸ºznodeï¼Œå’Œæ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè‡ªç”±çš„å¢åŠ ã€åˆ é™¤znodeï¼Œåœ¨ä¸€ä¸ªznodeä¸‹å¢åŠ ã€åˆ é™¤å­znodeï¼Œå”¯ä¸€çš„ä¸åŒåœ¨äºznodeæ˜¯å¯ä»¥å­˜å‚¨æ•°æ®çš„ã€‚<br>   æœ‰å››ç§ç±»å‹çš„znodeï¼š</p>
<ol>
<li>PERSISTENT-æŒä¹…åŒ–ç›®å½•èŠ‚ç‚¹:å®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨</li>
<li>PERSISTENT_SEQUENTIAL-æŒä¹…åŒ–é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹:å®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨ï¼Œåªæ˜¯Zookeeperç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·</li>
<li>EPHEMERAL-ä¸´æ—¶ç›®å½•èŠ‚ç‚¹:å®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤</li>
<li>EPHEMERAL_SEQUENTIAL-ä¸´æ—¶é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹:å®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ï¼Œåªæ˜¯Zookeeperç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·</li>
</ol>
<h2 id="Zookeeperçš„ç‰¹ç‚¹"><a href="#Zookeeperçš„ç‰¹ç‚¹" class="headerlink" title="Zookeeperçš„ç‰¹ç‚¹"></a>Zookeeperçš„ç‰¹ç‚¹</h2><ol>
<li>æœ€ç»ˆä¸€è‡´æ€§ï¼šä¸ºå®¢æˆ·ç«¯å±•ç¤ºåŒä¸€è§†å›¾ï¼Œè¿™æ˜¯zookeeperæœ€é‡è¦çš„åŠŸèƒ½ã€‚</li>
<li>å¯é æ€§ï¼šå¦‚æœæ¶ˆæ¯è¢«åˆ°ä¸€å°æœåŠ¡å™¨æ¥å—ï¼Œé‚£ä¹ˆå®ƒå°†è¢«æ‰€æœ‰çš„æœåŠ¡å™¨æ¥å—ã€‚</li>
<li>å®æ—¶æ€§ï¼šZookeeperä¸èƒ½ä¿è¯ä¸¤ä¸ªå®¢æˆ·ç«¯èƒ½åŒæ—¶å¾—åˆ°åˆšæ›´æ–°çš„æ•°æ®ï¼Œå¦‚æœéœ€è¦æœ€æ–°æ•°æ®ï¼Œåº”è¯¥åœ¨è¯»æ•°æ®ä¹‹å‰è°ƒç”¨sync()æ¥å£ã€‚</li>
<li>ç­‰å¾…æ— å…³ï¼ˆwait-freeï¼‰ï¼šæ…¢çš„æˆ–è€…å¤±æ•ˆçš„clientä¸å¹²é¢„å¿«é€Ÿçš„clientçš„è¯·æ±‚ã€‚</li>
<li>åŸå­æ€§ï¼šæ›´æ–°åªèƒ½æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œæ²¡æœ‰ä¸­é—´çŠ¶æ€ã€‚</li>
<li>é¡ºåºæ€§ï¼šæ‰€æœ‰Serverï¼ŒåŒä¸€æ¶ˆæ¯å‘å¸ƒé¡ºåºä¸€è‡´ã€‚</li>
</ol>
<h2 id="åœºæ™¯åˆ†æ"><a href="#åœºæ™¯åˆ†æ" class="headerlink" title="åœºæ™¯åˆ†æ"></a>åœºæ™¯åˆ†æ</h2><ol>
<li>åˆ†å¸ƒå¼é”çš„åœºæ™¯ä½¿ç”¨</li>
</ol>
<pre><code><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">zkCli.sh -server x.x.x.x:4180</span><br><span class="line"></span><br><span class="line">ls /key</span><br><span class="line"></span><br><span class="line">&gt;[data, leader]</span><br><span class="line"></span><br><span class="line">[zk: x.x.x.x:4180(CONNECTED) 6] get /key/leader</span><br><span class="line"></span><br><span class="line">cZxid = 0xc1098cd0b0</span><br><span class="line">ctime = Sun Jul 16 13:10:01 CST 2017</span><br><span class="line">mZxid = 0xc1098cd0b0</span><br><span class="line">mtime = Sun Jul 16 13:10:01 CST 2017</span><br><span class="line">pZxid = 0xc112aec1c0</span><br><span class="line">cversion = 152</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 0</span><br><span class="line">numChildren = 2</span><br><span class="line"></span><br><span class="line">[zk: x.x.x.x:4180(CONNECTED) 7] ls /key/leader</span><br><span class="line">[_c_7ea9234d-3973-4e1d-8a6a-e2e30062cdc4-latch-0000000076, _c_5444e12a-c7ef-48bb-8ee6-271eea4a1c29-latch-0000000075]</span><br><span class="line">[zk: x.x.x.x:4180(CONNECTED) 8] get /key/leader/_c_7ea9234d-3973-4e1d-8a6a-e2e30062cdc4-latch-0000000076</span><br><span class="line">24</span><br><span class="line">cZxid = 0xc112aec1c0</span><br><span class="line">ctime = Fri Mar 30 16:58:50 CST 2018</span><br><span class="line">mZxid = 0xc112aec1c0</span><br><span class="line">mtime = Fri Mar 30 16:58:50 CST 2018</span><br><span class="line">pZxid = 0xc112aec1c0</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0xd5848ddc5ec71f6</span><br><span class="line">dataLength = 2</span><br><span class="line">numChildren = 0</span><br><span class="line"></span><br><span class="line">[zk: x.x.x.x:4180(CONNECTED) 9] get /key/leader/_c_5444e12a-c7ef-48bb-8ee6-271eea4a1c29-latch-0000000075</span><br><span class="line">5</span><br><span class="line">cZxid = 0xc1123e0f90</span><br><span class="line">ctime = Tue Mar 27 10:55:03 CST 2018</span><br><span class="line">mZxid = 0xc1123e0f90</span><br><span class="line">mtime = Tue Mar 27 10:55:03 CST 2018</span><br><span class="line">pZxid = 0xc1123e0f90</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x259977a5b1b3de0</span><br><span class="line">dataLength = 1</span><br><span class="line">numChildren = 0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></code></pre>
<h2 id="ç»å…¸æ–‡ç« é“¾æ¥"><a href="#ç»å…¸æ–‡ç« é“¾æ¥" class="headerlink" title="ç»å…¸æ–‡ç« é“¾æ¥"></a>ç»å…¸æ–‡ç« é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000012185902">zookeeperç³»åˆ—</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/gaoshan12345678910/article/details/67638657">Leaderé€‰ä¸¾</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jsStudyjj/p/5360740.html">åŸºæœ¬æ¦‚å¿µ</a></p>


        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/java/">java</a>
                
                    <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">åˆ†å¸ƒå¼</a>
                
                    <a href="/tags/zookeeper/">zookeeper</a>
                
            </div>
        
    </section>
</article>

    </div>
  
</section>


  <nav id="page-nav">
    
    
    <a class="next" rel="next" href="/tags/java/page/2/">
      <span class="text">Next</span>
      <span class="icon icon-chevron-right"></span>
    </a>
    
  </nav>
  

      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='/images/head/photo2.jpeg' />

<div class='header'>ä¸‡æ¾</div>
<div class='content'>
<div class='desc'>ç”Ÿæ´»ç‚¹æ»´å’ŒçŸ¥è¯†åˆ†äº«</div>
</div>
</section>


  <section class='m_widget links'>
<div class='header'>å‹æƒ…é“¾æ¥</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://www.fxiaoke.com/">
            <div class='name'>fxiaoke</div>
        </a></li>
    
    </ul>
</div>
</section>


  <section class='m_widget categories'>
<div class='header'>æ‰€æœ‰åˆ†ç±»</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/BPMN/"><div class='name'>BPMN</div><div class='badget'>6</div></a></li>
    
        <li><a class="flat-box" href="/categories/BPMN/Flow/"><div class='name'>Flow</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86/linux/"><div class='name'>linux</div><div class='badget'>2</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%97%A5%E5%B8%B8%E5%B7%A5%E5%85%B7/mac/"><div class='name'>mac</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E4%B9%A6%E6%9E%B6/"><div class='name'>ä¹¦æ¶</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/BPMN/%E5%85%83%E7%B4%A0/"><div class='name'>å…ƒç´ </div><div class='badget'>5</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86/"><div class='name'>æ‰©å±•çŸ¥è¯†</div><div class='badget'>7</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%8A%80%E6%9C%AF/"><div class='name'>æŠ€æœ¯</div><div class='badget'>28</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%96%B9%E6%A1%88/"><div class='name'>æ–¹æ¡ˆ</div><div class='badget'>4</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%97%A5%E5%B8%B8%E5%B7%A5%E5%85%B7/"><div class='name'>æ—¥å¸¸å·¥å…·</div><div class='badget'>3</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E7%94%9F%E6%B4%BB/"><div class='name'>ç”Ÿæ´»</div><div class='badget'>5</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%8A%80%E6%9C%AF/%E7%AE%97%E6%B3%95/"><div class='name'>ç®—æ³•</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E8%89%BA%E6%9C%AF/"><div class='name'>è‰ºæœ¯</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%8A%80%E6%9C%AF/%E8%AF%AD%E8%A8%80/"><div class='name'>è¯­è¨€</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86/%E8%AF%BB%E4%B9%A6%E5%AD%A6%E4%B9%A0/"><div class='name'>è¯»ä¹¦å­¦ä¹ </div><div class='badget'>5</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E8%AF%BB%E4%B9%A6%E5%AD%A6%E4%B9%A0/"><div class='name'>è¯»ä¹¦å­¦ä¹ </div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/%E6%8A%80%E6%9C%AF/%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/"><div class='name'>é—®é¢˜æ€»ç»“</div><div class='badget'>1</div></a></li>
    
    </ul>
    
</div>
</section>


  
<div class="m_widget tagcloud">
    <div class="header">æ ‡ç­¾äº‘</div>
    <div class='content'>
        <a href="/tags/BPMN/" style="font-size: 19px; color: #151515">BPMN</a> <a href="/tags/CAP/" style="font-size: 15px; color: #6b6b6b">CAP</a> <a href="/tags/Flow/" style="font-size: 19px; color: #151515">Flow</a> <a href="/tags/GIS/" style="font-size: 14px; color: #808080">GIS</a> <a href="/tags/Protobuf/" style="font-size: 14px; color: #808080">Protobuf</a> <a href="/tags/alfred/" style="font-size: 14px; color: #808080">alfred</a> <a href="/tags/angularjs/" style="font-size: 17px; color: #404040">angularjs</a> <a href="/tags/ansible/" style="font-size: 14px; color: #808080">ansible</a> <a href="/tags/arm/" style="font-size: 14px; color: #808080">arm</a> <a href="/tags/book/" style="font-size: 15px; color: #6b6b6b">book</a> <a href="/tags/bug/" style="font-size: 14px; color: #808080">bug</a> <a href="/tags/django/" style="font-size: 14px; color: #808080">django</a> <a href="/tags/dubbo/" style="font-size: 14px; color: #808080">dubbo</a> <a href="/tags/fastcgi/" style="font-size: 14px; color: #808080">fastcgi</a> <a href="/tags/fastfs/" style="font-size: 14px; color: #808080">fastfs</a> <a href="/tags/git/" style="font-size: 14px; color: #808080">git</a> <a href="/tags/ionic/" style="font-size: 17px; color: #404040">ionic</a> <a href="/tags/java/" style="font-size: 20px; color: #000">java</a> <a href="/tags/jdk/" style="font-size: 14px; color: #808080">jdk</a> <a href="/tags/jdk8-java/" style="font-size: 15px; color: #6b6b6b">jdk8.java</a> <a href="/tags/jmeter/" style="font-size: 14px; color: #808080">jmeter</a> <a href="/tags/linux/" style="font-size: 14px; color: #808080">linux</a> <a href="/tags/linux%E5%91%BD%E4%BB%A4/" style="font-size: 14px; color: #808080">linuxå‘½ä»¤</a> <a href="/tags/mac/" style="font-size: 15px; color: #6b6b6b">mac</a> <a href="/tags/maven/" style="font-size: 14px; color: #808080">maven</a> <a href="/tags/mp3/" style="font-size: 14px; color: #808080">mp3</a> <a href="/tags/mysql/" style="font-size: 14px; color: #808080">mysql</a> <a href="/tags/nginx/" style="font-size: 14px; color: #808080">nginx</a> <a href="/tags/nocomment/" style="font-size: 14px; color: #808080">nocomment</a> <a href="/tags/poi/" style="font-size: 14px; color: #808080">poi</a> <a href="/tags/python/" style="font-size: 17px; color: #404040">python</a> <a href="/tags/redis/" style="font-size: 15px; color: #6b6b6b">redis</a> <a href="/tags/rpc/" style="font-size: 14px; color: #808080">rpc</a> <a href="/tags/rsa/" style="font-size: 14px; color: #808080">rsa</a> <a href="/tags/schedule/" style="font-size: 14px; color: #808080">schedule</a> <a href="/tags/workflow/" style="font-size: 14px; color: #808080">workflow</a> <a href="/tags/zookeeper/" style="font-size: 14px; color: #808080">zookeeper</a> <a href="/tags/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95/" style="font-size: 14px; color: #808080">ä¸€è‡´æ€§ç®—æ³•</a> <a href="/tags/%E4%BA%BA%E7%94%9F/" style="font-size: 16px; color: #555">äººç”Ÿ</a> <a href="/tags/%E4%BA%BA%E7%94%9F%E6%84%9F%E6%82%9F/" style="font-size: 14px; color: #808080">äººç”Ÿæ„Ÿæ‚Ÿ</a> <a href="/tags/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" style="font-size: 14px; color: #808080">äººè„¸è¯†åˆ«</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E4%BB%93%E5%BA%93/" style="font-size: 14px; color: #808080">ä»£ç ä»“åº“</a> <a href="/tags/%E5%81%A5%E5%BA%B7/" style="font-size: 14px; color: #808080">å¥åº·</a> <a href="/tags/%E5%85%83%E7%B4%A0/" style="font-size: 18px; color: #2b2b2b">å…ƒç´ </a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 18px; color: #2b2b2b">åˆ†å¸ƒå¼</a> <a href="/tags/%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/" style="font-size: 14px; color: #808080">åŠ å¯†è§£å¯†</a> <a href="/tags/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/" style="font-size: 14px; color: #808080">å‹åŠ›æµ‹è¯•</a> <a href="/tags/%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/" style="font-size: 15px; color: #6b6b6b">å›¾ç‰‡å¤„ç†</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 17px; color: #404040">å¤šçº¿ç¨‹</a> <a href="/tags/%E5%AD%98%E5%82%A8/" style="font-size: 14px; color: #808080">å­˜å‚¨</a> <a href="/tags/%E5%AE%9A%E6%97%B6/" style="font-size: 14px; color: #808080">å®šæ—¶</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 14px; color: #808080">å·¥å…·</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 14px; color: #808080">å¹¶å‘</a> <a href="/tags/%E5%BE%90%E6%82%B2%E9%B8%BF/" style="font-size: 14px; color: #808080">å¾æ‚²é¸¿</a> <a href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" style="font-size: 14px; color: #808080">æ€§èƒ½æµ‹è¯•</a> <a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size: 15px; color: #6b6b6b">æ„Ÿæ‚Ÿ</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 14px; color: #808080">æ’åº</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/" style="font-size: 15px; color: #6b6b6b">æœåŠ¡æ²»ç†</a> <a href="/tags/%E6%9F%A5%E6%89%BE/" style="font-size: 14px; color: #808080">æŸ¥æ‰¾</a> <a href="/tags/%E6%B5%81%E7%A8%8B/" style="font-size: 19px; color: #151515">æµç¨‹</a> <a href="/tags/%E6%B5%81%E7%A8%8B%E5%BC%95%E6%93%8E/" style="font-size: 19px; color: #151515">æµç¨‹å¼•æ“</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 14px; color: #808080">æµ‹è¯•</a> <a href="/tags/%E7%88%AC%E5%B1%B1/" style="font-size: 14px; color: #808080">çˆ¬å±±</a> <a href="/tags/%E7%96%91%E6%83%91/" style="font-size: 15px; color: #6b6b6b">ç–‘æƒ‘</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 19px; color: #151515">ç®—æ³•</a> <a href="/tags/%E7%BB%8F%E9%AA%8C/" style="font-size: 14px; color: #808080">ç»éªŒ</a> <a href="/tags/%E7%BB%98%E7%94%BB/" style="font-size: 14px; color: #808080">ç»˜ç”»</a> <a href="/tags/%E7%BC%93%E5%AD%98/" style="font-size: 15px; color: #6b6b6b">ç¼“å­˜</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 17px; color: #404040">è®¾è®¡æ¨¡å¼</a> <a href="/tags/%E8%BD%AF%E4%BB%B6/" style="font-size: 14px; color: #808080">è½¯ä»¶</a> <a href="/tags/%E8%BF%90%E5%8A%A8/" style="font-size: 14px; color: #808080">è¿åŠ¨</a> <a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 15px; color: #6b6b6b">è¿ç»´</a> <a href="/tags/%E9%9F%B3%E4%B9%90/" style="font-size: 14px; color: #808080">éŸ³ä¹</a> <a href="/tags/%E9%9F%B3%E9%A2%91%E8%BD%AC%E6%8D%A2/" style="font-size: 14px; color: #808080">éŸ³é¢‘è½¬æ¢</a>
    </div>
</div>



      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/AaronWan" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">æœ¬ç«™æµè§ˆæ€»è®¿é—®é‡: <span id="busuanzi_value_site_pv"></span></span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv">æœ¬ç«™è®¿é—®äººæ•°: <span id="busuanzi_value_site_uv"></span></span>
    
</footer>

  <script>setLoadingBarProgress(80);</script>
  

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>

<script src="/js/jquery.fitvids.js"></script>

<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>

<script src="/js/search.js"></script>


<script src="/js/app.js"></script>



  <script>setLoadingBarProgress(100);</script>
</body>
</html>
